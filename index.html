<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#5D4037" id="themeColor">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Daily Brew">
  <title>My Daily Brew</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Cormorant+Garamond:wght@400;500;600;700&family=Lora:wght@400;500;600&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
    html, body, #root { height: 100%; width: 100%; overflow-x: hidden; }
    body { font-family: 'Cormorant Garamond', Georgia, serif; min-height: 100vh; min-height: -webkit-fill-available; transition: background 0.4s ease; overscroll-behavior: none; -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
    .loading-screen { position: fixed; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; background: linear-gradient(180deg, #F5E6D3 0%, #FDFBF7 50%, #F5E6D3 100%); transition: opacity 0.5s; }
    .loading-screen.hidden { opacity: 0; pointer-events: none; }
    .loading-icon { font-size: 56px; animation: steam 2s ease-in-out infinite; }
    @keyframes steam { 0%, 100% { transform: translateY(0) scale(1); } 50% { transform: translateY(-15px) scale(1.1); } }
    .loading-text { font-family: 'Caveat', cursive; font-size: 26px; color: #5D4037; margin-top: 16px; }
    .loading-subtext { font-family: 'Lora', serif; font-size: 14px; color: #8B7355; margin-top: 8px; opacity: 0.8; }
  </style>
</head>
<body>
  <div id="root"></div>
  <div class="loading-screen" id="loadingScreen">
    <div class="loading-icon">☕</div>
    <div class="loading-text">Brewing something special...</div>
    <div class="loading-subtext">v8.1 • Streak Fix & Today View</div>
  </div>

  <script type="text/babel">
    const { useState, useEffect, useCallback, useRef, useMemo } = React;

    // ═══════════════════════════════════════════════════════════════
    // UTILITIES
    // ═══════════════════════════════════════════════════════════════
    const store = (k, v) => { try { localStorage.setItem(k, JSON.stringify(v)); } catch(e) {} };
    const load = (k, d) => { try { const v = localStorage.getItem(k); return v ? JSON.parse(v) : d; } catch { return d; } };
    // Fixed: Use local timezone instead of UTC for date keys
    const getDateKey = (d = new Date()) => `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
    const getDayOfWeek = (d = new Date()) => d.getDay();
    const isSameDay = (d1, d2) => getDateKey(d1) === getDateKey(d2);
    const formatTime = (t) => { if (!t) return ''; const [h, m] = t.split(':').map(Number); return `${h % 12 || 12}:${m.toString().padStart(2, '0')} ${h >= 12 ? 'PM' : 'AM'}`; };
    const formatTimer = (s) => `${Math.floor(s / 60).toString().padStart(2, '0')}:${(s % 60).toString().padStart(2, '0')}`;
    const getWeekNumber = () => Math.floor(new Date().getTime() / (7 * 24 * 60 * 60 * 1000));
    const getMonthKey = () => { const d = new Date(); return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`; };

    // ═══════════════════════════════════════════════════════════════
    // PAPER TEXTURE ASSETS
    // ═══════════════════════════════════════════════════════════════
    const PAPER_TEXTURE = 'data:image/jpeg;base64,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';
    const COFFEE_RING = 'data:image/png;base64,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';

    // ═══════════════════════════════════════════════════════════════
    // SEASONAL THEMES
    // ═══════════════════════════════════════════════════════════════
    const getCurrentSeason = () => {
      const month = new Date().getMonth();
      if (month >= 2 && month <= 4) return 'spring';
      if (month >= 5 && month <= 7) return 'summer';
      if (month >= 8 && month <= 10) return 'fall';
      return 'winter';
    };

    const seasonalDecorations = {
      spring: { emoji: '🌸', name: 'Cherry Blossom', accent: '#FFB7C5' },
      summer: { emoji: '🌻', name: 'Sunshine', accent: '#FFD93D' },
      fall: { emoji: '🍂', name: 'Pumpkin Spice', accent: '#D2691E' },
      winter: { emoji: '❄️', name: 'Peppermint', accent: '#B8E0E0' }
    };

    // ═══════════════════════════════════════════════════════════════
    // BREW-THEMED DATA
    // ═══════════════════════════════════════════════════════════════
    const brewRanks = {
      coffee: [
        { level: 1, title: 'Coffee Bean', xp: 0, icon: '🫘' },
        { level: 2, title: 'Barista Trainee', xp: 100, icon: '👶' },
        { level: 3, title: 'Junior Barista', xp: 300, icon: '☕' },
        { level: 4, title: 'Senior Barista', xp: 600, icon: '⭐' },
        { level: 5, title: 'Head Barista', xp: 1000, icon: '🎖️' },
        { level: 6, title: 'Café Manager', xp: 1500, icon: '👔' },
        { level: 7, title: 'Café Owner', xp: 2500, icon: '🏆' },
      ],
      tea: [
        { level: 1, title: 'Tea Leaf', xp: 0, icon: '🌿' },
        { level: 2, title: 'Tea Apprentice', xp: 100, icon: '🍃' },
        { level: 3, title: 'Tea Steeper', xp: 300, icon: '🍵' },
        { level: 4, title: 'Tea Blender', xp: 600, icon: '⭐' },
        { level: 5, title: 'Tea Sommelier', xp: 1000, icon: '🎖️' },
        { level: 6, title: 'Tea Sage', xp: 1500, icon: '🧘' },
        { level: 7, title: 'Tea Grandmaster', xp: 2500, icon: '👑' },
      ],
      matcha: [
        { level: 1, title: 'Matcha Seedling', xp: 0, icon: '🌱' },
        { level: 2, title: 'Matcha Student', xp: 100, icon: '📚' },
        { level: 3, title: 'Matcha Whisker', xp: 300, icon: '🍃' },
        { level: 4, title: 'Matcha Artisan', xp: 600, icon: '🎨' },
        { level: 5, title: 'Matcha Sensei', xp: 1000, icon: '🥋' },
        { level: 6, title: 'Matcha Master', xp: 1500, icon: '🏯' },
        { level: 7, title: 'Zen Grandmaster', xp: 2500, icon: '🐉' },
      ]
    };

    const brewBadges = {
      coffee: [
        { id: 'first_habit', name: 'First Sip', desc: 'Complete your first habit', icon: '☕', check: s => s.totalHabitsCompleted >= 1 },
        { id: 'streak_7', name: 'Regular Order', desc: '7-day streak', icon: '🔁', check: s => s.maxStreak >= 7 },
        { id: 'streak_30', name: 'Loyal Customer', desc: '30-day streak', icon: '💎', check: s => s.maxStreak >= 30 },
        { id: 'perfect_day', name: 'Perfect Roast', desc: 'Complete all daily goals', icon: '✨', check: s => s.perfectDays >= 1 },
        { id: 'perfect_week', name: 'Barista\'s Best', desc: '7 perfect days', icon: '🌟', check: s => s.perfectDays >= 7 },
        { id: 'mood_tracker', name: 'Coffee Connoisseur', desc: 'Track mood 7 days', icon: '😊', check: s => s.moodDaysTracked >= 7 },
        { id: 'focus_hour', name: 'Deep Brew', desc: '60 min focus total', icon: '⏱️', check: s => s.totalFocusMinutes >= 60 },
        { id: 'focus_master', name: 'Espresso Shot', desc: '10 hours focus', icon: '⚡', check: s => s.totalFocusMinutes >= 600 },
        { id: 'journal_5', name: 'Coffee Journal', desc: '5 journal entries', icon: '📝', check: s => s.journalEntries >= 5 },
        { id: 'tasks_25', name: 'Order Up!', desc: '25 tasks done', icon: '🛎️', check: s => s.totalTasksCompleted >= 25 },
        { id: 'tasks_100', name: 'Rush Hour Hero', desc: '100 tasks done', icon: '💯', check: s => s.totalTasksCompleted >= 100 },
        { id: 'early_bird', name: 'Morning Brew', desc: 'Task before 8 AM', icon: '🌅', check: s => s.earlyTasks >= 1 },
        { id: 'night_owl', name: 'Late Night Latte', desc: 'Task after 10 PM', icon: '🦉', check: s => s.lateTasks >= 1 },
        { id: 'consistent', name: 'Daily Grind', desc: '14-day app streak', icon: '📅', check: s => s.appStreak >= 14 },
        { id: 'freeze_used', name: 'Iced Coffee', desc: 'Use streak freeze', icon: '❄️', check: s => s.freezesUsed >= 1 },
        { id: 'challenge_complete', name: 'Challenge Champion', desc: 'Complete a challenge', icon: '🏅', check: s => s.challengesCompleted >= 1 },
        { id: 'shared', name: 'Social Barista', desc: 'Share an achievement', icon: '📤', check: s => s.timesShared >= 1 },
        { id: 'exported', name: 'Data Roaster', desc: 'Export your data', icon: '💾', check: s => s.timesExported >= 1 },
      ],
      tea: [
        { id: 'first_habit', name: 'First Steep', desc: 'Complete your first habit', icon: '🍵', check: s => s.totalHabitsCompleted >= 1 },
        { id: 'streak_7', name: 'Daily Ritual', desc: '7-day streak', icon: '🔁', check: s => s.maxStreak >= 7 },
        { id: 'streak_30', name: 'Tea Tradition', desc: '30-day streak', icon: '💎', check: s => s.maxStreak >= 30 },
        { id: 'perfect_day', name: 'Perfect Steep', desc: 'Complete all daily goals', icon: '✨', check: s => s.perfectDays >= 1 },
        { id: 'perfect_week', name: 'Golden Cup', desc: '7 perfect days', icon: '🌟', check: s => s.perfectDays >= 7 },
        { id: 'mood_tracker', name: 'Tea Taster', desc: 'Track mood 7 days', icon: '😊', check: s => s.moodDaysTracked >= 7 },
        { id: 'focus_hour', name: 'Zen Focus', desc: '60 min focus total', icon: '⏱️', check: s => s.totalFocusMinutes >= 60 },
        { id: 'focus_master', name: 'Tea Meditation', desc: '10 hours focus', icon: '🧘', check: s => s.totalFocusMinutes >= 600 },
        { id: 'journal_5', name: 'Tea Thoughts', desc: '5 journal entries', icon: '📝', check: s => s.journalEntries >= 5 },
        { id: 'tasks_25', name: 'Steeping Success', desc: '25 tasks done', icon: '🫖', check: s => s.totalTasksCompleted >= 25 },
        { id: 'tasks_100', name: 'Tea Party Host', desc: '100 tasks done', icon: '💯', check: s => s.totalTasksCompleted >= 100 },
        { id: 'early_bird', name: 'Morning Tea', desc: 'Task before 8 AM', icon: '🌅', check: s => s.earlyTasks >= 1 },
        { id: 'night_owl', name: 'Chamomile Night', desc: 'Task after 10 PM', icon: '🌙', check: s => s.lateTasks >= 1 },
        { id: 'consistent', name: 'Tea Time', desc: '14-day app streak', icon: '📅', check: s => s.appStreak >= 14 },
        { id: 'freeze_used', name: 'Iced Tea', desc: 'Use streak freeze', icon: '🧊', check: s => s.freezesUsed >= 1 },
        { id: 'challenge_complete', name: 'Challenge Conqueror', desc: 'Complete a challenge', icon: '🏅', check: s => s.challengesCompleted >= 1 },
        { id: 'shared', name: 'Tea Socialite', desc: 'Share an achievement', icon: '📤', check: s => s.timesShared >= 1 },
        { id: 'exported', name: 'Tea Archivist', desc: 'Export your data', icon: '💾', check: s => s.timesExported >= 1 },
      ],
      matcha: [
        { id: 'first_habit', name: 'First Whisk', desc: 'Complete your first habit', icon: '🍃', check: s => s.totalHabitsCompleted >= 1 },
        { id: 'streak_7', name: 'Daily Practice', desc: '7-day streak', icon: '🔁', check: s => s.maxStreak >= 7 },
        { id: 'streak_30', name: 'Zen Discipline', desc: '30-day streak', icon: '💎', check: s => s.maxStreak >= 30 },
        { id: 'perfect_day', name: 'Perfect Balance', desc: 'Complete all daily goals', icon: '☯️', check: s => s.perfectDays >= 1 },
        { id: 'perfect_week', name: 'Harmony Week', desc: '7 perfect days', icon: '🌟', check: s => s.perfectDays >= 7 },
        { id: 'mood_tracker', name: 'Mindful Taster', desc: 'Track mood 7 days', icon: '😊', check: s => s.moodDaysTracked >= 7 },
        { id: 'focus_hour', name: 'Zen Focus', desc: '60 min focus total', icon: '⏱️', check: s => s.totalFocusMinutes >= 60 },
        { id: 'focus_master', name: 'Deep Meditation', desc: '10 hours focus', icon: '🧘', check: s => s.totalFocusMinutes >= 600 },
        { id: 'journal_5', name: 'Zen Journal', desc: '5 journal entries', icon: '📝', check: s => s.journalEntries >= 5 },
        { id: 'tasks_25', name: 'Flowing Progress', desc: '25 tasks done', icon: '🌊', check: s => s.totalTasksCompleted >= 25 },
        { id: 'tasks_100', name: 'Mountain Climber', desc: '100 tasks done', icon: '🏔️', check: s => s.totalTasksCompleted >= 100 },
        { id: 'early_bird', name: 'Sunrise Ritual', desc: 'Task before 8 AM', icon: '🌅', check: s => s.earlyTasks >= 1 },
        { id: 'night_owl', name: 'Moonlit Practice', desc: 'Task after 10 PM', icon: '🌙', check: s => s.lateTasks >= 1 },
        { id: 'consistent', name: 'Path of Zen', desc: '14-day app streak', icon: '🛤️', check: s => s.appStreak >= 14 },
        { id: 'freeze_used', name: 'Frozen Matcha', desc: 'Use streak freeze', icon: '🧊', check: s => s.freezesUsed >= 1 },
        { id: 'challenge_complete', name: 'Zen Champion', desc: 'Complete a challenge', icon: '🏅', check: s => s.challengesCompleted >= 1 },
        { id: 'shared', name: 'Zen Teacher', desc: 'Share an achievement', icon: '📤', check: s => s.timesShared >= 1 },
        { id: 'exported', name: 'Scroll Keeper', desc: 'Export your data', icon: '💾', check: s => s.timesExported >= 1 },
      ]
    };

    const brewMessages = {
      coffee: { emptyHabits: "No habits brewing yet! Let's start your routine ☕", emptyTasks: "All clear! Grab a coffee and relax! ☕", perfect: "Perfect roast today! You're amazing ✨", good: "You're brewing greatness! ☕", start: "One sip at a time ☕", timerDone: "☕ Brew complete!", timerFocus: "Stay focused, one cup at a time", freeze: "❄️ Iced Coffee saved your streak!" },
      tea: { emptyHabits: "No habits steeping yet! Let's start your ritual 🍵", emptyTasks: "All clear! Enjoy a peaceful cup of tea! 🍵", perfect: "Perfect steep today! You're amazing ✨", good: "You're steeping success! 🍵", start: "One steep at a time 🍵", timerDone: "🍵 Steep complete!", timerFocus: "Stay focused, find your calm", freeze: "🧊 Iced Tea saved your streak!" },
      matcha: { emptyHabits: "No habits cultivated yet! Let's find balance 🍃", emptyTasks: "All clear! Find your zen moment! 🍃", perfect: "Perfect harmony today! You're amazing ✨", good: "You're finding balance! 🍃", start: "One breath at a time 🍃", timerDone: "🍃 Meditation complete!", timerFocus: "Stay focused, embrace the calm", freeze: "🧊 Frozen Matcha saved your streak!" }
    };

    // ═══════════════════════════════════════════════════════════════
    // HABIT TEMPLATES - Curated habit packs for quick setup
    // ═══════════════════════════════════════════════════════════════
    const habitTemplates = {
      'morning-brew': {
        name: 'Morning Brew Ritual',
        icon: '🌅',
        description: 'Start your day right with this energizing morning routine',
        habits: [
          { name: 'Wake up early', icon: '⏰' },
          { name: 'Drink water', icon: '💧' },
          { name: 'Morning stretch', icon: '🧘' },
          { name: 'Healthy breakfast', icon: '🥣' },
          { name: 'Review daily goals', icon: '📋' }
        ]
      },
      'wellness': {
        name: 'Wellness Blend',
        icon: '💚',
        description: 'A balanced mix of physical and mental health habits',
        habits: [
          { name: 'Exercise 30 min', icon: '🏃' },
          { name: 'Drink 8 glasses water', icon: '💧' },
          { name: 'Take vitamins', icon: '💊' },
          { name: 'Meditation', icon: '🧘' },
          { name: 'Sleep 8 hours', icon: '😴' }
        ]
      },
      'productivity': {
        name: 'Espresso Shot Focus',
        icon: '⚡',
        description: 'High-energy habits for maximum productivity',
        habits: [
          { name: 'Plan tomorrow tonight', icon: '📝' },
          { name: 'Deep work session', icon: '🎯' },
          { name: 'Inbox zero', icon: '📧' },
          { name: 'Learn something new', icon: '📚' },
          { name: 'Review accomplishments', icon: '✅' }
        ]
      },
      'mindfulness': {
        name: 'Zen Garden',
        icon: '🍃',
        description: 'Cultivate inner peace and mindfulness',
        habits: [
          { name: 'Morning meditation', icon: '🧘' },
          { name: 'Gratitude journaling', icon: '🙏' },
          { name: 'Digital detox hour', icon: '📵' },
          { name: 'Nature walk', icon: '🌳' },
          { name: 'Evening reflection', icon: '🌙' }
        ]
      },
      'self-care': {
        name: 'Latte Love',
        icon: '💝',
        description: 'Nurturing habits for self-care and happiness',
        habits: [
          { name: 'Skincare routine', icon: '✨' },
          { name: 'Read for pleasure', icon: '📖' },
          { name: 'Connect with friend', icon: '💬' },
          { name: 'Creative time', icon: '🎨' },
          { name: 'Treat yourself', icon: '🍰' }
        ]
      },
      'fitness': {
        name: 'Power Blend',
        icon: '💪',
        description: 'Build strength and endurance',
        habits: [
          { name: 'Workout', icon: '🏋️' },
          { name: 'Protein intake', icon: '🥩' },
          { name: 'Stretch/yoga', icon: '🧘' },
          { name: '10k steps', icon: '👟' },
          { name: 'Track progress', icon: '📊' }
        ]
      },
      'learning': {
        name: 'Brain Brew',
        icon: '🧠',
        description: 'Feed your mind and grow every day',
        habits: [
          { name: 'Read 30 minutes', icon: '📚' },
          { name: 'Practice skill', icon: '🎯' },
          { name: 'Watch educational content', icon: '🎓' },
          { name: 'Language practice', icon: '🗣️' },
          { name: 'Teach someone', icon: '👨‍🏫' }
        ]
      },
      'creative': {
        name: 'Artisan Roast',
        icon: '🎨',
        description: 'Nurture your creative spirit',
        habits: [
          { name: 'Create something', icon: '✏️' },
          { name: 'Capture inspiration', icon: '📸' },
          { name: 'Practice your craft', icon: '🎭' },
          { name: 'Share your work', icon: '🌟' },
          { name: 'Explore new art', icon: '🖼️' }
        ]
      },
      'minimalist': {
        name: 'Simple Sip',
        icon: '🫧',
        description: 'Just the essentials for a balanced life',
        habits: [
          { name: 'Move your body', icon: '🚶' },
          { name: 'Hydrate', icon: '💧' },
          { name: 'Moment of calm', icon: '🌸' }
        ]
      },
      'night-owl': {
        name: 'Evening Wind-Down',
        icon: '🌙',
        description: 'End your day peacefully for better sleep',
        habits: [
          { name: 'No screens 1hr before bed', icon: '📵' },
          { name: 'Prepare tomorrow', icon: '📋' },
          { name: 'Light stretching', icon: '🧘' },
          { name: 'Gratitude moment', icon: '🙏' },
          { name: 'Consistent bedtime', icon: '🛏️' }
        ]
      }
    };

    // ═══════════════════════════════════════════════════════════════
    // DAILY JOURNAL PROMPTS - 366 unique prompts for the year
    // ═══════════════════════════════════════════════════════════════
    const journalPrompts = [
      // January - New Beginnings & Reflection (1-31)
      "What word do you want to define this year?",
      "What's one habit you'd like to build this year?",
      "Describe your ideal ordinary day.",
      "What are you most looking forward to?",
      "What lesson from last year do you want to remember?",
      "Who do you want to spend more time with?",
      "What would you do if you knew you couldn't fail?",
      "What's something you've been putting off?",
      "Describe a place where you feel completely at peace.",
      "What does success mean to you right now?",
      "What's a small joy you experienced recently?",
      "If you could master any skill instantly, what would it be?",
      "What boundaries do you need to set or maintain?",
      "Write about someone who believed in you.",
      "What are you curious about lately?",
      "What does your inner critic say? How can you respond kindly?",
      "Describe your relationship with rest.",
      "What's something you're proud of that no one knows about?",
      "What would you tell your younger self?",
      "What makes you feel most alive?",
      "What's a fear you'd like to overcome?",
      "Describe a moment of unexpected kindness.",
      "What does your ideal morning look like?",
      "What are you holding onto that you need to let go?",
      "Who has shaped who you are today?",
      "What's something you believe that most people don't?",
      "Describe a challenge that made you stronger.",
      "What brings you comfort on hard days?",
      "What's your favorite way to show love?",
      "If today was your last, what would you regret not doing?",
      "What intention do you want to set for February?",
      // February - Love & Connection (32-59)
      "What does love mean to you?",
      "Write about a friendship that changed you.",
      "How do you show yourself compassion?",
      "What's the kindest thing someone has done for you?",
      "Describe your perfect date (with anyone or alone).",
      "What do you love about your home?",
      "Who makes you laugh the hardest?",
      "What's a relationship you'd like to improve?",
      "How do you feel about vulnerability?",
      "Write a love letter to your body.",
      "What's a tradition you cherish?",
      "Describe someone you admire and why.",
      "What does self-care look like for you?",
      "What's the best advice you've received about relationships?",
      "How do you handle conflict?",
      "What makes you feel truly seen?",
      "Write about a time you forgave someone.",
      "What do you need more of in your relationships?",
      "Describe your love language in action.",
      "What's something nice you can do for someone tomorrow?",
      "How has your idea of love evolved?",
      "What boundaries protect your peace?",
      "Write about a mentor or role model.",
      "What do you love about yourself?",
      "How do you reconnect after an argument?",
      "What does unconditional love feel like?",
      "Describe a moment of deep connection.",
      "What are you grateful for in your relationships?",
      // March - Growth & Change (60-90)
      "What area of your life needs attention?",
      "Describe a time you surprised yourself.",
      "What's growing in your life right now?",
      "What do you need to prune or let go?",
      "How do you handle change?",
      "What's a belief you've outgrown?",
      "Describe your relationship with failure.",
      "What would you try if judgment didn't exist?",
      "What's one thing you can improve this week?",
      "How do you celebrate small wins?",
      "What's something difficult you're grateful for?",
      "Describe a turning point in your life.",
      "What are you learning right now?",
      "How do you stay motivated?",
      "What's holding you back from your potential?",
      "Write about a risk that paid off.",
      "What does courage look like for you today?",
      "How have you changed in the last year?",
      "What skill would improve your daily life?",
      "Describe your growth mindset (or fixed mindset).",
      "What's a mistake that taught you something valuable?",
      "How do you handle uncertainty?",
      "What are you ready to begin?",
      "Write about someone who inspires your growth.",
      "What does progress look like in your life?",
      "How do you push through resistance?",
      "What are you becoming?",
      "Describe a moment of breakthrough.",
      "What do you want to be known for?",
      "How will you nurture your growth this spring?",
      "What seeds are you planting for the future?",
      // April - Creativity & Play (91-120)
      "When did you last do something just for fun?",
      "What creative outlet calls to you?",
      "Describe your inner child.",
      "What did you love doing as a kid?",
      "How can you add more play to your life?",
      "What inspires your creativity?",
      "Write about a time you made something you were proud of.",
      "What's blocking your creative expression?",
      "Describe your ideal creative space.",
      "What would you create if you had unlimited resources?",
      "How do you feel about making mistakes in creative work?",
      "What art, music, or media moves you?",
      "Write a short story about your day (make it dramatic!).",
      "What's a creative skill you'd like to develop?",
      "How does creativity help you process emotions?",
      "Describe something beautiful you saw recently.",
      "What does your imagination show you?",
      "How can you make boring tasks more fun?",
      "Write about a creative person you admire.",
      "What hobby have you always wanted to try?",
      "How do you balance productivity and play?",
      "Describe a moment of flow state.",
      "What would you do with an unexpected free day?",
      "How does nature inspire you?",
      "What's something silly that makes you happy?",
      "Write about the colors of your current mood.",
      "How can you express yourself more authentically?",
      "What childhood game would you play again?",
      "Describe your creative dreams.",
      "How will you make space for joy this month?",
      // May - Gratitude & Abundance (121-151)
      "List 10 simple pleasures in your life.",
      "What's something free that brings you joy?",
      "Write about a person you're thankful for.",
      "What's working well in your life right now?",
      "How do you practice gratitude daily?",
      "What's a luxury you once dreamed of that you now have?",
      "Describe abundance beyond money.",
      "What are you taking for granted?",
      "Write a thank you letter you'll never send.",
      "What's the best thing about today?",
      "How has your definition of wealth changed?",
      "What do you have enough of?",
      "Describe a gift that meant the world to you.",
      "What privilege are you grateful for?",
      "How do you share your abundance with others?",
      "What's a memory that makes you smile?",
      "What modern convenience amazes you?",
      "Write about something you're grateful to have learned.",
      "What's a challenge you're now thankful for?",
      "How do you find gratitude on hard days?",
      "What's the best compliment you've received?",
      "Describe a meal that brought you joy.",
      "What are you grateful for about your body?",
      "Write about a place that fills your cup.",
      "What's something beautiful about your life story?",
      "How has gratitude changed your perspective?",
      "What opportunity are you thankful for?",
      "Describe the abundance in your ordinary day.",
      "What are you grateful for that money can't buy?",
      "How will you spread gratitude this summer?",
      "What makes your life rich?",
      // June - Energy & Vitality (152-181)
      "How does your body feel right now?",
      "What gives you energy?",
      "What drains your energy?",
      "Describe your ideal relationship with exercise.",
      "How do you honor your body's needs?",
      "What does feeling healthy mean to you?",
      "Write about a time you felt physically powerful.",
      "How do you fuel yourself (food, rest, movement)?",
      "What's one healthy habit you want to strengthen?",
      "How does nature affect your energy?",
      "Describe your sleep routine.",
      "What physical activity brings you joy?",
      "How do you listen to your body's signals?",
      "What's your relationship with rest?",
      "Write about movement that feels like celebration.",
      "How do you recharge when depleted?",
      "What does your body need more of?",
      "Describe how stress shows up in your body.",
      "What energizes you in the morning?",
      "How do you wind down at night?",
      "What's one thing you love about your body?",
      "How has your energy changed over the years?",
      "What environment makes you feel most alive?",
      "Write about a moment of physical joy.",
      "How do you balance activity and rest?",
      "What does vitality look like for you?",
      "How do you care for your future self?",
      "Describe your ideal summer day.",
      "What wellness practice serves you best?",
      "How will you honor your energy this month?",
      // July - Freedom & Adventure (182-212)
      "What does freedom mean to you?",
      "Describe an adventure you dream of taking.",
      "What's the most spontaneous thing you've done?",
      "Where would you go if you could go anywhere?",
      "What rules would you break?",
      "Write about a time you stepped outside your comfort zone.",
      "What's on your bucket list?",
      "How do you define adventure in daily life?",
      "What's something wild you've always wanted to try?",
      "Describe a perfect road trip.",
      "What freedom do you take for granted?",
      "How do you balance security and adventure?",
      "Write about a travel memory.",
      "What's the bravest thing you've ever done?",
      "How do you find adventure without leaving home?",
      "What cultural experience would you love to have?",
      "Describe your relationship with spontaneity.",
      "What's holding you back from an adventure?",
      "Write about someone who lives adventurously.",
      "What would you do with a month of total freedom?",
      "How do you handle the unknown?",
      "What's an adventure you can plan for this year?",
      "Describe feeling completely free.",
      "What small adventure can you take this week?",
      "How do you create space for exploration?",
      "What have you discovered about yourself through travel?",
      "Write about a place you want to return to.",
      "What does your spirit of adventure look like?",
      "How can you bring more adventure into ordinary days?",
      "What freedom are you working toward?",
      "What adventure awaits you?",
      // August - Wisdom & Learning (213-243)
      "What's the most important thing you've learned this year?",
      "Who is the wisest person you know?",
      "What subject fascinates you?",
      "Write about a book that changed you.",
      "What life lesson took you too long to learn?",
      "How do you approach learning new things?",
      "What would you teach others?",
      "Describe a moment of sudden understanding.",
      "What do you wish you had studied?",
      "How do you learn best?",
      "Write about a teacher who impacted you.",
      "What wisdom would you share with a younger generation?",
      "How do you stay curious?",
      "What mistake taught you the most?",
      "Describe your relationship with knowledge.",
      "What question do you keep asking yourself?",
      "How has your thinking evolved?",
      "Write about a documentary or article that moved you.",
      "What's something you recently changed your mind about?",
      "How do you handle being wrong?",
      "What's a skill you're currently developing?",
      "Describe wisdom vs. intelligence.",
      "What do you want to understand better?",
      "How do you apply what you learn?",
      "Write about a hard-won insight.",
      "What's the best thing about lifelong learning?",
      "How do you share knowledge with others?",
      "What would you study if time and money were unlimited?",
      "Describe a moment of growth mindset.",
      "What learning goal do you have for fall?",
      "What has experience taught you?",
      // September - Purpose & Direction (244-273)
      "What gives your life meaning?",
      "Describe your sense of purpose.",
      "What impact do you want to have?",
      "How do you define a meaningful life?",
      "Write about a time you felt purposeful.",
      "What cause matters most to you?",
      "How do you align your actions with your values?",
      "What legacy do you want to leave?",
      "Describe your vision for the next 5 years.",
      "What would you do if you knew it would work?",
      "How do you find direction when lost?",
      "Write about someone living their purpose.",
      "What's your personal mission?",
      "How do you balance purpose and presence?",
      "What does fulfillment feel like?",
      "Write about a meaningful project or goal.",
      "How do you stay focused on what matters?",
      "What distracts you from your purpose?",
      "Describe a moment when everything made sense.",
      "What would your ideal contribution be?",
      "How do you want to be remembered?",
      "Write about finding meaning in small things.",
      "What's the next right step for you?",
      "How do you reconnect with your why?",
      "What brings you a sense of purpose daily?",
      "Describe your north star.",
      "How has your purpose evolved?",
      "What meaningful goal are you working toward?",
      "Write about purpose in ordinary moments.",
      "How will you pursue meaning this fall?",
      // October - Fears & Shadows (274-304)
      "What fear have you overcome?",
      "Write about something that scares you.",
      "How do you face the unknown?",
      "What's your relationship with darkness?",
      "Describe a fear that's actually protecting you.",
      "What would you do if you weren't afraid?",
      "How do you comfort yourself when anxious?",
      "Write about a nightmare and what it might mean.",
      "What's hiding in your shadow?",
      "How do you find courage?",
      "What fear is holding you back?",
      "Describe making peace with uncertainty.",
      "What's the worst that could happen? Really?",
      "How do you transform fear into action?",
      "Write about facing something difficult.",
      "What do you avoid thinking about?",
      "How has fear shaped your choices?",
      "What would brave you do?",
      "Describe a time fear was a teacher.",
      "What's on the other side of your fear?",
      "How do you sit with discomfort?",
      "Write about something you've been denying.",
      "What part of yourself needs acceptance?",
      "How do you build courage daily?",
      "What's a healthy fear vs. an unhealthy one?",
      "Describe your relationship with change.",
      "What are you afraid to want?",
      "How do you face your shadows?",
      "Write about growth through discomfort.",
      "What fear can you release before November?",
      "What truth have you been avoiding?",
      // November - Home & Belonging (305-334)
      "What does home mean to you?",
      "Describe where you feel you belong.",
      "What traditions give you comfort?",
      "Write about your roots.",
      "How do you create home wherever you are?",
      "What does your ideal home feel like?",
      "Who are your chosen family?",
      "Describe a meal that feels like home.",
      "What makes you feel like you belong?",
      "How do you cultivate community?",
      "Write about a place that shaped you.",
      "What objects make a space feel like yours?",
      "How do you welcome others into your life?",
      "Describe the feeling of returning home.",
      "What traditions do you want to create?",
      "How do you find belonging in new places?",
      "Write about someone who feels like home.",
      "What does sanctuary mean to you?",
      "How do you nurture your sense of belonging?",
      "What's your relationship with your hometown?",
      "Describe your inner home.",
      "What makes you feel rooted?",
      "How do you handle feeling like an outsider?",
      "Write about chosen family.",
      "What does hospitality mean to you?",
      "How do you create belonging for others?",
      "What's the heart of your home?",
      "Describe a community you're part of.",
      "What makes you grateful for your home?",
      "How will you cultivate warmth this season?",
      // December - Reflection & Renewal (335-366)
      "What was this year's biggest lesson?",
      "Describe a highlight from each month.",
      "What are you most proud of this year?",
      "Write about a challenge you overcame.",
      "What surprised you about this year?",
      "How have you grown?",
      "What relationships deepened this year?",
      "Describe a moment of joy from this year.",
      "What do you want to leave behind?",
      "How did your priorities shift?",
      "Write about a risk you took.",
      "What brought unexpected happiness?",
      "How did you take care of yourself?",
      "What goal did you achieve?",
      "Describe a moment of peace this year.",
      "What do you want more of next year?",
      "How did you show up for others?",
      "Write about something that didn't go as planned.",
      "What are you ready to release?",
      "How did you practice gratitude?",
      "What new habit stuck?",
      "Describe your year in three words.",
      "What do you appreciate about yourself?",
      "How did you handle difficult moments?",
      "Write a letter to next year's you.",
      "What do you want to remember about this year?",
      "How did you find moments of stillness?",
      "What are you hopeful about?",
      "Describe the person you're becoming.",
      "What's your intention for the new year?",
      "How will you celebrate how far you've come?",
      "What's the first thing you want to do next year?"
    ];

    // ═══════════════════════════════════════════════════════════════
    // CHALLENGES SYSTEM
    // ═══════════════════════════════════════════════════════════════
    const weeklyChallengeDefs = [
      { id: 'habits_21', name: 'Habit Hero', desc: 'Complete 21 habits this week', target: 21, type: 'habits', xp: 100, icon: '⭐' },
      { id: 'tasks_15', name: 'Task Tornado', desc: 'Complete 15 tasks this week', target: 15, type: 'tasks', xp: 75, icon: '🌪️' },
      { id: 'focus_120', name: 'Deep Focus Week', desc: 'Focus for 2 hours total', target: 120, type: 'focus', xp: 100, icon: '🎯' },
      { id: 'mood_7', name: 'Mood Tracker', desc: 'Log mood every day', target: 7, type: 'moods', xp: 50, icon: '😊' },
      { id: 'perfect_3', name: 'Triple Threat', desc: '3 perfect days', target: 3, type: 'perfect', xp: 150, icon: '✨' },
    ];

    const monthlyChallengeDefs = [
      { id: 'habits_100', name: 'Century Club', desc: '100 habits this month', target: 100, type: 'habits', xp: 300, icon: '💯' },
      { id: 'streak_14', name: 'Fortnight Force', desc: '14-day streak', target: 14, type: 'streak', xp: 200, icon: '🔥' },
      { id: 'journal_20', name: 'Diary Devotee', desc: '20 journal entries', target: 20, type: 'journal', xp: 250, icon: '📚' },
      { id: 'focus_600', name: 'Focus Master', desc: '10 hours of focus', target: 600, type: 'focus', xp: 350, icon: '🧠' },
    ];

    // ═══════════════════════════════════════════════════════════════
    // AI COACH TIPS
    // ═══════════════════════════════════════════════════════════════
    const getDailyTip = (stats, brewType) => {
      const tips = {
        coffee: {
          lowMood: "☕ Feeling a bit flat? Sometimes a change of scenery or a short walk can perk you up like a fresh espresso!",
          streakRisk: "☕ Your streak is precious! Even completing one small habit keeps the momentum brewing.",
          perfectDay: "☕ You're on fire today! Keep this energy going - you're the head barista of your life!",
          morning: "☕ Good morning! Start with your easiest habit - it's like that first sip of coffee that gets everything flowing.",
          evening: "☕ Winding down? Take a moment to reflect on your wins today. Every small step counts!",
          newUser: "☕ Welcome to the café! Start small - pick just one habit and make it your daily ritual.",
          focusTip: "☕ Try the Pomodoro technique: 25 minutes of focus, then a coffee break!",
          habitTip: "☕ Stack your habits! Do your new habit right after something you already do daily.",
        },
        tea: {
          lowMood: "🍵 Feeling low? Take a mindful moment. Brew some tea and breathe deeply - calm is coming.",
          streakRisk: "🍵 Your streak is like a delicate tea - nurture it with just one small action today.",
          perfectDay: "🍵 Beautiful harmony today! You're steeping in success and it shows!",
          morning: "🍵 Good morning! Like a gentle tea, ease into your day with your simplest habit first.",
          evening: "🍵 Evening reflection time. What brought you peace today? Savor those moments.",
          newUser: "🍵 Welcome, friend! Start with one calming habit. Let it steep into your routine naturally.",
          focusTip: "🍵 Focus is like steeping tea - give it time and attention for the best results.",
          habitTip: "🍵 Attach new habits to your tea time for a soothing ritual.",
        },
        matcha: {
          lowMood: "🍃 Feeling unbalanced? Return to your breath. Each moment is a chance to find your center again.",
          streakRisk: "🍃 Your streak is part of your practice. Honor it with even the smallest mindful action.",
          perfectDay: "🍃 Perfect balance achieved! You are the master of your own zen garden today!",
          morning: "🍃 Good morning! Begin with intention. What will bring you harmony today?",
          evening: "🍃 As the day settles, reflect on your journey. Growth happens in stillness too.",
          newUser: "🍃 Welcome to the path! One small habit, practiced with intention, creates lasting change.",
          focusTip: "🍃 Focus is meditation in action. Be present with your task, breath by breath.",
          habitTip: "🍃 Let habits flow naturally, like water finding its path. Don't force - allow.",
        }
      };
      
      const hour = new Date().getHours();
      const brewTips = tips[brewType];
      
      if (stats.moodDaysTracked > 0 && stats.lastMoodValue <= 2) return brewTips.lowMood;
      if (stats.appStreak > 3 && stats.perfectDayToday === false && hour >= 20) return brewTips.streakRisk;
      if (stats.perfectDayToday) return brewTips.perfectDay;
      if (stats.totalHabitsCompleted < 5) return brewTips.newUser;
      if (hour < 10) return brewTips.morning;
      if (hour >= 18) return brewTips.evening;
      if (Math.random() > 0.5) return brewTips.focusTip;
      return brewTips.habitTip;
    };

    // ═══════════════════════════════════════════════════════════════
    // THEME SYSTEM
    // ═══════════════════════════════════════════════════════════════
    const brewThemes = {
      coffee: {
        icon: '☕', name: 'Coffee',
        light: { id: 'coffee-light', name: 'Light Brew', icon: '☀️', bg: 'linear-gradient(180deg, #F5E6D3 0%, #FDFBF7 50%, #F5E6D3 100%)', cardBg: 'linear-gradient(145deg, #FDFBF7 0%, #FBF7F0 100%)', cardBorder: '#E8DCC8', text: '#5D4037', textSecondary: '#8B7355', textMuted: '#C4A77D', accent: '#8B7355', accentLight: '#E8DCC8', accentGradient: 'linear-gradient(145deg, #8B7355 0%, #6B5344 100%)', inputBg: '#FDFBF7', inputBorder: '#D4C4A8', progressBg: '#F0E6D8', streakGradient: 'linear-gradient(145deg, #D4A574 0%, #C4946A 100%)', navBg: 'rgba(253, 251, 247, 0.95)', modalBg: '#FDFBF7', success: '#8FB573', danger: '#C57373', xpBar: 'linear-gradient(90deg, #D4A574 0%, #8B7355 100%)', themeColor: '#5D4037', isDark: false },
        dark: { id: 'coffee-dark', name: 'Dark Brew', icon: '🌙', bg: 'linear-gradient(180deg, #1A1412 0%, #2D2320 50%, #1A1412 100%)', cardBg: 'linear-gradient(145deg, #2D2320 0%, #3D322E 100%)', cardBorder: '#4A3F3A', text: '#F5E6D3', textSecondary: '#C4A77D', textMuted: '#8B7355', accent: '#D4A574', accentLight: '#3D322E', accentGradient: 'linear-gradient(145deg, #D4A574 0%, #C4946A 100%)', inputBg: '#2D2320', inputBorder: '#4A3F3A', progressBg: '#3D322E', streakGradient: 'linear-gradient(145deg, #C4946A 0%, #A67B5B 100%)', navBg: 'rgba(45, 35, 32, 0.95)', modalBg: '#2D2320', success: '#7A9A6A', danger: '#9A6A6A', xpBar: 'linear-gradient(90deg, #C4946A 0%, #8B6B4A 100%)', themeColor: '#1A1412', isDark: true }
      },
      tea: {
        icon: '🍵', name: 'Tea',
        light: { id: 'tea-light', name: 'White Tea', icon: '☀️', bg: 'linear-gradient(180deg, #FDF8E8 0%, #FFFDF5 50%, #FDF8E8 100%)', cardBg: 'linear-gradient(145deg, #FFFDF5 0%, #FDF8E8 100%)', cardBorder: '#E8DFB8', text: '#6B5D14', textSecondary: '#8B7B34', textMuted: '#C4B477', accent: '#A8923D', accentLight: '#F0E8C8', accentGradient: 'linear-gradient(145deg, #C4A43D 0%, #A8862D 100%)', inputBg: '#FFFDF5', inputBorder: '#D4C898', progressBg: '#F5EED8', streakGradient: 'linear-gradient(145deg, #D4B454 0%, #C4A444 100%)', navBg: 'rgba(255, 253, 245, 0.95)', modalBg: '#FFFDF5', success: '#8FB573', danger: '#C57373', xpBar: 'linear-gradient(90deg, #D4B454 0%, #A8923D 100%)', themeColor: '#A8923D', isDark: false },
        dark: { id: 'tea-dark', name: 'Black Tea', icon: '🌙', bg: 'linear-gradient(180deg, #1A1808 0%, #2D2810 50%, #1A1808 100%)', cardBg: 'linear-gradient(145deg, #2D2810 0%, #3D3820 100%)', cardBorder: '#4A4530', text: '#F5EED3', textSecondary: '#C4B477', textMuted: '#8B7B34', accent: '#D4B454', accentLight: '#3D3820', accentGradient: 'linear-gradient(145deg, #D4B454 0%, #C4A444 100%)', inputBg: '#2D2810', inputBorder: '#4A4530', progressBg: '#3D3820', streakGradient: 'linear-gradient(145deg, #C4A444 0%, #A48B3B 100%)', navBg: 'rgba(45, 40, 16, 0.95)', modalBg: '#2D2810', success: '#7A9A6A', danger: '#9A6A6A', xpBar: 'linear-gradient(90deg, #C4A444 0%, #8B7B34 100%)', themeColor: '#1A1808', isDark: true }
      },
      matcha: {
        icon: '🍃', name: 'Matcha',
        light: { id: 'matcha-light', name: 'Light Matcha', icon: '☀️', bg: 'linear-gradient(180deg, #EFF5E6 0%, #F8FBF5 50%, #EFF5E6 100%)', cardBg: 'linear-gradient(145deg, #F8FBF5 0%, #EFF5E6 100%)', cardBorder: '#D4E4C4', text: '#3D5D2D', textSecondary: '#5B7B4B', textMuted: '#9AB48A', accent: '#6B8B5B', accentLight: '#E0EED4', accentGradient: 'linear-gradient(145deg, #7B9B6B 0%, #5B7B4B 100%)', inputBg: '#F8FBF5', inputBorder: '#C4D4B4', progressBg: '#E4EED8', streakGradient: 'linear-gradient(145deg, #8BAB7B 0%, #7B9B6B 100%)', navBg: 'rgba(248, 251, 245, 0.95)', modalBg: '#F8FBF5', success: '#7B9B6B', danger: '#B57373', xpBar: 'linear-gradient(90deg, #8BAB7B 0%, #6B8B5B 100%)', themeColor: '#6B8B5B', isDark: false },
        dark: { id: 'matcha-dark', name: 'Dark Matcha', icon: '🌙', bg: 'linear-gradient(180deg, #0F1A0C 0%, #1E2D18 50%, #0F1A0C 100%)', cardBg: 'linear-gradient(145deg, #1E2D18 0%, #2E3D28 100%)', cardBorder: '#3A4A34', text: '#E4EED8', textSecondary: '#9AB48A', textMuted: '#5B7B4B', accent: '#8BAB7B', accentLight: '#2E3D28', accentGradient: 'linear-gradient(145deg, #8BAB7B 0%, #7B9B6B 100%)', inputBg: '#1E2D18', inputBorder: '#3A4A34', progressBg: '#2E3D28', streakGradient: 'linear-gradient(145deg, #7B9B6B 0%, #6B8B5B 100%)', navBg: 'rgba(30, 45, 24, 0.95)', modalBg: '#1E2D18', success: '#6B8B5B', danger: '#8B5B5B', xpBar: 'linear-gradient(90deg, #7B9B6B 0%, #5B7B4B 100%)', themeColor: '#0F1A0C', isDark: true }
      }
    };

    const categories = [
      { id: 'health', name: 'Health', icon: '💪', color: '#7BB56B' },
      { id: 'work', name: 'Work', icon: '💼', color: '#8B6BB5' },
      { id: 'creative', name: 'Creative', icon: '🎨', color: '#B5956B' },
      { id: 'social', name: 'Social', icon: '👥', color: '#B56BB5' },
      { id: 'chores', name: 'Chores', icon: '🏠', color: '#6BB5B5' },
      { id: 'self', name: 'Self Care', icon: '💆', color: '#B56B8B' },
    ];

    // Habit categories for grouping
    const habitCategories = [
      { id: 'health', name: 'Health', icon: '💪', color: '#7BB56B' },
      { id: 'work', name: 'Work', icon: '💼', color: '#8B6BB5' },
      { id: 'personal', name: 'Personal', icon: '🌟', color: '#B5956B' },
      { id: 'mindfulness', name: 'Mindfulness', icon: '🧘', color: '#6BB5B5' },
    ];

    const defaultEmojis = ['💧','🏃','📖','😴','🥗','📝','🎨','🧘','💬','✨','🎵','🚶','🍃','📓','🤸','💊','🧹','🌅','🍎','💤','🎯','📱','🧠','❤️','🌿','☀️','🌙','⭐','🔥','💪'];
    const moodEmojis = [{ emoji: '😢', label: 'Rough', value: 1 }, { emoji: '😕', label: 'Meh', value: 2 }, { emoji: '😊', label: 'Good', value: 3 }, { emoji: '😄', label: 'Great', value: 4 }, { emoji: '🤩', label: 'Amazing', value: 5 }];

    // Café Decorations - unlockable with XP
    const cafeDecorations = [
      { id: 'plant1', name: 'Small Succulent', icon: '🪴', xpCost: 50, category: 'plants' },
      { id: 'plant2', name: 'Potted Fern', icon: '🌿', xpCost: 100, category: 'plants' },
      { id: 'plant3', name: 'Flower Vase', icon: '💐', xpCost: 150, category: 'plants' },
      { id: 'plant4', name: 'Bonsai Tree', icon: '🌳', xpCost: 300, category: 'plants' },
      { id: 'art1', name: 'Wall Clock', icon: '🕐', xpCost: 75, category: 'art' },
      { id: 'art2', name: 'Picture Frame', icon: '🖼️', xpCost: 125, category: 'art' },
      { id: 'art3', name: 'String Lights', icon: '✨', xpCost: 200, category: 'art' },
      { id: 'art4', name: 'Neon Sign', icon: '💡', xpCost: 400, category: 'art' },
      { id: 'cozy1', name: 'Candle', icon: '🕯️', xpCost: 60, category: 'cozy' },
      { id: 'cozy2', name: 'Books Stack', icon: '📚', xpCost: 100, category: 'cozy' },
      { id: 'cozy3', name: 'Vinyl Player', icon: '🎵', xpCost: 250, category: 'cozy' },
      { id: 'cozy4', name: 'Fireplace', icon: '🔥', xpCost: 500, category: 'cozy' },
      { id: 'pet1', name: 'Café Cat', icon: '🐱', xpCost: 350, category: 'pets' },
      { id: 'pet2', name: 'Aquarium', icon: '🐠', xpCost: 450, category: 'pets' },
    ];

    // ═══════════════════════════════════════════════════════════════
    // COZY QUOTES
    // ═══════════════════════════════════════════════════════════════
    const cozyQuotes = {
      coffee: [
        "☕ Life happens, coffee helps. You've got this!",
        "☕ Today's forecast: 100% chance of getting things done.",
        "☕ You're doing amazing, one sip at a time.",
        "☕ Behind every successful person is a substantial amount of coffee.",
        "☕ First we drink the coffee, then we do the things.",
        "☕ Good things are brewing in your life today.",
        "☕ May your coffee be strong and your Monday be short.",
        "☕ Espresso yourself! Today is YOUR day.",
        "☕ A yawn is a silent scream for coffee. We got you.",
        "☕ You're brewtiful inside and out!",
        "☕ Keep calm and drink coffee.",
        "☕ Today's goal: Coffee and kindness.",
      ],
      tea: [
        "🍵 Where there's tea, there's hope.",
        "🍵 You are tea-riffic! Remember that today.",
        "🍵 Steep dreams and peaceful moments await.",
        "🍵 Life is like a cup of tea - it's all in how you make it.",
        "🍵 Take time to stop and smell the tea leaves.",
        "🍵 A cup of tea makes everything better.",
        "🍵 Today's blend: 50% hustle, 50% calm.",
        "🍵 Serenity is just a sip away.",
        "🍵 You've got this, one cup at a time.",
        "🍵 Let your worries steep away today.",
        "🍵 Peace begins with a warm cup.",
        "🍵 You're steeped in potential!",
      ],
      matcha: [
        "🍃 Find your balance, one breath at a time.",
        "🍃 Today is full of matcha potential!",
        "🍃 Harmony is your superpower.",
        "🍃 Be like matcha: bold yet balanced.",
        "🍃 Your energy today? Sustained excellence.",
        "🍃 Green means go! Chase your dreams.",
        "🍃 Stay grounded, stay growing.",
        "🍃 Inner peace is your birthright. Claim it.",
        "🍃 You're whisking up something wonderful today.",
        "🍃 Calm mind, strong spirit, matcha heart.",
        "🍃 Flow with life's rhythm today.",
        "🍃 Your zen is showing. Keep it up!",
      ]
    };
    const getCozyQuote = (brewType) => {
      const quotes = cozyQuotes[brewType];
      const today = new Date();
      const index = (today.getDate() + today.getMonth()) % quotes.length;
      return quotes[index];
    };

    // ═══════════════════════════════════════════════════════════════
    // WHAT'S NEW CONTENT
    // ═══════════════════════════════════════════════════════════════
    const whatsNewContent = [
      { version: '8.0', title: '🚀 Major UX Improvements', items: [
        { icon: '📋', title: 'Habit Templates', desc: '10 curated habit packs to quick-start your routine!' },
        { icon: '📦', title: 'Habit Archiving', desc: 'Archive habits instead of deleting - restore anytime' },
        { icon: '⋮⋮', title: 'Drag & Drop Reorder', desc: 'Drag habits to rearrange your list' },
        { icon: '👆', title: 'Calendar Swipe', desc: 'Swipe left/right to navigate months' },
        { icon: '📅', title: 'Full Year Heatmap', desc: 'See your entire year at a glance' },
        { icon: '📊', title: 'Collapsible Stats', desc: 'Click headers to collapse sections' },
      ]},
      { version: '8.0', title: '🎨 Visual Theme Enhancements', items: [
        { icon: '☕', title: 'Coffee Cup Progress', desc: 'XP bar fills up like a coffee cup!' },
        { icon: '💨', title: 'Steam Celebrations', desc: 'Steam & confetti rise from your cup' },
        { icon: '📋', title: 'Café Menu Board', desc: 'Challenges styled as daily specials' },
        { icon: '🪧', title: 'Hanging Sign Header', desc: 'Cute swinging café sign' },
        { icon: '❄️', title: 'Seasonal Particles', desc: 'Falling snow, leaves, or petals' },
        { icon: '📜', title: 'Paper Texture', desc: 'Optional notebook/napkin feel' },
      ]},
      { version: '7.5', title: '🔧 Medium Features Update', items: [
        { icon: '📂', title: 'Habit Categories', desc: 'Group habits by Health, Work, Personal, Mindfulness' },
        { icon: '📊', title: 'Weekly Review', desc: 'See your week\'s accomplishments at a glance' },
        { icon: '💾', title: 'Task Templates', desc: 'Save common tasks and reuse them' },
        { icon: '⏭️', title: 'Habit Skip', desc: 'Skip a habit without breaking your streak' },
        { icon: '💭', title: 'Mood Notes', desc: 'Add notes explaining how you feel' },
        { icon: '✏️', title: 'Edit Items', desc: 'Edit habits & tasks, not just delete' },
      ]},
      { version: '7.2', title: '✨ Easy Wins & Extras', items: [
        { icon: '⭐', title: 'Pin Favorites', desc: 'Star habits & tasks to keep them on top' },
        { icon: '📋', title: 'Duplicate Items', desc: 'Copy habits & tasks with one tap' },
        { icon: '🍅', title: 'Timer Presets', desc: 'Quick, Pomodoro, Extended, Deep Work' },
        { icon: '🎨', title: 'Custom Colors', desc: 'Pick your own accent color in Settings' },
        { icon: '🛒', title: 'Café Decorations', desc: 'Unlock plants, art & pets with XP!' },
      ]},
    ];

    // ═══════════════════════════════════════════════════════════════
    // TUTORIAL STEPS
    // ═══════════════════════════════════════════════════════════════
    const tutorialSteps = [
      { id: 'welcome', title: 'Welcome to Daily Brew 8.0! ☕', subtitle: 'So much has changed!', content: "Wow, we've been busy! Your cozy café has gotten a major renovation with tons of new features including habit templates, archiving, drag & drop, and more. Let me give you the grand tour!", icon: '🏠', highlight: null },
      { id: 'sign', title: 'Your Café Sign', subtitle: 'Swinging in the breeze...', content: "Notice your café name now hangs on a cute wooden sign that gently sways! It's the little details that make this place feel like home.", icon: '🪧', highlight: 'header' },
      { id: 'templates', title: 'Habit Templates', subtitle: 'Quick-start your routine!', content: "New! Tap '📋 Templates' in your Habits section to browse 10 curated habit packs like Morning Brew Ritual, Zen Garden, and Brain Brew. Add entire packs with one tap!", icon: '📋', highlight: 'habits' },
      { id: 'reorder', title: 'Drag & Drop', subtitle: 'Organize your way!', content: "See the ⋮⋮ handle on each habit? Drag it to reorder your habits however you like. Your most important habits can be right at the top!", icon: '⋮⋮', highlight: 'habits' },
      { id: 'archive', title: 'Habit Archiving', subtitle: 'Nothing is lost!', content: "Instead of deleting habits, you can now archive them with 📦. This preserves your streak history! Restore archived habits anytime from the archive button.", icon: '📦', highlight: 'habits' },
      { id: 'menu', title: 'Today\'s Specials Board', subtitle: 'Challenges, café-style!', content: "Your active challenges now appear on a charming chalkboard menu. Complete the specials to earn bonus XP!", icon: '📋', highlight: 'challenges' },
      { id: 'xpbar', title: 'Coffee Cup Progress', subtitle: 'Watch it fill up!', content: "Your XP bar now fills like a coffee cup! As you earn XP, watch the liquid rise. It even shows how much XP until your next rank!", icon: '☕', highlight: 'xp' },
      { id: 'calendar', title: 'Swipe Navigation', subtitle: 'Navigate with ease!', content: "On the Calendar tab, you can now swipe left or right to navigate between months. Much faster than tapping arrows!", icon: '👆', highlight: 'calendar' },
      { id: 'yearly', title: 'Full Year Heatmap', subtitle: 'Your year at a glance!', content: "Tap '📅 Full Year' in the Calendar tab to see a GitHub-style yearly view of all your habit completions. Watch your consistency grow!", icon: '📅', highlight: 'calendar' },
      { id: 'seasonal', title: 'Seasonal Magic', subtitle: 'Watch the seasons change...', content: "Look closely - seasonal particles float across your screen! ❄️ Snowflakes in winter, 🍂 leaves in autumn, 🌸 petals in spring. Toggle this in Settings.", icon: '✨', highlight: null },
      { id: 'celebrations', title: 'Steam & Confetti', subtitle: 'Celebrate every win!', content: "When you achieve something, your brew icon appears with rising steam and confetti! Every accomplishment deserves a little celebration.", icon: '🎉', highlight: null },
      { id: 'habits', title: 'Enhanced Habits', subtitle: 'New superpowers!', content: "Habits now have categories (💪 Health, 💼 Work, 🌟 Personal, 🧘 Mindfulness). You can also ⏭️ skip a day without breaking your streak, and ✏️ edit any habit!", icon: '⭐', highlight: 'habits' },
      { id: 'tasks', title: 'Supercharged Tasks', subtitle: 'Work smarter!', content: "Tasks now have ✏️ Edit, 💾 Save as Template, and quick notes. Build a library of templates for tasks you do often!", icon: '✓', highlight: 'tasks' },
      { id: 'timer', title: 'Timer Presets', subtitle: 'Ready-made focus sessions!', content: "Quick access to ⚡ Quick (15m), 🍅 Pomodoro (25m), 📚 Extended (45m), and 🧠 Deep Work (90m). Just tap and go!", icon: '⏱️', highlight: 'timer' },
      { id: 'stats', title: 'Collapsible Stats', subtitle: 'Less clutter, more focus!', content: "The Stats tab can feel overwhelming. Now you can click any section header to collapse it. The app remembers your preferences!", icon: '📊', highlight: 'stats' },
      { id: 'visuals', title: 'Visual Settings', subtitle: 'Make it yours!', content: "In Settings, find 'Visual Effects' to toggle 📜 Paper Texture (notebook feel) and seasonal animations. Plus 16 custom accent colors!", icon: '🎨', highlight: 'settings' },
      { id: 'ready', title: 'Enjoy Your Stay! ☕', subtitle: 'Your table is ready...', content: "That's everything new! Remember: small, consistent sips of progress add up. Your cozy productivity journey continues!", icon: '✨', highlight: null },
    ];

    // ═══════════════════════════════════════════════════════════════
    // SWIPEABLE COMPONENT
    // ═══════════════════════════════════════════════════════════════
    function SwipeableCard({ children, onSwipeLeft, onSwipeRight, style }) {
      const [touchStart, setTouchStart] = useState(null);
      const [touchEnd, setTouchEnd] = useState(null);
      const [offset, setOffset] = useState(0);
      const minSwipe = 50;
      const onTouchStart = (e) => { setTouchEnd(null); setTouchStart(e.targetTouches[0].clientX); };
      const onTouchMove = (e) => { setTouchEnd(e.targetTouches[0].clientX); if (touchStart) setOffset(e.targetTouches[0].clientX - touchStart); };
      const onTouchEnd = () => { if (!touchStart || !touchEnd) { setOffset(0); return; } const dist = touchStart - touchEnd; if (dist > minSwipe && onSwipeLeft) onSwipeLeft(); if (dist < -minSwipe && onSwipeRight) onSwipeRight(); setOffset(0); };
      const bgColor = offset > minSwipe ? 'rgba(139,181,115,0.3)' : offset < -minSwipe ? 'rgba(197,115,115,0.3)' : 'transparent';
      return (<div onTouchStart={onTouchStart} onTouchMove={onTouchMove} onTouchEnd={onTouchEnd} style={{ ...style, transform: `translateX(${Math.max(-100, Math.min(100, offset * 0.5))}px)`, transition: offset === 0 ? 'transform 0.2s' : 'none', background: bgColor }}>{children}</div>);
    }

    // ═══════════════════════════════════════════════════════════════
    // MAIN APP COMPONENT
    // ═══════════════════════════════════════════════════════════════
    function App() {
      const APP_VERSION = '8.0.0';
      const season = getCurrentSeason();
      const seasonDeco = seasonalDecorations[season];

      // Core state
      const [brewType, setBrewType] = useState(() => load('brewType', 'coffee'));
      const [isDark, setIsDark] = useState(() => load('isDark', false));
      const [autoDarkMode, setAutoDarkMode] = useState(() => load('autoDarkMode', false));
      const [highContrast, setHighContrast] = useState(() => load('highContrast', false));
      
      // Auto dark mode effect
      useEffect(() => {
        if (!autoDarkMode) return;
        const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
        const handleChange = (e) => setIsDark(e.matches);
        setIsDark(mediaQuery.matches);
        mediaQuery.addEventListener('change', handleChange);
        return () => mediaQuery.removeEventListener('change', handleChange);
      }, [autoDarkMode]);
      
      const [customAccentColor, setCustomAccentColor] = useState(() => load('customAccentColor', null));
      const baseTheme = brewThemes[brewType][isDark ? 'dark' : 'light'];
      // Apply custom accent color if set
      const theme = customAccentColor ? {
        ...baseTheme,
        accent: customAccentColor,
        accentGradient: `linear-gradient(145deg, ${customAccentColor} 0%, ${customAccentColor}dd 100%)`,
        streakGradient: `linear-gradient(145deg, ${customAccentColor} 0%, ${customAccentColor}cc 100%)`,
        xpBar: `linear-gradient(90deg, ${customAccentColor} 0%, ${customAccentColor}99 100%)`
      } : baseTheme;
      const levels = brewRanks[brewType];
      const badges = brewBadges[brewType];
      const messages = brewMessages[brewType];

      const [activeTab, setActiveTab] = useState('today');
      const [habits, setHabits] = useState(() => load('habits', [{ id: 1, name: 'Drink water', icon: '💧', completed: false, streak: 0, history: {} }]));
      const [archivedHabits, setArchivedHabits] = useState(() => load('archivedHabits', []));
      const [tasks, setTasks] = useState(() => load('tasks', []));
      const [moods, setMoods] = useState(() => load('moods', {}));
      const [journal, setJournal] = useState(() => load('journal', {}));
      const [habitHistory, setHabitHistory] = useState(() => load('habitHistory', {}));
      const [gameStats, setGameStats] = useState(() => load('gameStats', { xp: 0, totalHabitsCompleted: 0, totalTasksCompleted: 0, perfectDays: 0, moodDaysTracked: 0, totalFocusMinutes: 0, journalEntries: 0, earlyTasks: 0, lateTasks: 0, appStreak: 0, maxStreak: 0, lastActiveDate: null, unlockedBadges: [], freezesAvailable: 1, freezesUsed: 0, weeklyFreeze: null, challengesCompleted: 0, timesShared: 0, timesExported: 0, lastMoodValue: 3, perfectDayToday: false }));
      const [challenges, setChallenges] = useState(() => {
        const saved = load('challenges', { weekly: { id: null, progress: 0, week: null }, monthly: { id: null, progress: 0, month: null } });
        const weekNum = getWeekNumber();
        const monthKey = getMonthKey();
        
        // Initialize weekly challenge if needed
        if (!saved.weekly.id || saved.weekly.week !== weekNum) {
          const newChallenge = weeklyChallengeDefs[Math.floor(Math.random() * weeklyChallengeDefs.length)];
          saved.weekly = { id: newChallenge.id, progress: saved.weekly.week === weekNum ? saved.weekly.progress : 0, week: weekNum };
        }
        
        // Initialize monthly challenge if needed
        if (!saved.monthly.id || saved.monthly.month !== monthKey) {
          const newChallenge = monthlyChallengeDefs[Math.floor(Math.random() * monthlyChallengeDefs.length)];
          saved.monthly = { id: newChallenge.id, progress: saved.monthly.month === monthKey ? saved.monthly.progress : 0, month: monthKey };
        }
        
        return saved;
      });
      const [dailyXPAwarded, setDailyXPAwarded] = useState(() => {
        const saved = load('dailyXPAwarded', { date: null, habits: [], tasks: [] });
        // Reset if it's a new day
        if (saved.date !== getDateKey()) return { date: getDateKey(), habits: [], tasks: [] };
        return saved;
      });
      const [cafeName, setCafeName] = useState(() => load('cafeName', 'My Daily Brew'));

      // UI state
      const [showWhatsNew, setShowWhatsNew] = useState(() => load('lastSeenVersion', '0') !== APP_VERSION);
      const [showTutorial, setShowTutorial] = useState(false);
      const [tutorialStep, setTutorialStep] = useState(0);
      const [showAddHabit, setShowAddHabit] = useState(false);
      const [showHabitTemplates, setShowHabitTemplates] = useState(false);
      const [showArchivedHabits, setShowArchivedHabits] = useState(false);
      const [showYearlyHeatmap, setShowYearlyHeatmap] = useState(false);
      const [draggedHabit, setDraggedHabit] = useState(null);
      const [dragOverHabit, setDragOverHabit] = useState(null);
      const [collapsedStats, setCollapsedStats] = useState(() => load('collapsedStats', {}));
      const [showAddTask, setShowAddTask] = useState(false);
      const [showThemePicker, setShowThemePicker] = useState(false);
      const [showSettings, setShowSettings] = useState(false);
      const [showBadges, setShowBadges] = useState(false);
      const [showQuickAdd, setShowQuickAdd] = useState(false);
      const [showSubtaskInput, setShowSubtaskInput] = useState(null);
      const [showChallenges, setShowChallenges] = useState(false);
      const [showYearReview, setShowYearReview] = useState(false);
      const [showWeeklyReview, setShowWeeklyReview] = useState(false);
      const [showTemplates, setShowTemplates] = useState(false);
      const [paperTexture, setPaperTexture] = useState(() => load('paperTexture', false));
      const [seasonalAnimations, setSeasonalAnimations] = useState(() => load('seasonalAnimations', true));
      const [unlockedDecorations, setUnlockedDecorations] = useState(() => load('unlockedDecorations', []));
      const [showDecorations, setShowDecorations] = useState(false);
      const [showFreezeAnimation, setShowFreezeAnimation] = useState(false);
      const [showCustomTimer, setShowCustomTimer] = useState(false);
      const [showExport, setShowExport] = useState(false);
      const [confirmDelete, setConfirmDelete] = useState(null); // { type: 'habit'|'task', id, name }
      const [celebration, setCelebration] = useState(null);
      const [undoAction, setUndoAction] = useState(null);
      const [showDailyTip, setShowDailyTip] = useState(() => load('lastTipDate', '') !== getDateKey());
      const [showNotificationPrompt, setShowNotificationPrompt] = useState(() => !load('notificationPromptDismissed', false));
      const [weather, setWeather] = useState(() => load('weather', { temp: null, icon: null, lastFetch: null }));
      const [newHabit, setNewHabit] = useState({ name: '', icon: '💧', category: null });
      const [editingHabit, setEditingHabit] = useState(null);
      const [editingTask, setEditingTask] = useState(null);
      const [newTask, setNewTask] = useState({ text: '', time: '', priority: 'medium', category: null, recurring: 'none', subtasks: [] });
      const [newSubtask, setNewSubtask] = useState('');
      const [calendarDate, setCalendarDate] = useState(new Date());
      const [selectedCalendarDay, setSelectedCalendarDay] = useState(null); // For day detail modal
      const [calendarViewMode, setCalendarViewMode] = useState('month'); // 'month' or 'week'
      const [calendarTouchStart, setCalendarTouchStart] = useState(null);
      const [calendarTouchEnd, setCalendarTouchEnd] = useState(null);
      const minSwipeDistance = 50;
      
      const handleCalendarSwipe = () => {
        if (!calendarTouchStart || !calendarTouchEnd) return;
        const distance = calendarTouchStart - calendarTouchEnd;
        if (Math.abs(distance) > minSwipeDistance) {
          if (calendarViewMode === 'week') {
            // Week view navigation
            if (distance > 0) {
              // Swipe left - next week
              const newDate = new Date(calendarDate);
              newDate.setDate(newDate.getDate() + 7);
              setCalendarDate(newDate);
            } else {
              // Swipe right - previous week
              const newDate = new Date(calendarDate);
              newDate.setDate(newDate.getDate() - 7);
              setCalendarDate(newDate);
            }
          } else {
            // Month view navigation
            if (distance > 0) {
              // Swipe left - next month
              setCalendarDate(new Date(calYear, calMonth + 1, 1));
            } else {
              // Swipe right - previous month
              setCalendarDate(new Date(calYear, calMonth - 1, 1));
            }
          }
        }
        setCalendarTouchStart(null);
        setCalendarTouchEnd(null);
      };
      const [selectedHeatmapDay, setSelectedHeatmapDay] = useState(null); // For heatmap tooltip
      const [heatmapFilter, setHeatmapFilter] = useState('all'); // 'all' or habit id
      const [timerSeconds, setTimerSeconds] = useState(25 * 60);
      const [timerRunning, setTimerRunning] = useState(false);
      const [timerTask, setTimerTask] = useState(null);
      const [timerStartTime, setTimerStartTime] = useState(null);
      const [customTimerMins, setCustomTimerMins] = useState(25);
      const [customTimerSecs, setCustomTimerSecs] = useState(0);
      const [ambientSound, setAmbientSound] = useState(() => load('ambientSound', 'off')); // 'off', 'ambiance', 'music', 'both'
      const [musicTrack, setMusicTrack] = useState(() => load('musicTrack', 'auto')); // 'auto' or specific track id
      const [ambianceTrack, setAmbianceTrack] = useState(() => load('ambianceTrack', 'auto')); // 'auto' or specific track id
      const [ambianceVolume, setAmbianceVolume] = useState(() => load('ambianceVolume', 35)); // 0-100
      const [musicVolume, setMusicVolume] = useState(() => load('musicVolume', 25)); // 0-100
      const [soundMood, setSoundMood] = useState(() => load('soundMood', 'auto')); // 'auto' follows theme, or specific mood
      const [backgroundPlay, setBackgroundPlay] = useState(() => load('backgroundPlay', false));
      const [soundEnabled, setSoundEnabled] = useState(false); // Whether sound is currently playing
      const [showSoundMenu, setShowSoundMenu] = useState(false);
      
      // Audio file definitions
      const musicTracks = {
        'cafe-contemplations': { name: 'Café Contemplations', icon: '☕', file: 'sounds/cafe-contemplations.mp3', theme: 'coffee', mode: 'light' },
        'elegant-background': { name: 'Elegant Background', icon: '🎹', file: 'sounds/elegant-background.mp3', theme: 'coffee', mode: 'dark' },
        'tea-time-piano': { name: 'Tea Time Piano', icon: '🍵', file: 'sounds/tea-time-piano.mp3', theme: 'tea', mode: 'light' },
        'minimal-lofi': { name: 'Minimal Lo-Fi', icon: '🎧', file: 'sounds/minimal-lofi.mp3', theme: 'tea', mode: 'dark' },
        'zen-garden': { name: 'Zen Garden', icon: '🎋', file: 'sounds/zen-garden.mp3', theme: 'matcha', mode: 'light' },
        'japanese-lofi': { name: 'Japanese Lo-Fi', icon: '🇯🇵', file: 'sounds/japanese-lofi.mp3', theme: 'matcha', mode: 'dark' },
      };
      
      const ambianceTracks = {
        'fireplace': { name: 'Fireplace', icon: '🔥', file: 'sounds/fireplace.mp3', theme: 'coffee', mood: 'cozy' },
        'rain': { name: 'Soft Rain', icon: '🌧️', file: 'sounds/rain.mp3', theme: 'tea' },
        'wind': { name: 'Wind in Trees', icon: '🍃', file: 'sounds/wind.mp3', theme: 'matcha' },
        'ocean': { name: 'Ocean Waves', icon: '🌊', file: 'sounds/ocean.mp3', mood: 'soothing' },
      };
      
      // Get active track based on auto-selection or manual override
      const getActiveMusicTrack = useCallback(() => {
        if (musicTrack !== 'auto') return musicTrack;
        // Auto selection: theme + light/dark mode
        const mode = isDark ? 'dark' : 'light';
        const match = Object.entries(musicTracks).find(([id, t]) => 
          t.theme === brewType && t.mode === mode
        );
        return match ? match[0] : 'cafe-contemplations';
      }, [musicTrack, brewType, isDark]);
      
      const getActiveAmbianceTrack = useCallback(() => {
        if (ambianceTrack !== 'auto') return ambianceTrack;
        // Auto selection based on soundMood
        if (soundMood === 'auto') {
          // Theme-based defaults: coffee→fireplace, tea→rain, matcha→wind
          if (brewType === 'coffee') return 'fireplace';
          if (brewType === 'tea') return 'rain';
          if (brewType === 'matcha') return 'wind';
          return 'fireplace';
        }
        // Manual mood selection
        if (soundMood === 'cozy') return 'fireplace';
        if (soundMood === 'rainy') return 'rain';
        if (soundMood === 'wind') return 'wind';
        if (soundMood === 'soothing') return 'ocean';
        return 'fireplace';
      }, [ambianceTrack, brewType, soundMood]);
      
      // Audio refs for HTML5 Audio elements
      const musicAudioRef = useRef(null);
      const ambianceAudioRef = useRef(null);
      
      const [todayJournal, setTodayJournal] = useState(() => load('journal', {})[getDateKey()] || { gratitude: '', reflection: '', tomorrow: '', promptResponse: '' });
      const [viewingPastJournal, setViewingPastJournal] = useState(null); // date key of entry being viewed
      
      // Get today's journal prompt (0-365 based on day of year)
      const getDayOfYear = (date) => {
        const start = new Date(date.getFullYear(), 0, 0);
        const diff = date - start;
        const oneDay = 1000 * 60 * 60 * 24;
        return Math.floor(diff / oneDay) - 1; // 0-indexed
      };
      const todayPrompt = journalPrompts[getDayOfYear(new Date())] || journalPrompts[0];
      
      const timerRef = useRef(null);

      const today = new Date();
      const todayKey = getDateKey();
      const currentYear = today.getFullYear();

      // Save effects
      useEffect(() => { store('habits', habits); }, [habits]);
      useEffect(() => { store('archivedHabits', archivedHabits); }, [archivedHabits]);
      useEffect(() => { store('collapsedStats', collapsedStats); }, [collapsedStats]);
      useEffect(() => { store('tasks', tasks); }, [tasks]);
      useEffect(() => { store('moods', moods); }, [moods]);
      useEffect(() => { store('journal', journal); }, [journal]);
      useEffect(() => { store('habitHistory', habitHistory); }, [habitHistory]);
      useEffect(() => { store('gameStats', gameStats); }, [gameStats]);
      useEffect(() => { store('challenges', challenges); }, [challenges]);
      useEffect(() => { store('unlockedDecorations', unlockedDecorations); }, [unlockedDecorations]);
      useEffect(() => { store('dailyXPAwarded', dailyXPAwarded); }, [dailyXPAwarded]);
      useEffect(() => { store('brewType', brewType); }, [brewType]);
      useEffect(() => { store('isDark', isDark); }, [isDark]);
      useEffect(() => { store('autoDarkMode', autoDarkMode); }, [autoDarkMode]);
      useEffect(() => { store('customAccentColor', customAccentColor); }, [customAccentColor]);
      useEffect(() => { store('paperTexture', paperTexture); }, [paperTexture]);
      useEffect(() => { store('seasonalAnimations', seasonalAnimations); }, [seasonalAnimations]);
      useEffect(() => { store('highContrast', highContrast); }, [highContrast]);
      useEffect(() => { store('cafeName', cafeName); }, [cafeName]);
      useEffect(() => { store('ambientSound', ambientSound); }, [ambientSound]);
      useEffect(() => { store('musicTrack', musicTrack); }, [musicTrack]);
      useEffect(() => { store('ambianceTrack', ambianceTrack); }, [ambianceTrack]);
      useEffect(() => { store('ambianceVolume', ambianceVolume); }, [ambianceVolume]);
      useEffect(() => { store('musicVolume', musicVolume); }, [musicVolume]);
      useEffect(() => { store('soundMood', soundMood); }, [soundMood]);
      useEffect(() => { store('backgroundPlay', backgroundPlay); }, [backgroundPlay]);
      useEffect(() => { store('weather', weather); }, [weather]);
      useEffect(() => { document.getElementById('themeColor').content = theme.themeColor; }, [theme]);

      // One-time streak recalculation migration (v8.1 fix)
      useEffect(() => {
        const migrationKey = 'streakMigrationV81d';
        if (load(migrationKey, false)) return; // Already ran
        
        // Read directly from localStorage to ensure we get this user's actual data
        const savedMoods = load('moods', {});
        const savedJournal = load('journal', {});
        const savedHabits = load('habits', []);
        const savedHabitHistory = load('habitHistory', {});
        const savedTasks = load('tasks', []);
        
        // Collect dates with ANY real activity
        const activeDates = new Set();
        
        // From moods - must have an actual value
        Object.entries(savedMoods).forEach(([dateKey, mood]) => {
          if (mood && typeof mood.value === 'number') {
            activeDates.add(dateKey);
          }
        });
        
        // From journal - must have actual written content
        Object.entries(savedJournal).forEach(([dateKey, entry]) => {
          if (entry && (
            (entry.gratitude && entry.gratitude.trim()) || 
            (entry.reflection && entry.reflection.trim()) || 
            (entry.tomorrow && entry.tomorrow.trim()) || 
            (entry.promptResponse && entry.promptResponse.trim())
          )) {
            activeDates.add(dateKey);
          }
        });
        
        // From habits - check history on each habit
        savedHabits.forEach(habit => {
          if (habit.history) {
            Object.entries(habit.history).forEach(([dateKey, completed]) => {
              if (completed === true) activeDates.add(dateKey);
            });
          }
        });
        
        // From habitHistory object
        Object.values(savedHabitHistory).forEach(history => {
          if (history && typeof history === 'object') {
            Object.entries(history).forEach(([dateKey, completed]) => {
              if (completed === true) activeDates.add(dateKey);
            });
          }
        });
        
        // From tasks - check if done on specific dates (via lastReset)
        savedTasks.forEach(task => {
          if (task.done && task.lastReset) {
            activeDates.add(task.lastReset);
          }
        });
        
        // Calculate consecutive streak from today going backwards
        let calculatedStreak = 0;
        const checkDate = new Date();
        
        // Check today first
        if (activeDates.has(getDateKey(checkDate))) {
          calculatedStreak = 1;
          checkDate.setDate(checkDate.getDate() - 1);
          
          // Count backwards - must be consecutive (no gaps)
          while (activeDates.has(getDateKey(checkDate))) {
            calculatedStreak++;
            checkDate.setDate(checkDate.getDate() - 1);
          }
        }
        
        // Update streak to calculated value (fix both over and under counts)
        setGameStats(s => ({
          ...s,
          appStreak: calculatedStreak,
          maxStreak: Math.max(calculatedStreak, s.maxStreak)
        }));
        
        console.log('Streak recalculated from activity data:', calculatedStreak, 'Active dates found:', [...activeDates].sort());
        
        store(migrationKey, true);
      }, []); // Run once on mount

      // Weather fetching
      useEffect(() => {
        const fetchWeather = async () => {
          // Only fetch if last fetch was more than 30 minutes ago
          if (weather.lastFetch && Date.now() - weather.lastFetch < 30 * 60 * 1000) return;
          
          try {
            // Get user's location
            if (!navigator.geolocation) return;
            
            navigator.geolocation.getCurrentPosition(async (position) => {
              const { latitude, longitude } = position.coords;
              // Using Open-Meteo (free, no API key needed)
              const response = await fetch(
                `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,weather_code&temperature_unit=fahrenheit`
              );
              if (!response.ok) return;
              const data = await response.json();
              
              // Map weather codes to icons
              const weatherIcons = {
                0: '☀️', 1: '🌤️', 2: '⛅', 3: '☁️',
                45: '🌫️', 48: '🌫️',
                51: '🌧️', 53: '🌧️', 55: '🌧️',
                61: '🌧️', 63: '🌧️', 65: '🌧️',
                71: '🌨️', 73: '🌨️', 75: '🌨️',
                77: '🌨️', 80: '🌦️', 81: '🌦️', 82: '🌦️',
                85: '🌨️', 86: '🌨️',
                95: '⛈️', 96: '⛈️', 99: '⛈️'
              };
              
              const temp = Math.round(data.current.temperature_2m);
              const icon = weatherIcons[data.current.weather_code] || '🌡️';
              
              setWeather({ temp, icon, lastFetch: Date.now() });
            }, () => {
              // Geolocation denied - silently fail
            }, { timeout: 10000 });
          } catch (e) {
            // Weather fetch failed - silently fail
          }
        };
        
        fetchWeather();
        // Refresh every 30 minutes
        const interval = setInterval(fetchWeather, 30 * 60 * 1000);
        return () => clearInterval(interval);
      }, []);

      // ═══════════════════════════════════════════════════════════════
      // AUDIO SYSTEM - HTML5 Audio with crossfade looping
      // ═══════════════════════════════════════════════════════════════
      
      const FADE_DURATION = 3000; // 3 seconds for fade in/out
      const CROSSFADE_BUFFER = 4; // Start crossfade 4 seconds before end
      
      // Refs for managing crossfade
      const musicNextRef = useRef(null); // For crossfade overlap
      const ambianceNextRef = useRef(null);
      const fadeIntervalsRef = useRef({ music: null, ambiance: null, musicNext: null, ambianceNext: null });
      
      // Fade audio volume smoothly
      const fadeAudio = useCallback((audio, fromVol, toVol, duration, onComplete) => {
        if (!audio) return null;
        const steps = 30;
        const stepTime = duration / steps;
        const volStep = (toVol - fromVol) / steps;
        let currentStep = 0;
        
        const interval = setInterval(() => {
          currentStep++;
          const newVol = Math.max(0, Math.min(1, fromVol + (volStep * currentStep)));
          try { audio.volume = newVol; } catch(e) {}
          
          if (currentStep >= steps) {
            clearInterval(interval);
            if (onComplete) onComplete();
          }
        }, stepTime);
        
        return interval;
      }, []);
      
      // Setup crossfade looping for an audio element
      const setupCrossfadeLoop = useCallback((audio, file, targetVolume, type) => {
        if (!audio) return;
        
        // Fallback: if crossfade fails, just restart with loop
        const handleEnded = () => {
          if (!audio) return;
          // Reset and replay
          audio.currentTime = 0;
          audio.volume = targetVolume;
          audio.play().catch(() => {});
        };
        audio.addEventListener('ended', handleEnded);
        
        // Also set loop as additional fallback
        audio.loop = true;
        
        const handleTimeUpdate = () => {
          if (!audio || audio.paused || isNaN(audio.duration)) return;
          
          const timeLeft = audio.duration - audio.currentTime;
          const nextRef = type === 'music' ? musicNextRef : ambianceNextRef;
          
          // Start crossfade when approaching end (only for tracks longer than CROSSFADE_BUFFER * 2)
          if (audio.duration > CROSSFADE_BUFFER * 2 && timeLeft <= CROSSFADE_BUFFER && timeLeft > CROSSFADE_BUFFER - 0.5 && !nextRef.current) {
            // Disable loop for crossfade transition
            audio.loop = false;
            
            // Create next audio for seamless loop
            const nextAudio = new Audio(file);
            nextAudio.volume = 0;
            nextAudio.loop = true; // Enable loop on the next audio
            nextAudio.play().catch(() => {});
            nextRef.current = nextAudio;
            
            // Fade out current
            fadeIntervalsRef.current[type] = fadeAudio(audio, targetVolume, 0, FADE_DURATION, () => {
              audio.pause();
              audio.currentTime = 0;
              audio.removeEventListener('ended', handleEnded);
            });
            
            // Fade in next
            fadeIntervalsRef.current[type + 'Next'] = fadeAudio(nextAudio, 0, targetVolume, FADE_DURATION, () => {
              // Swap refs - next becomes current
              if (type === 'music') {
                musicAudioRef.current = nextAudio;
                musicNextRef.current = null;
              } else {
                ambianceAudioRef.current = nextAudio;
                ambianceNextRef.current = null;
              }
              // Setup crossfade on the new current
              setupCrossfadeLoop(nextAudio, file, targetVolume, type);
            });
          }
        };
        
        audio.addEventListener('timeupdate', handleTimeUpdate);
        audio.dataset.hasCrossfade = 'true';
        
        return () => {
          audio.removeEventListener('timeupdate', handleTimeUpdate);
          audio.removeEventListener('ended', handleEnded);
        };
      }, [fadeAudio]);
      
      // Start audio with fade in
      const startAudioWithFade = useCallback((file, targetVolume, type) => {
        const audio = new Audio(file);
        audio.volume = 0;
        audio.loop = false; // We handle looping manually for crossfade
        
        audio.play().then(() => {
          // Fade in
          fadeAudio(audio, 0, targetVolume, FADE_DURATION);
          // Setup crossfade loop
          setupCrossfadeLoop(audio, file, targetVolume, type);
        }).catch(e => console.log(`${type} autoplay blocked:`, e));
        
        return audio;
      }, [fadeAudio, setupCrossfadeLoop]);
      
      // Stop audio with fade out
      const stopAudioWithFade = useCallback((audioRef, nextRef, type) => {
        // Clear any existing fade intervals
        if (fadeIntervalsRef.current[type]) clearInterval(fadeIntervalsRef.current[type]);
        if (fadeIntervalsRef.current[type + 'Next']) clearInterval(fadeIntervalsRef.current[type + 'Next']);
        
        const audio = audioRef.current;
        const next = nextRef?.current;
        
        if (audio) {
          fadeAudio(audio, audio.volume, 0, FADE_DURATION / 2, () => {
            audio.pause();
            audioRef.current = null;
          });
        }
        if (next) {
          fadeAudio(next, next.volume, 0, FADE_DURATION / 2, () => {
            next.pause();
            nextRef.current = null;
          });
        }
      }, [fadeAudio]);
      
      // Update music volume (apply to both current and next if crossfading)
      useEffect(() => {
        const vol = musicVolume / 100;
        if (musicAudioRef.current && !fadeIntervalsRef.current.music) {
          musicAudioRef.current.volume = vol;
        }
        if (musicNextRef.current && !fadeIntervalsRef.current.musicNext) {
          musicNextRef.current.volume = vol;
        }
      }, [musicVolume]);
      
      // Update ambiance volume
      useEffect(() => {
        const vol = ambianceVolume / 100;
        if (ambianceAudioRef.current && !fadeIntervalsRef.current.ambiance) {
          ambianceAudioRef.current.volume = vol;
        }
        if (ambianceNextRef.current && !fadeIntervalsRef.current.ambianceNext) {
          ambianceNextRef.current.volume = vol;
        }
      }, [ambianceVolume]);
      
      // Main audio playback effect
      useEffect(() => {
        // Stop all audio if sound is disabled or mode is off
        if (!soundEnabled || ambientSound === 'off') {
          stopAudioWithFade(musicAudioRef, musicNextRef, 'music');
          stopAudioWithFade(ambianceAudioRef, ambianceNextRef, 'ambiance');
          return;
        }
        
        // Handle music
        if (ambientSound === 'music' || ambientSound === 'both') {
          const trackId = getActiveMusicTrack();
          const track = musicTracks[trackId];
          
          if (track) {
            // Create new audio if needed or if track changed
            if (!musicAudioRef.current || musicAudioRef.current.dataset.trackId !== trackId) {
              // Fade out old track if exists
              if (musicAudioRef.current) {
                stopAudioWithFade(musicAudioRef, musicNextRef, 'music');
              }
              // Start new track with fade in
              setTimeout(() => {
                const audio = startAudioWithFade(track.file, musicVolume / 100, 'music');
                audio.dataset.trackId = trackId;
                musicAudioRef.current = audio;
              }, musicAudioRef.current ? FADE_DURATION / 2 : 0);
            }
          }
        } else {
          // Stop music if mode doesn't include it
          if (musicAudioRef.current) {
            stopAudioWithFade(musicAudioRef, musicNextRef, 'music');
          }
        }
        
        // Handle ambiance
        if (ambientSound === 'ambiance' || ambientSound === 'both') {
          const trackId = getActiveAmbianceTrack();
          const track = ambianceTracks[trackId];
          
          if (track) {
            // Create new audio if needed or if track changed
            if (!ambianceAudioRef.current || ambianceAudioRef.current.dataset.trackId !== trackId) {
              // Fade out old track if exists
              if (ambianceAudioRef.current) {
                stopAudioWithFade(ambianceAudioRef, ambianceNextRef, 'ambiance');
              }
              // Start new track with fade in
              setTimeout(() => {
                const audio = startAudioWithFade(track.file, ambianceVolume / 100, 'ambiance');
                audio.dataset.trackId = trackId;
                ambianceAudioRef.current = audio;
              }, ambianceAudioRef.current ? FADE_DURATION / 2 : 0);
            }
          }
        } else {
          // Stop ambiance if mode doesn't include it
          if (ambianceAudioRef.current) {
            stopAudioWithFade(ambianceAudioRef, ambianceNextRef, 'ambiance');
          }
        }
        
        // Cleanup on unmount
        return () => {
          // Clear all intervals
          Object.values(fadeIntervalsRef.current).forEach(i => i && clearInterval(i));
          // Stop all audio immediately on unmount
          [musicAudioRef, musicNextRef, ambianceAudioRef, ambianceNextRef].forEach(ref => {
            if (ref.current) {
              ref.current.pause();
              ref.current = null;
            }
          });
        };
      }, [soundEnabled, ambientSound, getActiveMusicTrack, getActiveAmbianceTrack, startAudioWithFade, stopAudioWithFade]);

      // Handle visibility change (pause when leaving app)
      useEffect(() => {
        const handleVisibilityChange = () => {
          if (document.hidden && !backgroundPlay) {
            setSoundEnabled(false);
          }
        };
        document.addEventListener('visibilitychange', handleVisibilityChange);
        return () => document.removeEventListener('visibilitychange', handleVisibilityChange);
      }, [backgroundPlay]);

      // Toggle sound helper
      const toggleSound = useCallback(() => {
        if (ambientSound === 'off') {
          setAmbientSound('both');
          setSoundEnabled(true);
        } else if (soundEnabled) {
          setSoundEnabled(false);
        } else {
          setSoundEnabled(true);
        }
      }, [ambientSound, soundEnabled]);

      // Daily reset & challenges
      useEffect(() => {
        const lastDate = gameStats.lastActiveDate;
        const weekNum = getWeekNumber();
        const monthKey = getMonthKey();
        
        if (lastDate !== todayKey) {
          setHabits(h => h.map(habit => ({ ...habit, completed: false })));
          
          // Reset recurring tasks
          const dayOfWeek = getDayOfWeek();
          const isWeekday = dayOfWeek >= 1 && dayOfWeek <= 5;
          setTasks(t => t.map(task => {
            if (!task.recurring || task.recurring === 'none') return task;
            if (task.recurring === 'daily') return { ...task, done: false, lastReset: todayKey, subtasks: (task.subtasks || []).map(st => ({ ...st, done: false })) };
            if (task.recurring === 'weekdays' && isWeekday) return { ...task, done: false, lastReset: todayKey, subtasks: (task.subtasks || []).map(st => ({ ...st, done: false })) };
            if (task.recurring === 'weekly' && dayOfWeek === 1) return { ...task, done: false, lastReset: todayKey, subtasks: (task.subtasks || []).map(st => ({ ...st, done: false })) };
            return task;
          }));
          
          const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
          const isConsecutive = lastDate === getDateKey(yesterday);
          
          // Track if freeze was just used this session
          let freezeUsedNow = false;
          if (!isConsecutive && lastDate && gameStats.freezesAvailable > 0) {
            freezeUsedNow = true;
            setGameStats(s => ({ ...s, freezesUsed: s.freezesUsed + 1, freezesAvailable: s.freezesAvailable - 1 }));
            setShowFreezeAnimation(true);
            setTimeout(() => setShowFreezeAnimation(false), 3000);
            triggerCelebration(messages.freeze);
          }
          if (gameStats.weeklyFreeze !== weekNum) setGameStats(s => ({ ...s, freezesAvailable: 1, weeklyFreeze: weekNum }));
          
          // Calculate new streak - use freezeUsedNow flag instead of stale state
          const newAppStreak = isConsecutive || freezeUsedNow ? gameStats.appStreak + 1 : 1;
          const streakMilestones = [
            { days: 7, msg: '🔥 1 Week Streak! You\'re on fire!', xp: 50 },
            { days: 14, msg: '⚡ 2 Week Streak! Unstoppable!', xp: 75 },
            { days: 30, msg: '🌟 1 Month Streak! Legendary!', xp: 150 },
            { days: 60, msg: '💫 2 Month Streak! Incredible!', xp: 200 },
            { days: 100, msg: '💯 100 Day Streak! AMAZING!', xp: 500 },
            { days: 365, msg: '👑 1 YEAR STREAK! You are a LEGEND!', xp: 1000 }
          ];
          const milestone = streakMilestones.find(m => m.days === newAppStreak);
          if (milestone) {
            setTimeout(() => { triggerCelebration(milestone.msg); addXP(milestone.xp); }, 1000);
          }
          setGameStats(s => ({ ...s, lastActiveDate: todayKey, appStreak: newAppStreak, maxStreak: Math.max(s.maxStreak, newAppStreak), perfectDayToday: false }));
          
          // Weekly challenge reset (new week started)
          setChallenges(c => {
            let updated = { ...c };
            if (c.weekly.week !== weekNum) {
              const newChallenge = weeklyChallengeDefs[Math.floor(Math.random() * weeklyChallengeDefs.length)];
              updated.weekly = { id: newChallenge.id, progress: 0, week: weekNum };
            }
            if (c.monthly.month !== monthKey) {
              const newChallenge = monthlyChallengeDefs[Math.floor(Math.random() * monthlyChallengeDefs.length)];
              updated.monthly = { id: newChallenge.id, progress: 0, month: monthKey };
            }
            return updated;
          });
        }
      }, []);
      
      // Periodic check for date change (handles app open across midnight)
      useEffect(() => {
        const checkDateChange = () => {
          const currentDateKey = getDateKey();
          if (gameStats.lastActiveDate && gameStats.lastActiveDate !== currentDateKey) {
            // Date has changed, trigger a reset by reloading the page
            // This ensures all state is fresh for the new day
            window.location.reload();
          }
        };
        
        // Check every minute for date changes
        const intervalId = setInterval(checkDateChange, 60000);
        
        // Also check when the page becomes visible again (e.g., user returns to tab)
        const handleVisibilityChange = () => {
          if (document.visibilityState === 'visible') {
            checkDateChange();
          }
        };
        document.addEventListener('visibilitychange', handleVisibilityChange);
        
        return () => {
          clearInterval(intervalId);
          document.removeEventListener('visibilitychange', handleVisibilityChange);
        };
      }, [gameStats.lastActiveDate]);

      // Timer
      useEffect(() => {
        if (timerRunning && timerSeconds > 0) {
          timerRef.current = setTimeout(() => setTimerSeconds(s => s - 1), 1000);
        } else if (timerRunning && timerSeconds === 0) {
          setTimerRunning(false);
          setSoundEnabled(false); // Stop sound when timer completes
          const elapsed = timerStartTime ? Math.round((Date.now() - timerStartTime) / 60000) : 25;
          setGameStats(s => ({ ...s, totalFocusMinutes: s.totalFocusMinutes + elapsed }));
          updateChallengeProgress('focus', elapsed);
          addXP(elapsed);
          triggerCelebration(messages.timerDone);
          if ('vibrate' in navigator) navigator.vibrate([200, 100, 200]);
          
          // Send notification via service worker (works better on mobile/background)
          if ('Notification' in window && Notification.permission === 'granted') {
            (async () => {
              try {
                if ('serviceWorker' in navigator) {
                  const reg = await navigator.serviceWorker.ready;
                  await reg.showNotification('My Daily Brew ☕', {
                    body: `${messages.timerDone} ${elapsed} minutes of focus earned you ${elapsed} XP!`,
                    icon: '/icons/icon-192.png',
                    tag: 'timer-complete',
                    requireInteraction: true,
                    vibrate: [200, 100, 200]
                  });
                } else {
                  new Notification('My Daily Brew', {
                    body: `${messages.timerDone} ${elapsed} minutes of focus earned you ${elapsed} XP!`,
                    icon: '/icons/icon-192.png',
                    tag: 'timer-complete'
                  });
                }
              } catch (e) { console.log('Timer notification failed:', e); }
            })();
          }
        }
        return () => clearTimeout(timerRef.current);
      }, [timerRunning, timerSeconds]);

      // Badge checking
      useEffect(() => {
        const newBadges = badges.filter(b => !gameStats.unlockedBadges.includes(b.id) && b.check(gameStats));
        if (newBadges.length > 0) {
          const updated = [...gameStats.unlockedBadges, ...newBadges.map(b => b.id)];
          setGameStats(s => ({ ...s, unlockedBadges: updated }));
          newBadges.forEach((b, i) => setTimeout(() => { triggerCelebration(`🏆 ${b.name}!`); addXP(50); }, i * 1500));
        }
      }, [gameStats, badges]);

      // Task reminder notifications - improved system
      const [notifiedTasks, setNotifiedTasks] = useState(() => {
        const saved = load('notifiedTasks', { date: null, ids: [] });
        // Reset if it's a new day
        if (saved.date !== getDateKey()) return { date: getDateKey(), ids: [] };
        return saved;
      });
      
      useEffect(() => { store('notifiedTasks', notifiedTasks); }, [notifiedTasks]);
      
      // Helper function to send notifications (uses service worker when available)
      const sendNotification = async (title, options) => {
        try {
          if ('serviceWorker' in navigator) {
            const reg = await navigator.serviceWorker.ready;
            await reg.showNotification(title, options);
            return true;
          } else {
            new Notification(title, options);
            return true;
          }
        } catch (e) {
          console.log('Notification failed:', e);
          return false;
        }
      };
      
      useEffect(() => {
        if (!('Notification' in window) || Notification.permission !== 'granted') return;
        
        const checkTaskReminders = async () => {
          const now = new Date();
          const currentMinutes = now.getHours() * 60 + now.getMinutes();
          
          // Find tasks that are due now or slightly overdue (within 5 min window)
          const dueTasks = tasks.filter(t => {
            if (!t.time || t.done) return false;
            // Already notified today?
            if (notifiedTasks.ids.includes(t.id)) return false;
            
            const [hours, mins] = t.time.split(':').map(Number);
            const taskMinutes = hours * 60 + mins;
            
            // Notify if task is due now or up to 5 minutes ago (in case we missed it)
            return currentMinutes >= taskMinutes && currentMinutes <= taskMinutes + 5;
          });
          
          dueTasks.forEach(async (task) => {
            const sent = await sendNotification('Task Reminder ☕', {
              body: `Time to: ${task.text}`,
              icon: '/icons/icon-192.png',
              tag: `task-${task.id}-${getDateKey()}`,
              requireInteraction: true,
              vibrate: [200, 100, 200]
            });
            
            if (sent) {
              // Mark as notified
              setNotifiedTasks(prev => ({
                ...prev,
                ids: [...prev.ids, task.id]
              }));
              
              // Also vibrate if supported
              if ('vibrate' in navigator) navigator.vibrate([200, 100, 200]);
            }
          });
          
          // Also check for upcoming tasks (5 min warning)
          const upcomingTasks = tasks.filter(t => {
            if (!t.time || t.done) return false;
            const warningId = `upcoming-${t.id}`;
            if (notifiedTasks.ids.includes(warningId)) return false;
            
            const [hours, mins] = t.time.split(':').map(Number);
            const taskMinutes = hours * 60 + mins;
            
            // 5 minute warning
            return currentMinutes >= taskMinutes - 5 && currentMinutes < taskMinutes;
          });
          
          upcomingTasks.forEach(async (task) => {
            const sent = await sendNotification('Upcoming Task ⏰', {
              body: `In 5 minutes: ${task.text}`,
              icon: '/icons/icon-192.png',
              tag: `upcoming-${task.id}-${getDateKey()}`,
              silent: true // Don't vibrate for upcoming, just notify
            });
            
            if (sent) {
              setNotifiedTasks(prev => ({
                ...prev,
                ids: [...prev.ids, `upcoming-${task.id}`]
              }));
            }
          });
        };
        
        // Check every 30 seconds for better accuracy
        checkTaskReminders();
        const interval = setInterval(checkTaskReminders, 30000);
        return () => clearInterval(interval);
      }, [tasks, notifiedTasks]);

      // Request notification permission on first load
      useEffect(() => {
        if ('Notification' in window && Notification.permission === 'default') {
          // Don't auto-prompt, let user initiate from settings
        }
      }, []);

      // XP and levels
      const currentLevel = useMemo(() => { for (let i = levels.length - 1; i >= 0; i--) { if (gameStats.xp >= levels[i].xp) return levels[i]; } return levels[0]; }, [gameStats.xp, levels]);
      const nextLevel = useMemo(() => { const idx = levels.findIndex(l => l.level === currentLevel.level); return levels[idx + 1] || null; }, [currentLevel, levels]);
      const xpProgress = useMemo(() => { if (!nextLevel) return 100; const min = currentLevel.xp; const need = nextLevel.xp - min; const have = gameStats.xp - min; return Math.round((have / need) * 100); }, [gameStats.xp, currentLevel, nextLevel]);
      const addXP = (amount) => setGameStats(s => ({ ...s, xp: s.xp + amount }));
      const unlockDecoration = (decoId) => {
        const deco = cafeDecorations.find(d => d.id === decoId);
        if (!deco || unlockedDecorations.includes(decoId)) return;
        if (gameStats.xp >= deco.xpCost) {
          setGameStats(s => ({ ...s, xp: s.xp - deco.xpCost }));
          setUnlockedDecorations([...unlockedDecorations, decoId]);
          triggerCelebration(`${deco.icon} ${deco.name} unlocked!`);
        }
      };
      const triggerCelebration = (msg) => { setCelebration(msg); if ('vibrate' in navigator) navigator.vibrate(100); setTimeout(() => setCelebration(null), 2500); };

      // Challenge progress
      const updateChallengeProgress = (type, amount = 1) => {
        setChallenges(c => {
          const updated = { ...c };
          // Weekly
          const wDef = weeklyChallengeDefs.find(d => d.id === c.weekly.id);
          if (wDef && wDef.type === type) {
            updated.weekly = { ...c.weekly, progress: c.weekly.progress + amount };
            if (updated.weekly.progress >= wDef.target && c.weekly.progress < wDef.target) {
              setTimeout(() => { addXP(wDef.xp); triggerCelebration(`🏅 Challenge Complete: ${wDef.name}!`); setGameStats(s => ({ ...s, challengesCompleted: s.challengesCompleted + 1 })); }, 500);
            }
          }
          // Monthly
          const mDef = monthlyChallengeDefs.find(d => d.id === c.monthly.id);
          if (mDef && mDef.type === type) {
            updated.monthly = { ...c.monthly, progress: c.monthly.progress + amount };
            if (updated.monthly.progress >= mDef.target && c.monthly.progress < mDef.target) {
              setTimeout(() => { addXP(mDef.xp); triggerCelebration(`🏅 Monthly Challenge: ${mDef.name}!`); setGameStats(s => ({ ...s, challengesCompleted: s.challengesCompleted + 1 })); }, 500);
            }
          }
          return updated;
        });
      };

      // Daily tip
      const dailyTip = useMemo(() => getDailyTip(gameStats, brewType), [gameStats, brewType]);
      const cozyQuote = useMemo(() => getCozyQuote(brewType), [brewType]);
      const dismissDailyTip = () => { setShowDailyTip(false); store('lastTipDate', todayKey); };

      // Habit actions
      const toggleHabit = (id) => {
        const habit = habits.find(h => h.id === id);
        const nowComplete = !habit.completed;
        const newHistory = { ...(habit.history || habitHistory[id] || {}), [todayKey]: nowComplete };
        setHabitHistory(h => ({ ...h, [id]: newHistory }));
        
        // Check if XP was already awarded for this habit today
        const alreadyAwarded = dailyXPAwarded.habits.includes(id);
        
        setHabits(habits.map(h => {
          if (h.id !== id) return h;
          if (nowComplete && !alreadyAwarded) { 
            addXP(10); 
            updateChallengeProgress('habits'); 
            setDailyXPAwarded(prev => ({ ...prev, habits: [...prev.habits, id] }));
            const newStreak = h.streak + 1; 
            setGameStats(s => ({ ...s, totalHabitsCompleted: s.totalHabitsCompleted + 1, maxStreak: Math.max(s.maxStreak, newStreak) })); 
            if (newStreak % 7 === 0) triggerCelebration(`🔥 ${newStreak} day streak!`); 
          }
          return { ...h, completed: nowComplete, streak: nowComplete ? h.streak + 1 : Math.max(0, h.streak - 1), history: newHistory };
        }));
        checkPerfectDay();
      };

      const addHabit = () => { if (!newHabit.name.trim()) return; setHabits([...habits, { id: Date.now(), name: newHabit.name, icon: newHabit.icon, category: newHabit.category || null, completed: false, streak: 0, history: {}, pinned: false, skippedToday: false }]); setNewHabit({ name: '', icon: '💧', category: null }); setShowAddHabit(false); setShowQuickAdd(false); };
      const togglePinHabit = (id) => setHabits(habits.map(h => h.id === id ? { ...h, pinned: !h.pinned } : h));
      const duplicateHabit = (h) => { setHabits([...habits, { ...h, id: Date.now(), completed: false, streak: 0, history: {} }]); };
      const skipHabit = (id) => setHabits(habits.map(h => h.id === id ? { ...h, skippedToday: true, completed: false } : h));
      const unskipHabit = (id) => setHabits(habits.map(h => h.id === id ? { ...h, skippedToday: false } : h));
      const editHabit = (id, updates) => { setHabits(habits.map(h => h.id === id ? { ...h, ...updates } : h)); setEditingHabit(null); };
      const confirmDeleteHabit = (id) => { const habit = habits.find(h => h.id === id); setConfirmDelete({ type: 'habit', id, name: habit.name, icon: habit.icon }); };
      const deleteHabit = (id) => { const habit = habits.find(h => h.id === id); setHabits(habits.filter(h => h.id !== id)); setUndoAction({ type: 'habit', action: () => setHabits(h => [...h, habit]) }); setTimeout(() => setUndoAction(null), 4000); setConfirmDelete(null); };
      const reorderHabit = (id, dir) => { const idx = habits.findIndex(h => h.id === id); if ((dir === -1 && idx === 0) || (dir === 1 && idx === habits.length - 1)) return; const n = [...habits]; [n[idx], n[idx + dir]] = [n[idx + dir], n[idx]]; setHabits(n); };
      
      // Drag and drop habit reordering
      const handleHabitDragStart = (e, habit) => {
        setDraggedHabit(habit);
        e.dataTransfer.effectAllowed = 'move';
        e.target.style.opacity = '0.5';
      };
      const handleHabitDragEnd = (e) => {
        e.target.style.opacity = '1';
        setDraggedHabit(null);
        setDragOverHabit(null);
      };
      const handleHabitDragOver = (e, habit) => {
        e.preventDefault();
        if (draggedHabit && habit.id !== draggedHabit.id) {
          setDragOverHabit(habit.id);
        }
      };
      const handleHabitDrop = (e, targetHabit) => {
        e.preventDefault();
        if (!draggedHabit || draggedHabit.id === targetHabit.id) return;
        const dragIdx = habits.findIndex(h => h.id === draggedHabit.id);
        const dropIdx = habits.findIndex(h => h.id === targetHabit.id);
        const newHabits = [...habits];
        newHabits.splice(dragIdx, 1);
        newHabits.splice(dropIdx, 0, draggedHabit);
        setHabits(newHabits);
        setDraggedHabit(null);
        setDragOverHabit(null);
      };
      
      // Touch-based reordering for mobile
      const [touchStartY, setTouchStartY] = useState(null);
      const [touchHabit, setTouchHabit] = useState(null);
      const handleHabitTouchStart = (e, habit) => {
        setTouchStartY(e.touches[0].clientY);
        setTouchHabit(habit);
      };
      const handleHabitTouchMove = (e, habit) => {
        if (!touchHabit || touchHabit.id !== habit.id) return;
        const currentY = e.touches[0].clientY;
        const diff = currentY - touchStartY;
        if (Math.abs(diff) > 50) {
          const dir = diff > 0 ? 1 : -1;
          reorderHabit(touchHabit.id, dir);
          setTouchStartY(currentY);
        }
      };
      const handleHabitTouchEnd = () => {
        setTouchStartY(null);
        setTouchHabit(null);
      };
      
      // Archive habit instead of deleting
      const archiveHabit = (id) => {
        const habit = habits.find(h => h.id === id);
        if (habit) {
          setArchivedHabits([...archivedHabits, { ...habit, archivedAt: new Date().toISOString() }]);
          setHabits(habits.filter(h => h.id !== id));
          setConfirmDelete(null);
        }
      };
      const restoreHabit = (id) => {
        const habit = archivedHabits.find(h => h.id === id);
        if (habit) {
          const { archivedAt, ...restored } = habit;
          setHabits([...habits, restored]);
          setArchivedHabits(archivedHabits.filter(h => h.id !== id));
        }
      };
      const permanentlyDeleteHabit = (id) => {
        setArchivedHabits(archivedHabits.filter(h => h.id !== id));
      };
      
      // Add habits from template
      const addHabitsFromTemplate = (templateId) => {
        const template = habitTemplates[templateId];
        if (!template) return;
        const newHabits = template.habits.map(h => ({
          id: Date.now() + Math.random(),
          name: h.name,
          icon: h.icon,
          completed: false,
          streak: 0,
          history: {},
          pinned: false,
          skippedToday: false
        }));
        setHabits([...habits, ...newHabits]);
        setShowHabitTemplates(false);
      };

      // Task actions
      const toggleTask = (id) => {
        // Check if XP was already awarded for this task today
        const alreadyAwarded = dailyXPAwarded.tasks.includes(id);
        
        setTasks(tasks.map(t => {
          if (t.id !== id) return t;
          const nowDone = !t.done;
          if (nowDone && !alreadyAwarded) { 
            addXP(15); 
            updateChallengeProgress('tasks'); 
            setDailyXPAwarded(prev => ({ ...prev, tasks: [...prev.tasks, id] }));
            const hour = new Date().getHours(); 
            setGameStats(s => ({ ...s, totalTasksCompleted: s.totalTasksCompleted + 1, earlyTasks: hour < 8 ? s.earlyTasks + 1 : s.earlyTasks, lateTasks: hour >= 22 ? s.lateTasks + 1 : s.lateTasks })); 
          }
          return { ...t, done: nowDone };
        }));
        checkPerfectDay();
      };

      const toggleSubtask = (taskId, subIdx) => { setTasks(tasks.map(t => { if (t.id !== taskId) return t; const subs = [...(t.subtasks || [])]; subs[subIdx] = { ...subs[subIdx], done: !subs[subIdx].done }; const allDone = subs.every(s => s.done); return { ...t, subtasks: subs, done: allDone ? true : t.done }; })); };
      const addSubtaskToTask = (taskId, text) => { if (!text.trim()) return; setTasks(tasks.map(t => t.id === taskId ? { ...t, subtasks: [...(t.subtasks || []), { text, done: false }] } : t)); setNewSubtask(''); setShowSubtaskInput(null); };
      const addTask = () => { if (!newTask.text.trim()) return; setTasks([...tasks, { ...newTask, id: Date.now(), done: false, lastReset: todayKey, pinned: false, notes: '' }]); setNewTask({ text: '', time: '', priority: 'medium', category: null, recurring: 'none', subtasks: [] }); setShowAddTask(false); setShowQuickAdd(false); };
      const togglePinTask = (id) => setTasks(tasks.map(t => t.id === id ? { ...t, pinned: !t.pinned } : t));
      const duplicateTask = (task) => { setTasks([...tasks, { ...task, id: Date.now(), done: false, notes: '' }]); };
      const editTask = (id, updates) => { setTasks(tasks.map(t => t.id === id ? { ...t, ...updates } : t)); setEditingTask(null); };
      
      // Task Templates
      const [taskTemplates, setTaskTemplates] = useState(() => load('taskTemplates', []));
      useEffect(() => { store('taskTemplates', taskTemplates); }, [taskTemplates]);
      const saveAsTemplate = (task) => { const template = { id: Date.now(), text: task.text, priority: task.priority, category: task.category, subtasks: task.subtasks || [] }; setTaskTemplates([...taskTemplates, template]); triggerCelebration('📋 Template saved!'); };
      const deleteTemplate = (id) => setTaskTemplates(taskTemplates.filter(t => t.id !== id));
      const useTemplate = (template) => { setNewTask({ ...template, time: '', recurring: 'none' }); setShowAddTask(true); };
      const updateTaskNotes = (id, notes) => setTasks(tasks.map(t => t.id === id ? { ...t, notes } : t));
      const confirmDeleteTask = (id) => { const task = tasks.find(t => t.id === id); setConfirmDelete({ type: 'task', id, name: task.text }); };
      const deleteTask = (id) => { const task = tasks.find(t => t.id === id); setTasks(tasks.filter(t => t.id !== id)); setUndoAction({ type: 'task', action: () => setTasks(ts => [...ts, task]) }); setTimeout(() => setUndoAction(null), 4000); setConfirmDelete(null); };

      const checkPerfectDay = () => { setTimeout(() => { const allH = habits.length > 0 && habits.every(h => h.completed); const activeTasks = tasks.filter(t => !t.recurring || t.recurring === 'none' || (t.recurring === 'daily') || (t.recurring === 'weekdays' && getDayOfWeek() >= 1 && getDayOfWeek() <= 5) || (t.recurring === 'weekly' && getDayOfWeek() === 1)); const allT = activeTasks.length === 0 || activeTasks.every(t => t.done); if (allH && allT && !gameStats.perfectDayToday) { setGameStats(s => ({ ...s, perfectDays: s.perfectDays + 1, perfectDayToday: true })); updateChallengeProgress('perfect'); triggerCelebration('✨ Perfect day!'); addXP(50); } }, 100); };

      const setMood = (value, note = '') => { const isNew = !moods[todayKey]; setMoods({ ...moods, [todayKey]: { value, note, time: Date.now() } }); setGameStats(s => ({ ...s, lastMoodValue: value, moodDaysTracked: isNew ? s.moodDaysTracked + 1 : s.moodDaysTracked })); if (isNew) { addXP(5); updateChallengeProgress('moods'); } };
      const updateMoodNote = (note) => { if (moods[todayKey]) setMoods({ ...moods, [todayKey]: { ...moods[todayKey], note } }); };
      const saveJournal = () => { const isNew = !journal[todayKey]; setJournal({ ...journal, [todayKey]: todayJournal }); if (isNew && (todayJournal.gratitude || todayJournal.reflection || todayJournal.tomorrow)) { setGameStats(s => ({ ...s, journalEntries: s.journalEntries + 1 })); updateChallengeProgress('journal'); addXP(10); } };

      // Share
      const shareAchievement = async (text) => {
        const shareData = { title: 'My Daily Brew', text: text, url: 'https://mydailybrew.app' };
        try {
          if (navigator.share) { await navigator.share(shareData); setGameStats(s => ({ ...s, timesShared: s.timesShared + 1 })); triggerCelebration('📤 Shared!'); }
          else { await navigator.clipboard.writeText(text); triggerCelebration('📋 Copied to clipboard!'); setGameStats(s => ({ ...s, timesShared: s.timesShared + 1 })); }
        } catch(e) { console.log('Share failed'); }
      };

      // Export
      const exportData = () => {
        const data = { habits, tasks, moods, journal, gameStats, cafeName, brewType, exportDate: new Date().toISOString() };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = `daily-brew-backup-${todayKey}.json`; a.click();
        URL.revokeObjectURL(url);
        setGameStats(s => ({ ...s, timesExported: s.timesExported + 1 }));
        triggerCelebration('💾 Data exported!');
        setShowExport(false);
      };

      // v8.0.0 has major changes - show tutorial for ALL users on this update (even existing users)
      const v8TutorialSeen = load('tutorialSeenV8', false);
      const dismissWhatsNew = () => { 
        setShowWhatsNew(false); 
        store('lastSeenVersion', APP_VERSION); 
        // Show tutorial if: new user OR updating to v8.0.0 for first time
        if (!load('tutorialSeen', false) || !v8TutorialSeen) {
          setShowTutorial(true); 
        }
      };
      const dismissTutorial = () => { 
        setShowTutorial(false); 
        store('tutorialSeen', true); 
        store('tutorialSeenV8', true); // Mark v8 tutorial as seen
      };

      // Stats
      const completedHabits = habits.filter(h => h.completed).length;
      const dayOfWeek = getDayOfWeek();
      const isWeekday = dayOfWeek >= 1 && dayOfWeek <= 5;
      const isMonday = dayOfWeek === 1;
      const todayTasks = tasks.filter(t => {
        if (!t.recurring || t.recurring === 'none') return true;
        if (t.recurring === 'daily') return true;
        if (t.recurring === 'weekdays' && isWeekday) return true;
        if (t.recurring === 'weekly' && isMonday) return true;
        return false;
      });
      const completedTasks = todayTasks.filter(t => t.done).length;
      const progress = Math.round(((completedHabits + completedTasks) / Math.max(1, habits.length + todayTasks.length)) * 100);

      // Calendar
      const calMonth = calendarDate.getMonth();
      const calYear = calendarDate.getFullYear();
      const daysInMonth = new Date(calYear, calMonth + 1, 0).getDate();
      const firstDay = new Date(calYear, calMonth, 1).getDay();
      const calDays = useMemo(() => { const d = []; for (let i = 0; i < firstDay; i++) d.push(null); for (let i = 1; i <= daysInMonth; i++) d.push(new Date(calYear, calMonth, i)); return d; }, [calYear, calMonth, firstDay, daysInMonth]);

      // Heatmap
      const heatmapData = useMemo(() => {
        const weeks = [];
        for (let w = 11; w >= 0; w--) {
          const week = [];
          for (let d = 0; d < 7; d++) {
            const date = new Date(); date.setDate(date.getDate() - (w * 7 + (6 - d)));
            const key = getDateKey(date);
            const completedCount = habits.filter(h => (h.history || habitHistory[h.id] || {})[key]).length;
            week.push({ date: key, count: completedCount, total: habits.length });
          }
          weeks.push(week);
        }
        return weeks;
      }, [habits, habitHistory]);

      // Year review
      // Mood Insights - correlate mood with habits
      const moodInsights = useMemo(() => {
        const moodDays = Object.entries(moods);
        if (moodDays.length < 3) return null;
        
        // Calculate average mood on high vs low habit completion days
        let highCompletionMoods = [];
        let lowCompletionMoods = [];
        const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        const moodByDay = { 0: [], 1: [], 2: [], 3: [], 4: [], 5: [], 6: [] };
        
        moodDays.forEach(([dateKey, moodData]) => {
          const date = new Date(dateKey);
          const dow = date.getDay();
          moodByDay[dow].push(moodData.value);
          
          // Check habit completion for that day
          const completedCount = habits.filter(h => (h.history || habitHistory[h.id] || {})[dateKey]).length;
          const completionRate = habits.length > 0 ? completedCount / habits.length : 0;
          
          if (completionRate >= 0.7) highCompletionMoods.push(moodData.value);
          else if (completionRate <= 0.3) lowCompletionMoods.push(moodData.value);
        });
        
        const avgHighCompletion = highCompletionMoods.length > 0 ? (highCompletionMoods.reduce((a, b) => a + b, 0) / highCompletionMoods.length).toFixed(1) : null;
        const avgLowCompletion = lowCompletionMoods.length > 0 ? (lowCompletionMoods.reduce((a, b) => a + b, 0) / lowCompletionMoods.length).toFixed(1) : null;
        
        // Find best/worst mood days
        const avgByDay = dayNames.map((name, i) => ({
          name,
          avg: moodByDay[i].length > 0 ? moodByDay[i].reduce((a, b) => a + b, 0) / moodByDay[i].length : null,
          count: moodByDay[i].length
        })).filter(d => d.count >= 2);
        
        const bestDay = avgByDay.length > 0 ? avgByDay.reduce((best, d) => d.avg > (best?.avg || 0) ? d : best, null) : null;
        const moodDiff = avgHighCompletion && avgLowCompletion ? (avgHighCompletion - avgLowCompletion).toFixed(1) : null;
        
        return { avgHighCompletion, avgLowCompletion, moodDiff, bestDay, hasEnoughData: moodDays.length >= 7 };
      }, [moods, habits, habitHistory]);

      const yearReview = useMemo(() => {
        const yearMoods = Object.entries(moods).filter(([k]) => k.startsWith(`${currentYear}`));
        const avgMood = yearMoods.length ? (yearMoods.reduce((s, [, v]) => s + v.value, 0) / yearMoods.length).toFixed(1) : null;
        const moodCounts = yearMoods.reduce((a, [, v]) => { a[v.value] = (a[v.value] || 0) + 1; return a; }, {});
        const totalJournal = Object.keys(journal).filter(k => k.startsWith(`${currentYear}`)).length;
        return { avgMood, moodCounts, totalJournal, daysTracked: yearMoods.length, totalHabits: gameStats.totalHabitsCompleted, totalTasks: gameStats.totalTasksCompleted, totalFocus: gameStats.totalFocusMinutes, longestStreak: gameStats.maxStreak, badgesEarned: gameStats.unlockedBadges.length };
      }, [moods, journal, gameStats, currentYear]);

      // Challenge display
      const weeklyChallenge = weeklyChallengeDefs.find(c => c.id === challenges.weekly.id);
      const monthlyChallenge = monthlyChallengeDefs.find(c => c.id === challenges.monthly.id);

      // Styles
      const s = {
        card: { background: theme.cardBg, border: `1px solid ${theme.cardBorder}`, borderRadius: '14px', padding: '12px', marginBottom: '8px' },
        btn: { background: theme.accentGradient, color: theme.isDark ? '#1a1a1a' : '#fff', border: 'none', borderRadius: '12px', padding: '12px 20px', fontFamily: "'Lora',serif", fontWeight: 600, cursor: 'pointer' },
        btnSecondary: { background: theme.progressBg, color: theme.text, border: `1px solid ${theme.cardBorder}`, borderRadius: '12px', padding: '10px 16px', fontFamily: "'Lora',serif", fontWeight: 500, cursor: 'pointer' },
        input: { background: theme.inputBg, border: `1px solid ${theme.inputBorder}`, borderRadius: '12px', padding: '12px', fontFamily: "'Lora',serif", fontSize: '1rem', color: theme.text, width: '100%', outline: 'none' },
        navItem: (a) => ({ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '2px', padding: '8px 12px', borderRadius: '12px', background: a ? theme.accentGradient : 'transparent', color: a ? (theme.isDark ? '#1a1a1a' : '#fff') : theme.textSecondary, border: 'none', cursor: 'pointer', fontFamily: "'Lora',serif", fontSize: '9px', fontWeight: a ? 600 : 400 }),
        fab: { position: 'fixed', bottom: '68px', right: '16px', width: '52px', height: '52px', borderRadius: '50%', background: theme.accentGradient, border: 'none', fontSize: '22px', cursor: 'pointer', boxShadow: '0 4px 20px rgba(0,0,0,0.3)', zIndex: 99, display: 'flex', alignItems: 'center', justifyContent: 'center', color: theme.isDark ? '#1a1a1a' : '#fff' },
        modal: { position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.6)', backdropFilter: 'blur(8px)', zIndex: 2000, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '20px' },
        modalContent: { background: theme.modalBg, borderRadius: '20px', maxWidth: '360px', width: '100%', padding: '20px', maxHeight: '85vh', overflow: 'auto' }
      };

      return (
        <div style={{ minHeight: '100vh', background: theme.bg, transition: 'background 0.4s', filter: highContrast ? 'contrast(1.2)' : 'none', position: 'relative', overflow: 'hidden' }}>
          
          {/* Paper Grain Texture Layer - Noise filter that adds texture without darkening */}
          {paperTexture && (
            <>
              {/* Primary noise layer - visible grain texture */}
              <div style={{
                position: 'fixed',
                top: 0,
                left: 0,
                right: 0,
                bottom: 0,
                backgroundImage: `url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E")`,
                backgroundSize: '180px 180px',
                backgroundRepeat: 'repeat',
                opacity: theme.isDark ? 0.5 : 0.3,
                mixBlendMode: 'overlay',
                pointerEvents: 'none',
                zIndex: 1
              }} />
              {/* Fine detail layer for paper fiber effect */}
              <div style={{
                position: 'fixed',
                top: 0,
                left: 0,
                right: 0,
                bottom: 0,
                backgroundImage: `url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='grain'%3E%3CfeTurbulence type='turbulence' baseFrequency='1.5' numOctaves='2' seed='42' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23grain)'/%3E%3C/svg%3E")`,
                backgroundSize: '80px 80px',
                backgroundRepeat: 'repeat',
                opacity: theme.isDark ? 0.35 : 0.25,
                mixBlendMode: 'overlay',
                pointerEvents: 'none',
                zIndex: 1
              }} />
            </>
          )}
          

          
          {/* Seasonal Falling Particles */}
          {seasonalAnimations && (
            <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, pointerEvents: 'none', zIndex: 0, overflow: 'hidden' }}>
              {[...Array(10)].map((_, i) => (
                <span key={i} style={{
                  position: 'absolute',
                  left: `${5 + (i * 10)}%`,
                  top: '-20px',
                  fontSize: season === 'winter' ? '0.9rem' : '1rem',
                  opacity: 0.5,
                  animation: `${season === 'winter' ? 'snowFall' : season === 'fall' ? 'leafFall' : season === 'spring' ? 'petalFall' : 'leafFall'} ${6 + (i * 1.5)}s linear infinite`,
                  animationDelay: `${i * 1.2}s`
                }}>
                  {season === 'winter' ? '❄️' : season === 'fall' ? '🍂' : season === 'spring' ? '🌸' : '☀️'}
                </span>
              ))}
            </div>
          )}
          <style>{`
            .hw { font-family: 'Caveat', cursive; }
            .bt { font-family: 'Lora', serif; }
            @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
            @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
            @keyframes pop { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.15); } }
            @keyframes signSwing { 0%, 100% { transform: rotate(-2deg); } 50% { transform: rotate(2deg); } }
            @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
            @keyframes confetti { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(-100px) rotate(720deg); opacity: 0; } }
            @keyframes freezeShimmer { 0% { transform: scale(1) rotate(0deg); filter: brightness(1); } 25% { transform: scale(1.1) rotate(-5deg); filter: brightness(1.2); } 50% { transform: scale(1.05) rotate(5deg); filter: brightness(1.1); } 75% { transform: scale(1.15) rotate(-3deg); filter: brightness(1.3); } 100% { transform: scale(1) rotate(0deg); filter: brightness(1); } }
            @keyframes iceFloat { 0%, 100% { transform: translateY(0) rotate(0deg); } 25% { transform: translateY(-10px) rotate(-5deg); } 50% { transform: translateY(-5px) rotate(5deg); } 75% { transform: translateY(-15px) rotate(-3deg); } }
            @keyframes steamRise { 0% { transform: translateY(0) scale(0.8); opacity: 0.6; } 50% { transform: translateY(-20px) scale(1); opacity: 0.3; } 100% { transform: translateY(-40px) scale(1.2); opacity: 0; } }
            @keyframes cupFill { 0% { height: 0%; } 100% { height: var(--fill-percent); } }
            @keyframes leafFall { 0% { transform: translateY(-20px) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(360deg); opacity: 0; } }
            @keyframes snowFall { 0% { transform: translateY(-20px) translateX(0); opacity: 1; } 100% { transform: translateY(100vh) translateX(20px); opacity: 0; } }
            @keyframes petalFall { 0% { transform: translateY(-20px) rotate(0deg) scale(1); opacity: 1; } 50% { transform: translateY(50vh) rotate(180deg) scale(0.8); opacity: 0.7; } 100% { transform: translateY(100vh) rotate(360deg) scale(0.6); opacity: 0; } }
            @keyframes celebrateSteam { 0% { transform: translateY(0) scale(1); opacity: 0.8; } 50% { transform: translateY(-30px) scale(1.5); opacity: 0.4; } 100% { transform: translateY(-60px) scale(2); opacity: 0; } }
            .fade { animation: fadeIn 0.3s; }
            .slide { animation: slideUp 0.4s; }
            .pop { animation: pop 0.3s; }
            .pulse { animation: pulse 2s infinite; }
            .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0; }
          `}</style>

          <div style={{ flex: 1, maxWidth: '100%', margin: '0 auto', padding: '12px 12px 70px', width: '100%', boxSizing: 'border-box', position: 'relative', zIndex: 1 }}>
            {/* Header with Cute Hanging Café Sign */}
            <header style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '14px' }}>
              <div>
                {/* Hanging Sign */}
                <div style={{ position: 'relative', display: 'inline-block' }}>
                  {/* Chain/Rope decorations */}
                  <div style={{ position: 'absolute', top: '-8px', left: '10%', width: '2px', height: '10px', background: theme.textMuted, borderRadius: '1px' }} />
                  <div style={{ position: 'absolute', top: '-8px', right: '10%', width: '2px', height: '10px', background: theme.textMuted, borderRadius: '1px' }} />
                  <h1 className="hw" style={{ 
                    fontSize: '1.5rem', 
                    color: theme.text, 
                    margin: 0, 
                    padding: '8px 16px',
                    background: theme.isDark ? 'rgba(255,255,255,0.05)' : 'rgba(139,115,85,0.1)',
                    border: `2px solid ${theme.cardBorder}`,
                    borderRadius: '8px',
                    boxShadow: `0 4px 8px ${theme.isDark ? 'rgba(0,0,0,0.3)' : 'rgba(0,0,0,0.1)'}`,
                    display: 'flex', 
                    alignItems: 'center', 
                    gap: '6px',
                    animation: 'signSwing 4s ease-in-out infinite',
                    transformOrigin: 'top center'
                  }} aria-label={`${cafeName} - ${brewThemes[brewType].name} theme`}>
                    {brewThemes[brewType].icon} {cafeName} <span style={{ fontSize: '0.9rem' }}>{seasonDeco.emoji}</span>
                  </h1>
                </div>
                <p className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary, marginTop: '6px', display: 'flex', alignItems: 'center', gap: '6px' }}>
                  {today.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' })}
                  {weather.temp && (
                    <span style={{ display: 'inline-flex', alignItems: 'center', gap: '2px', padding: '1px 6px', background: theme.progressBg, borderRadius: '8px', fontSize: '0.7rem' }}>

                      {weather.icon} {weather.temp}°
                    </span>
                  )}
                </p>
                {/* Unlocked Decorations Display */}
                {unlockedDecorations.length > 0 && (
                  <div style={{ display: 'flex', gap: '4px', marginTop: '4px', flexWrap: 'wrap' }}>
                    {unlockedDecorations.slice(0, 6).map(id => {
                      const deco = cafeDecorations.find(d => d.id === id);
                      return deco ? <span key={id} title={deco.name} style={{ fontSize: '0.9rem' }}>{deco.icon}</span> : null;
                    })}
                    {unlockedDecorations.length > 6 && <span style={{ fontSize: '0.7rem', color: theme.textMuted }}>+{unlockedDecorations.length - 6}</span>}
                  </div>
                )}
              </div>
              <div style={{ display: 'flex', gap: '6px' }}>
                {/* Shop Button - Always Visible */}
                <button onClick={() => setShowDecorations(true)} aria-label="Café Shop" style={{ background: theme.accentLight, border: `1px solid ${theme.cardBorder}`, borderRadius: '10px', padding: '6px 10px', cursor: 'pointer' }}>
                  <span>🛒</span>
                </button>
                <button onClick={() => setShowSoundMenu(true)} aria-label="Sound settings" style={{ background: soundEnabled ? theme.accentGradient : theme.accentLight, border: `1px solid ${theme.cardBorder}`, borderRadius: '10px', padding: '6px 10px', cursor: 'pointer', position: 'relative' }}>
                  <span>{soundEnabled ? '🔊' : '🔇'}</span>
                  {soundEnabled && <span style={{ position: 'absolute', top: '-2px', right: '-2px', width: '8px', height: '8px', background: '#4ade80', borderRadius: '50%', border: '2px solid ' + theme.bg }} />}
                </button>
                <button onClick={() => setShowThemePicker(true)} aria-label="Change theme" style={{ background: theme.accentLight, border: `1px solid ${theme.cardBorder}`, borderRadius: '10px', padding: '6px 10px', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '4px' }}>
                  <span>{brewThemes[brewType].icon}</span>
                  <span style={{ fontSize: '0.75rem' }}>{isDark ? '🌙' : '☀️'}</span>
                </button>
                <button onClick={() => setShowSettings(true)} aria-label="Settings" style={{ background: theme.accentLight, border: `1px solid ${theme.cardBorder}`, borderRadius: '10px', padding: '6px 10px', cursor: 'pointer' }}>⚙️</button>
              </div>
            </header>

            {/* XP Bar with Coffee Cup Progress */}
            <div style={{ ...s.card, padding: '10px 14px', display: 'flex', alignItems: 'center', gap: '10px' }} onClick={() => setShowBadges(true)} role="button" aria-label={`Level ${currentLevel.level}: ${currentLevel.title}. ${gameStats.xp} XP. Tap to view badges.`}>
              {/* Coffee Cup Fill Animation */}
              <div style={{ position: 'relative', width: '40px', height: '40px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                <div style={{ 
                  position: 'absolute', 
                  bottom: '4px', 
                  left: '50%', 
                  transform: 'translateX(-50%)',
                  width: '24px', 
                  height: '24px', 
                  borderRadius: '0 0 8px 8px',
                  background: theme.progressBg,
                  overflow: 'hidden'
                }}>
                  <div style={{ 
                    position: 'absolute',
                    bottom: 0,
                    left: 0,
                    right: 0,
                    height: `${xpProgress}%`,
                    background: theme.xpBar,
                    transition: 'height 0.5s ease-out',
                    borderRadius: '0 0 6px 6px'
                  }} />
                </div>
                <span style={{ fontSize: '1.4rem', position: 'relative', zIndex: 1 }}>{currentLevel.icon}</span>
              </div>
              <div style={{ flex: 1 }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '3px' }}>
                  <span className="bt" style={{ fontSize: '0.75rem', fontWeight: 600, color: theme.text }}>{currentLevel.title}</span>
                  <span className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted }}>{gameStats.xp} XP</span>
                </div>
                <div style={{ height: '5px', background: theme.progressBg, borderRadius: '999px', overflow: 'hidden' }} role="progressbar" aria-valuenow={xpProgress} aria-valuemin="0" aria-valuemax="100">
                  <div style={{ height: '100%', width: `${xpProgress}%`, background: theme.xpBar, borderRadius: '999px', transition: 'width 0.5s' }} />
                </div>
                {nextLevel && <p className="bt" style={{ fontSize: '0.55rem', color: theme.textMuted, marginTop: '2px' }}>{nextLevel.xp - gameStats.xp} XP to {nextLevel.title}</p>}
              </div>
              <div style={{ textAlign: 'center' }}>
                <div style={{ fontSize: '0.7rem', color: theme.textMuted }}>🏆 {gameStats.unlockedBadges.length}/{badges.length}</div>
                {gameStats.freezesAvailable > 0 && <div style={{ fontSize: '0.6rem', color: theme.accent }}>❄️ {gameStats.freezesAvailable}</div>}
              </div>
            </div>

            {/* Daily Tip Card */}
            {showDailyTip && (
              <div style={{ ...s.card, background: theme.accentLight, borderColor: theme.accent }} className="slide">
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
                  <div style={{ flex: 1 }}>
                    <p className="bt" style={{ fontSize: '0.7rem', color: theme.accent, fontWeight: 600, marginBottom: '4px' }}>🤖 Today's Barista Tip</p>
                    <p className="bt" style={{ fontSize: '0.85rem', color: theme.text, lineHeight: 1.4 }}>{dailyTip}</p>
                    <p className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary, marginTop: '8px', fontStyle: 'italic', borderTop: `1px solid ${theme.cardBorder}`, paddingTop: '8px' }}>{cozyQuote}</p>
                  </div>
                  <button onClick={dismissDailyTip} style={{ background: 'none', border: 'none', color: theme.textMuted, cursor: 'pointer', padding: '4px' }}>×</button>
                </div>
              </div>
            )}

            {/* Notification Prompt Banner */}
            {showNotificationPrompt && 'Notification' in window && Notification.permission === 'default' && (
              <div style={{ ...s.card, background: `linear-gradient(135deg, ${theme.accent}15, ${theme.accent}25)`, borderColor: theme.accent, display: 'flex', alignItems: 'center', gap: '12px' }} className="slide">
                <span style={{ fontSize: '1.5rem' }}>🔔</span>
                <div style={{ flex: 1 }}>
                  <p className="bt" style={{ fontSize: '0.8rem', fontWeight: 600, color: theme.text, marginBottom: '2px' }}>Enable Notifications?</p>
                  <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>Get reminded when timers complete & tasks are due</p>
                </div>
                <div style={{ display: 'flex', gap: '6px' }}>
                  <button 
                    onClick={async () => {
                      const permission = await Notification.requestPermission();
                      if (permission === 'granted') {
                        new Notification('My Daily Brew ☕', { 
                          body: 'You\'ll now get timer and task reminders!', 
                          icon: '/icons/icon-192.png',
                          tag: 'welcome'
                        });
                        triggerCelebration('🔔 Notifications enabled!');
                      }
                      setShowNotificationPrompt(false);
                      store('notificationPromptDismissed', true);
                    }}
                    style={{ ...s.btn, padding: '6px 12px', fontSize: '0.75rem' }}
                  >
                    Enable
                  </button>
                  <button 
                    onClick={() => { setShowNotificationPrompt(false); store('notificationPromptDismissed', true); }}
                    style={{ background: 'none', border: 'none', color: theme.textMuted, cursor: 'pointer', fontSize: '1.2rem', padding: '4px' }}
                  >
                    ×
                  </button>
                </div>
              </div>
            )}

            {/* TODAY TAB */}
            {activeTab === 'today' && (
              <div className="fade">
                {/* Progress */}
                <div style={s.card}>
                  <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                    <div>
                      <p className="bt" style={{ fontSize: '0.65rem', textTransform: 'uppercase', letterSpacing: '0.05em', color: theme.textSecondary }}>Today's Progress</p>
                      <p style={{ fontSize: '1.75rem', fontWeight: 600, color: theme.text }}>{progress}%</p>
                    </div>
                    <div className="bt" style={{ textAlign: 'right', fontSize: '0.75rem', color: theme.textSecondary }}>
                      <p><span style={{ color: theme.text, fontWeight: 600 }}>{completedHabits}</span>/{habits.length} habits</p>
                      <p><span style={{ color: theme.text, fontWeight: 600 }}>{completedTasks}</span>/{todayTasks.length} tasks</p>
                    </div>
                  </div>
                  <div style={{ height: '8px', background: theme.progressBg, borderRadius: '999px', overflow: 'hidden' }}>
                    <div style={{ height: '100%', width: `${progress}%`, background: theme.accentGradient, borderRadius: '999px', transition: 'width 0.5s' }} />
                  </div>
                </div>

                {/* Mood */}
                <div style={s.card}>
                  <p className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary, marginBottom: '8px' }}>How are you feeling?</p>
                  <div style={{ display: 'flex', justifyContent: 'space-between', gap: '5px' }} role="radiogroup" aria-label="Mood selection">
                    {moodEmojis.map(m => (
                      <button key={m.value} onClick={() => setMood(m.value)} className={moods[todayKey]?.value === m.value ? 'pop' : ''} aria-pressed={moods[todayKey]?.value === m.value} style={{ flex: 1, padding: '8px 4px', borderRadius: '12px', border: moods[todayKey]?.value === m.value ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`, background: moods[todayKey]?.value === m.value ? theme.accentLight : 'transparent', cursor: 'pointer' }}>
                        <div style={{ fontSize: '1.2rem' }}>{m.emoji}</div>
                        <div className="bt" style={{ fontSize: '0.5rem', color: theme.textMuted, marginTop: '2px' }}>{m.label}</div>
                      </button>
                    ))}
                  </div>
                  {moods[todayKey] && (
                    <input 
                      value={moods[todayKey]?.note || ''} 
                      onChange={e => updateMoodNote(e.target.value)} 
                      placeholder="Why do you feel this way? (optional)" 
                      style={{ ...s.input, marginTop: '10px', padding: '8px 10px', fontSize: '0.75rem', background: 'transparent', border: `1px dashed ${theme.cardBorder}` }} 
                    />
                  )}
                </div>

                {/* Café Menu Board - Active Challenges */}
                {(weeklyChallenge || monthlyChallenge) && (
                  <div style={{ 
                    ...s.card, 
                    cursor: 'pointer',
                    background: theme.isDark ? '#2a2520' : '#3a322a',
                    border: `3px solid ${theme.isDark ? '#4a4035' : '#5a4a3a'}`,
                    borderRadius: '4px',
                    position: 'relative',
                    boxShadow: 'inset 0 2px 4px rgba(0,0,0,0.3)'
                  }} onClick={() => setShowChallenges(true)}>
                    {/* Menu Board Header */}
                    <div style={{ textAlign: 'center', marginBottom: '10px', paddingBottom: '8px', borderBottom: `1px dashed ${theme.isDark ? '#5a5045' : '#6a5a4a'}` }}>
                      <p className="hw" style={{ fontSize: '0.9rem', color: '#f5e6d3', margin: 0, letterSpacing: '1px' }}>☕ TODAY'S SPECIALS ☕</p>
                    </div>
                    {weeklyChallenge && (
                      <div style={{ marginBottom: '8px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.75rem', marginBottom: '4px' }}>
                          <span className="hw" style={{ color: '#f5e6d3' }}>{weeklyChallenge.icon} {weeklyChallenge.name}</span>
                          <span className="bt" style={{ color: '#c4a574', fontStyle: 'italic' }}>{challenges.weekly.progress}/{weeklyChallenge.target}</span>
                        </div>
                        <div style={{ height: '6px', background: 'rgba(255,255,255,0.1)', borderRadius: '3px', overflow: 'hidden' }}>
                          <div style={{ height: '100%', width: `${Math.min(100, (challenges.weekly.progress / weeklyChallenge.target) * 100)}%`, background: 'linear-gradient(90deg, #c4a574 0%, #e5d5b5 100%)', borderRadius: '3px' }} />
                        </div>
                      </div>
                    )}
                    {monthlyChallenge && (
                      <div>
                        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.75rem', marginBottom: '4px' }}>
                          <span className="hw" style={{ color: '#f5e6d3' }}>{monthlyChallenge.icon} {monthlyChallenge.name}</span>
                          <span className="bt" style={{ color: '#c4a574', fontStyle: 'italic' }}>{challenges.monthly.progress}/{monthlyChallenge.target}</span>
                        </div>
                        <div style={{ height: '6px', background: 'rgba(255,255,255,0.1)', borderRadius: '3px', overflow: 'hidden' }}>
                          <div style={{ height: '100%', width: `${Math.min(100, (challenges.monthly.progress / monthlyChallenge.target) * 100)}%`, background: 'linear-gradient(90deg, #c4a574 0%, #e5d5b5 100%)', borderRadius: '3px' }} />
                        </div>
                      </div>
                    )}
                    <p className="bt" style={{ fontSize: '0.6rem', color: '#8a7a6a', textAlign: 'center', marginTop: '8px', fontStyle: 'italic' }}>Tap for full menu →</p>
                  </div>
                )}

                {/* Habits */}
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', margin: '14px 0 8px' }}>
                  <h2 className="bt" style={{ fontSize: '0.95rem', fontWeight: 600, color: theme.text }}>⭐ Habits</h2>
                  <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
                    <button onClick={() => setShowHabitTemplates(true)} style={{ background: theme.accentLight, border: 'none', borderRadius: '8px', padding: '5px 10px', fontSize: '0.65rem', color: theme.accent, cursor: 'pointer', fontFamily: "'Lora', serif" }} aria-label="Browse templates">📋 Templates</button>
                    {archivedHabits.length > 0 && (
                      <button onClick={() => setShowArchivedHabits(true)} style={{ background: 'none', border: `1px solid ${theme.cardBorder}`, borderRadius: '8px', padding: '5px 8px', fontSize: '0.65rem', color: theme.textSecondary, cursor: 'pointer' }} aria-label="View archived">📦 {archivedHabits.length}</button>
                    )}
                    <button onClick={() => setShowAddHabit(true)} style={{ ...s.btn, padding: '5px 12px', fontSize: '1rem' }} aria-label="Add habit">+</button>
                  </div>
                </div>

                {habits.length === 0 && <p className="bt" style={{ textAlign: 'center', color: theme.textMuted, padding: '16px' }}>{messages.emptyHabits}</p>}

                {[...habits].sort((a, b) => (b.pinned ? 1 : 0) - (a.pinned ? 1 : 0)).map((h, idx) => {
                  const habitCat = habitCategories.find(c => c.id === h.category);
                  return (
                  <SwipeableCard 
                    key={h.id} 
                    onSwipeRight={() => !h.skippedToday && toggleHabit(h.id)} 
                    draggable={true}
                    onDragStart={(e) => handleHabitDragStart(e, h)}
                    onDragEnd={handleHabitDragEnd}
                    onDragOver={(e) => handleHabitDragOver(e, h)}
                    onDrop={(e) => handleHabitDrop(e, h)}
                    style={{ 
                      ...s.card, 
                      display: 'flex', 
                      alignItems: 'center', 
                      gap: '8px', 
                      borderColor: dragOverHabit === h.id ? theme.accent : h.completed ? theme.success : h.skippedToday ? theme.textMuted : h.pinned ? theme.accent : theme.cardBorder, 
                      opacity: h.skippedToday ? 0.6 : 1,
                      transform: dragOverHabit === h.id ? 'scale(1.02)' : 'scale(1)',
                      transition: 'transform 0.2s, border-color 0.2s'
                    }}
                  >
                    {/* Drag handle */}
                    <div style={{ color: theme.textMuted, fontSize: '0.9rem', cursor: 'grab', padding: '2px', userSelect: 'none', touchAction: 'none' }} title="Drag to reorder">⋮⋮</div>
                    
                    <button onClick={() => !h.skippedToday && toggleHabit(h.id)} className={h.completed ? 'pop' : ''} aria-pressed={h.completed} disabled={h.skippedToday} style={{ width: '40px', height: '40px', borderRadius: '12px', border: h.completed ? 'none' : `2px solid ${theme.inputBorder}`, background: h.skippedToday ? theme.progressBg : h.completed ? theme.accentGradient : theme.progressBg, fontSize: '1rem', cursor: h.skippedToday ? 'not-allowed' : 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', color: h.completed ? (theme.isDark ? '#1a1a1a' : '#fff') : theme.text, flexShrink: 0 }}>
                      {h.skippedToday ? '⏭️' : h.completed ? '✓' : h.icon}
                    </button>
                    <div style={{ flex: 1, minWidth: 0 }}>
                      <p className="bt" style={{ fontSize: '0.9rem', fontWeight: 500, color: h.skippedToday ? theme.textMuted : h.completed ? theme.textMuted : theme.text, textDecoration: h.completed || h.skippedToday ? 'line-through' : 'none', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{h.pinned && '⭐ '}{h.name}</p>
                      <div style={{ display: 'flex', gap: '6px', alignItems: 'center', flexWrap: 'wrap' }}>
                        <span className="bt" style={{ fontSize: '0.6rem', padding: '2px 6px', borderRadius: '999px', background: theme.streakGradient, color: theme.isDark ? '#1a1a1a' : '#fff' }}>🔥 {h.streak}d</span>
                        {habitCat && <span style={{ fontSize: '0.55rem', padding: '1px 5px', borderRadius: '4px', background: `${habitCat.color}22`, color: habitCat.color }}>{habitCat.icon} {habitCat.name}</span>}
                        {h.skippedToday && <span className="bt" style={{ fontSize: '0.55rem', color: theme.textMuted }}>Skipped</span>}
                      </div>
                    </div>
                    {!h.completed && !h.skippedToday && (
                      <button onClick={() => skipHabit(h.id)} style={{ background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.7rem', cursor: 'pointer', padding: '4px' }} aria-label="Skip today" title="Skip (no streak penalty)">⏭️</button>
                    )}
                    {h.skippedToday && (
                      <button onClick={() => unskipHabit(h.id)} style={{ background: 'none', border: 'none', color: theme.accent, fontSize: '0.65rem', cursor: 'pointer', padding: '4px' }} aria-label="Undo skip">↩️</button>
                    )}
                    <button onClick={() => togglePinHabit(h.id)} style={{ background: 'none', border: 'none', color: h.pinned ? '#FFD700' : theme.textMuted, fontSize: '0.9rem', cursor: 'pointer', padding: '4px' }} aria-label={h.pinned ? 'Unpin' : 'Pin'}>
                      {h.pinned ? '⭐' : '☆'}
                    </button>
                    <button onClick={() => setEditingHabit(h)} style={{ background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.7rem', cursor: 'pointer', padding: '4px' }} aria-label="Edit">✏️</button>
                    <button onClick={() => archiveHabit(h.id)} style={{ background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.75rem', cursor: 'pointer', padding: '4px' }} aria-label="Archive habit" title="Archive">📦</button>
                  </SwipeableCard>
                  );
                })}

                {/* Tasks */}
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', margin: '14px 0 8px' }}>
                  <h2 className="bt" style={{ fontSize: '0.95rem', fontWeight: 600, color: theme.text }}>✓ Tasks</h2>
                  <button onClick={() => setShowAddTask(true)} style={{ ...s.btn, padding: '5px 12px', fontSize: '1rem' }} aria-label="Add task">+</button>
                </div>

                {todayTasks.length === 0 && <p className="bt" style={{ textAlign: 'center', color: theme.textMuted, padding: '16px' }}>{messages.emptyTasks}</p>}

                {[...todayTasks].sort((a, b) => (b.pinned ? 1 : 0) - (a.pinned ? 1 : 0) || ({ high: 0, medium: 1, low: 2 })[a.priority] - ({ high: 0, medium: 1, low: 2 })[b.priority]).map(task => {
                  const cat = categories.find(c => c.id === task.category);
                  const subtasksDone = (task.subtasks || []).filter(st => st.done).length;
                  const subtasksTotal = (task.subtasks || []).length;
                  return (
                    <SwipeableCard key={task.id} onSwipeRight={() => toggleTask(task.id)} style={{ ...s.card, opacity: task.done ? 0.7 : 1, borderColor: task.pinned ? theme.accent : theme.cardBorder }}>
                      <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
                        <button onClick={() => toggleTask(task.id)} className={task.done ? 'pop' : ''} style={{ width: '36px', height: '36px', borderRadius: '12px', border: task.done ? 'none' : `2px solid ${theme.inputBorder}`, background: task.done ? theme.accentGradient : theme.progressBg, fontSize: '0.9rem', cursor: 'pointer', flexShrink: 0, display: 'flex', alignItems: 'center', justifyContent: 'center', color: task.done ? (theme.isDark ? '#1a1a1a' : '#fff') : theme.text }}>
                          {task.done && '✓'}
                        </button>
                        <div style={{ flex: 1, minWidth: 0 }}>
                          <p className="bt" style={{ fontSize: '0.85rem', fontWeight: 500, color: task.done ? theme.textMuted : theme.text, textDecoration: task.done ? 'line-through' : 'none', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>{task.pinned && '⭐ '}{task.text}</p>
                          <div style={{ display: 'flex', gap: '4px', alignItems: 'center', marginTop: '3px', flexWrap: 'wrap' }}>
                            {task.time && <span className="bt" style={{ fontSize: '0.6rem', color: theme.textSecondary }}>🕐 {formatTime(task.time)}</span>}
                            {cat && <span style={{ fontSize: '0.55rem', padding: '1px 5px', borderRadius: '4px', background: `${cat.color}22`, color: cat.color }}>{cat.icon}</span>}
                            {task.recurring && task.recurring !== 'none' && <span className="bt" style={{ fontSize: '0.55rem', color: theme.accent }}>🔄 {task.recurring === 'daily' ? 'Daily' : task.recurring === 'weekdays' ? 'Weekdays' : 'Weekly'}</span>}
                            {subtasksTotal > 0 && <span className="bt" style={{ fontSize: '0.55rem', color: theme.textMuted }}>📋 {subtasksDone}/{subtasksTotal}</span>}
                            {task.notes && <span className="bt" style={{ fontSize: '0.55rem', color: theme.textMuted }}>📝</span>}
                          </div>
                        </div>
                        <button onClick={() => togglePinTask(task.id)} style={{ background: 'none', border: 'none', color: task.pinned ? '#FFD700' : theme.textMuted, fontSize: '0.8rem', cursor: 'pointer', padding: '4px' }} aria-label={task.pinned ? 'Unpin' : 'Pin'}>
                          {task.pinned ? '⭐' : '☆'}
                        </button>
                        <button onClick={() => setEditingTask(task)} style={{ background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.65rem', cursor: 'pointer', padding: '4px' }} aria-label="Edit">✏️</button>
                        <button onClick={() => saveAsTemplate(task)} style={{ background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.65rem', cursor: 'pointer', padding: '4px' }} aria-label="Save as template" title="Save as template">💾</button>
                        <button onClick={() => duplicateTask(task)} style={{ background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.7rem', cursor: 'pointer', padding: '4px' }} aria-label="Duplicate">📋</button>
                        <button onClick={() => confirmDeleteTask(task.id)} style={{ background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.9rem', cursor: 'pointer', padding: '6px' }}>🗑</button>
                      </div>
                      {subtasksTotal > 0 && (
                        <div style={{ marginTop: '8px', paddingLeft: '46px' }}>
                          {task.subtasks.map((st, i) => (
                            <div key={i} style={{ display: 'flex', alignItems: 'center', gap: '6px', marginBottom: '4px' }}>
                              <button onClick={() => toggleSubtask(task.id, i)} style={{ width: '18px', height: '18px', borderRadius: '5px', border: st.done ? 'none' : `1px solid ${theme.inputBorder}`, background: st.done ? theme.accent : 'transparent', fontSize: '0.6rem', cursor: 'pointer', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#fff' }}>{st.done && '✓'}</button>
                              <span className="bt" style={{ fontSize: '0.75rem', color: st.done ? theme.textMuted : theme.textSecondary, textDecoration: st.done ? 'line-through' : 'none' }}>{st.text}</span>
                            </div>
                          ))}
                        </div>
                      )}
                      {/* Quick Notes */}
                      <div style={{ marginTop: '6px', paddingLeft: '46px' }}>
                        <input 
                          value={task.notes || ''} 
                          onChange={e => updateTaskNotes(task.id, e.target.value)} 
                          placeholder="Add a note..." 
                          style={{ ...s.input, padding: '6px 8px', fontSize: '0.7rem', width: '100%', background: 'transparent', border: `1px dashed ${theme.cardBorder}`, borderRadius: '6px' }} 
                        />
                      </div>
                      {showSubtaskInput === task.id ? (
                        <div style={{ marginTop: '8px', paddingLeft: '46px', display: 'flex', gap: '6px' }}>
                          <input value={newSubtask} onChange={e => setNewSubtask(e.target.value)} placeholder="Add subtask..." style={{ ...s.input, padding: '8px', fontSize: '0.8rem', flex: 1 }} onKeyPress={e => e.key === 'Enter' && addSubtaskToTask(task.id, newSubtask)} autoFocus />
                          <button onClick={() => addSubtaskToTask(task.id, newSubtask)} style={{ ...s.btn, padding: '8px 12px', fontSize: '0.8rem' }}>+</button>
                        </div>
                      ) : (
                        <button onClick={() => setShowSubtaskInput(task.id)} className="bt" style={{ marginTop: '6px', marginLeft: '46px', background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.7rem', cursor: 'pointer' }}>+ Add subtask</button>
                      )}
                    </SwipeableCard>
                  );
                })}

                {/* Motivational */}
                <div style={{ ...s.card, textAlign: 'center', marginTop: '12px' }}>
                  <span style={{ fontSize: '1.1rem' }}>{brewThemes[brewType].icon}</span>
                  <p className="hw" style={{ fontSize: '1rem', color: theme.textSecondary, marginTop: '4px' }}>
                    {progress === 100 ? messages.perfect : progress > 60 ? messages.good : messages.start}
                  </p>
                </div>
              </div>
            )}

            {/* TIMER TAB */}
            {activeTab === 'timer' && (
              <div className="fade">
                <div style={{ ...s.card, textAlign: 'center', padding: '24px 16px' }}>
                  <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '4px' }}>⏱️ Focus Time</h2>
                  <p className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary, marginBottom: '16px' }}>{timerTask || messages.timerFocus}</p>
                  
                  {/* Editable Timer Display */}
                  {!timerRunning ? (
                    <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '4px', marginBottom: '16px' }}>
                      <input
                        type="number"
                        value={Math.floor(timerSeconds / 60)}
                        onChange={e => {
                          const mins = Math.max(0, Math.min(180, parseInt(e.target.value) || 0));
                          setTimerSeconds(mins * 60 + (timerSeconds % 60));
                        }}
                        style={{
                          width: '80px',
                          fontSize: '3rem',
                          fontWeight: 300,
                          color: theme.text,
                          fontFamily: "'Lora',serif",
                          background: 'transparent',
                          border: `2px dashed ${theme.cardBorder}`,
                          borderRadius: '12px',
                          textAlign: 'center',
                          outline: 'none',
                          padding: '8px 4px'
                        }}
                        min="0"
                        max="180"
                        aria-label="Minutes"
                      />
                      <span style={{ fontSize: '3rem', fontWeight: 300, color: theme.text, fontFamily: "'Lora',serif" }}>:</span>
                      <input
                        type="number"
                        value={String(timerSeconds % 60).padStart(2, '0')}
                        onChange={e => {
                          const secs = Math.max(0, Math.min(59, parseInt(e.target.value) || 0));
                          setTimerSeconds(Math.floor(timerSeconds / 60) * 60 + secs);
                        }}
                        style={{
                          width: '80px',
                          fontSize: '3rem',
                          fontWeight: 300,
                          color: theme.text,
                          fontFamily: "'Lora',serif",
                          background: 'transparent',
                          border: `2px dashed ${theme.cardBorder}`,
                          borderRadius: '12px',
                          textAlign: 'center',
                          outline: 'none',
                          padding: '8px 4px'
                        }}
                        min="0"
                        max="59"
                        aria-label="Seconds"
                      />
                    </div>
                  ) : (
                    <div style={{ fontSize: '3rem', fontWeight: 300, color: theme.text, fontFamily: "'Lora',serif", marginBottom: '16px' }} aria-live="polite">{formatTimer(timerSeconds)}</div>
                  )}
                  <p className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted, marginBottom: '12px', marginTop: '-8px' }}>{!timerRunning ? 'Tap numbers to edit' : ''}</p>

                  <div style={{ display: 'flex', gap: '8px', justifyContent: 'center', marginBottom: '16px' }}>
                    {!timerRunning ? (
                      <button onClick={() => { setTimerRunning(true); setTimerStartTime(Date.now()); if (ambientSound !== 'off') setSoundEnabled(true); }} style={{ ...s.btn, padding: '10px 24px' }}>▶ Start</button>
                    ) : (
                      <button onClick={() => { setTimerRunning(false); setSoundEnabled(false); }} style={{ ...s.btn, padding: '10px 24px' }}>⏸ Pause</button>
                    )}
                    <button onClick={() => { setTimerRunning(false); setTimerSeconds(25 * 60); setTimerTask(null); setTimerStartTime(null); setSoundEnabled(false); }} style={s.btnSecondary}>↺</button>
                    <button onClick={() => setShowSoundMenu(true)} style={{ ...s.btnSecondary, padding: '10px 14px' }}>
                      {ambientSound === 'off' ? '🔇' : soundEnabled ? '🔊' : '🔈'}
                    </button>
                  </div>
                  
                  {/* Preset buttons */}
                  <div style={{ display: 'flex', gap: '6px', justifyContent: 'center', flexWrap: 'wrap' }}>
                    {[
                      { mins: 5, label: '5m' },
                      { mins: 15, label: '15m' },
                      { mins: 25, label: '25m' },
                      { mins: 45, label: '45m' },
                      { mins: 60, label: '1h' },
                      { mins: 90, label: '1.5h' }
                    ].map(p => (
                      <button key={p.mins} onClick={() => { setTimerSeconds(p.mins * 60); setTimerRunning(false); }} style={{ padding: '6px 12px', borderRadius: '8px', border: timerSeconds === p.mins * 60 ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`, background: timerSeconds === p.mins * 60 ? theme.accentLight : 'transparent', color: timerSeconds === p.mins * 60 ? theme.accent : theme.textSecondary, fontFamily: "'Lora',serif", fontSize: '0.75rem', cursor: 'pointer' }}>{p.label}</button>
                    ))}
                  </div>
                </div>

                {soundEnabled && ambientSound !== 'off' && (
                  <div style={{ ...s.card, textAlign: 'center', background: theme.accentLight }} className="pulse">
                    <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px', flexWrap: 'wrap' }}>
                      <p className="bt" style={{ fontSize: '0.8rem', color: theme.accent }}>
                        🎵 {ambientSound === 'ambiance' && `${ambianceTracks[getActiveAmbianceTrack()]?.icon} ${ambianceTracks[getActiveAmbianceTrack()]?.name} playing...`}
                        {ambientSound === 'music' && `${musicTracks[getActiveMusicTrack()]?.icon} ${musicTracks[getActiveMusicTrack()]?.name} playing...`}
                        {ambientSound === 'both' && `${ambianceTracks[getActiveAmbianceTrack()]?.icon} + ${musicTracks[getActiveMusicTrack()]?.icon} playing...`}
                      </p>
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* JOURNAL TAB */}
            {activeTab === 'journal' && (
              <div className="fade">
                {/* Daily Prompt Card */}
                <div style={{ ...s.card, background: `linear-gradient(135deg, ${theme.cardBg}, ${theme.accent}15)`, border: `1px solid ${theme.accent}30`, marginBottom: '16px' }}>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '10px' }}>
                    <span style={{ fontSize: '1.3rem' }}>✨</span>
                    <h2 className="hw" style={{ fontSize: '1.1rem', color: theme.accent, margin: 0 }}>Today's Prompt</h2>
                    <span className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted, marginLeft: 'auto' }}>Day {getDayOfYear(new Date()) + 1} of 366</span>
                  </div>
                  <p className="bt" style={{ fontSize: '0.95rem', color: theme.text, fontStyle: 'italic', marginBottom: '12px', lineHeight: 1.5 }}>"{todayPrompt}"</p>
                  <textarea 
                    value={todayJournal.promptResponse || ''} 
                    onChange={e => setTodayJournal({ ...todayJournal, promptResponse: e.target.value })} 
                    onBlur={saveJournal} 
                    placeholder="Take a moment to reflect..." 
                    style={{ ...s.input, minHeight: '90px', resize: 'vertical', fontSize: '0.9rem', background: theme.inputBg }} 
                    aria-label="Prompt response"
                  />
                </div>
                
                <div style={s.card}>
                  <h2 className="hw" style={{ fontSize: '1.3rem', color: theme.text, marginBottom: '12px' }}>📝 Daily Reflection</h2>
                  <div style={{ marginBottom: '12px' }}>
                    <label className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, display: 'block', marginBottom: '4px' }}>🙏 3 things I'm grateful for:</label>
                    <textarea value={todayJournal.gratitude} onChange={e => setTodayJournal({ ...todayJournal, gratitude: e.target.value })} onBlur={saveJournal} placeholder="1. ...\n2. ...\n3. ..." style={{ ...s.input, minHeight: '70px', resize: 'vertical', fontSize: '0.9rem' }} aria-label="Gratitude journal" />
                  </div>
                  <div style={{ marginBottom: '12px' }}>
                    <label className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, display: 'block', marginBottom: '4px' }}>💭 How was today?</label>
                    <textarea value={todayJournal.reflection} onChange={e => setTodayJournal({ ...todayJournal, reflection: e.target.value })} onBlur={saveJournal} placeholder="What went well? What was challenging?" style={{ ...s.input, minHeight: '80px', resize: 'vertical', fontSize: '0.9rem' }} />
                  </div>
                  <div>
                    <label className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, display: 'block', marginBottom: '4px' }}>🎯 Top 3 for tomorrow:</label>
                    <textarea value={todayJournal.tomorrow} onChange={e => setTodayJournal({ ...todayJournal, tomorrow: e.target.value })} onBlur={saveJournal} placeholder="1. ...\n2. ...\n3. ..." style={{ ...s.input, minHeight: '70px', resize: 'vertical', fontSize: '0.9rem' }} />
                  </div>
                </div>
                <p className="bt" style={{ textAlign: 'center', fontSize: '0.7rem', color: theme.textMuted }}>Auto-saved • {Object.keys(journal).length} entries</p>
                
                {/* Past Journal Entries - Notebook Style */}
                {Object.keys(journal).length > 0 && (
                  <div style={{ ...s.card, marginTop: '16px', background: theme.isDark ? '#2a2520' : '#faf6f0', border: `2px solid ${theme.isDark ? '#4a3f35' : '#d4c4a8'}`, borderRadius: '12px', position: 'relative', overflow: 'hidden' }}>
                    {/* Notebook spiral binding effect */}
                    <div style={{ position: 'absolute', left: '20px', top: 0, bottom: 0, width: '2px', background: `repeating-linear-gradient(to bottom, transparent, transparent 8px, ${theme.isDark ? '#6b5a4a' : '#c9b896'} 8px, ${theme.isDark ? '#6b5a4a' : '#c9b896'} 16px)` }} />
                    <div style={{ position: 'absolute', left: '16px', top: '8px', bottom: '8px', display: 'flex', flexDirection: 'column', justifyContent: 'space-around' }}>
                      {[...Array(Math.min(8, Math.ceil((Object.keys(journal).length > 1 ? 180 : 100) / 25)))].map((_, i) => (
                        <div key={i} style={{ width: '10px', height: '10px', borderRadius: '50%', background: theme.isDark ? '#5a4a3a' : '#a89878', border: `1px solid ${theme.isDark ? '#4a3a2a' : '#8a7858'}` }} />
                      ))}
                    </div>
                    
                    <div style={{ paddingLeft: '32px' }}>
                      <h3 style={{ fontFamily: "'Caveat', cursive", fontSize: '1.4rem', color: theme.accent, marginBottom: '12px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                        📓 My Journal
                        <span className="bt" style={{ fontSize: '0.7rem', color: theme.textMuted, fontFamily: "'Lora', serif" }}>({Object.keys(journal).filter(k => k !== todayKey).length} past entries)</span>
                      </h3>
                      
                      {/* Scrollable past entries */}
                      <div style={{ maxHeight: '300px', overflowY: 'auto', paddingRight: '8px' }}>
                        {Object.keys(journal)
                          .filter(k => k !== todayKey)
                          .sort((a, b) => new Date(b) - new Date(a))
                          .map((dateKey, idx) => {
                            const entry = journal[dateKey];
                            const entryDate = new Date(dateKey);
                            const hasContent = entry.gratitude || entry.reflection || entry.tomorrow || entry.promptResponse;
                            if (!hasContent) return null;
                            
                            return (
                              <div key={dateKey} style={{ 
                                marginBottom: '16px', 
                                paddingBottom: '16px', 
                                borderBottom: idx < Object.keys(journal).filter(k => k !== todayKey).length - 1 ? `1px dashed ${theme.isDark ? '#4a3f35' : '#d4c4a8'}` : 'none',
                                background: `repeating-linear-gradient(transparent, transparent 23px, ${theme.isDark ? 'rgba(74,63,53,0.3)' : 'rgba(212,196,168,0.3)'} 24px)`
                              }}>
                                {/* Date header */}
                                <div style={{ fontFamily: "'Caveat', cursive", fontSize: '1.2rem', color: theme.accent, marginBottom: '8px', display: 'flex', alignItems: 'center', gap: '6px' }}>
                                  📅 {entryDate.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric', year: 'numeric' })}
                                </div>
                                
                                {/* Entry content */}
                                <div style={{ fontFamily: "'Caveat', cursive", fontSize: '1.1rem', color: theme.text, lineHeight: '1.6' }}>
                                  {entry.promptResponse && (
                                    <div style={{ marginBottom: '8px' }}>
                                      <span style={{ color: theme.textSecondary, fontSize: '0.95rem' }}>✨ Prompt reflection:</span>
                                      <p style={{ margin: '4px 0 0 0', whiteSpace: 'pre-wrap' }}>{entry.promptResponse}</p>
                                    </div>
                                  )}
                                  {entry.gratitude && (
                                    <div style={{ marginBottom: '8px' }}>
                                      <span style={{ color: theme.textSecondary, fontSize: '0.95rem' }}>🙏 Grateful for:</span>
                                      <p style={{ margin: '4px 0 0 0', whiteSpace: 'pre-wrap' }}>{entry.gratitude}</p>
                                    </div>
                                  )}
                                  {entry.reflection && (
                                    <div style={{ marginBottom: '8px' }}>
                                      <span style={{ color: theme.textSecondary, fontSize: '0.95rem' }}>💭 Reflection:</span>
                                      <p style={{ margin: '4px 0 0 0', whiteSpace: 'pre-wrap' }}>{entry.reflection}</p>
                                    </div>
                                  )}
                                  {entry.tomorrow && (
                                    <div>
                                      <span style={{ color: theme.textSecondary, fontSize: '0.95rem' }}>🎯 Goals set:</span>
                                      <p style={{ margin: '4px 0 0 0', whiteSpace: 'pre-wrap' }}>{entry.tomorrow}</p>
                                    </div>
                                  )}
                                </div>
                              </div>
                            );
                          })}
                        
                        {Object.keys(journal).filter(k => k !== todayKey).length === 0 && (
                          <p style={{ fontFamily: "'Caveat', cursive", fontSize: '1.1rem', color: theme.textMuted, textAlign: 'center', padding: '20px 0' }}>
                            ✍️ Your past entries will appear here...
                            <br />
                            <span style={{ fontSize: '0.95rem' }}>Start journaling today!</span>
                          </p>
                        )}
                      </div>
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* CALENDAR TAB */}
            {activeTab === 'calendar' && (
              <div className="fade">
                {/* Theme-specific icons and text */}
                {(() => {
                  const themeCalendar = {
                    coffee: { icon: '☕', bean: '☕', empty: '○', quarter: '◔', half: '◑', full: '☕', name: 'Bean', verb: 'brewing', place: 'café' },
                    tea: { icon: '🍵', bean: '🍃', empty: '○', quarter: '◔', half: '◑', full: '🍵', name: 'Leaf', verb: 'steeping', place: 'tea house' },
                    matcha: { icon: '🍃', bean: '🌿', empty: '○', quarter: '◔', half: '◑', full: '🍃', name: 'Zen', verb: 'cultivating', place: 'garden' }
                  };
                  const tc = themeCalendar[brewType] || themeCalendar.coffee;
                  
                  return (
                    <>
                {/* Current Streak Banner */}
                {gameStats.appStreak > 0 && (
                  <div style={{ 
                    background: `linear-gradient(135deg, ${theme.accent}20, ${theme.accent}40)`,
                    borderRadius: '12px',
                    padding: '12px 16px',
                    marginBottom: '16px',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'space-between',
                    border: `2px solid ${theme.accent}50`
                  }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
                      <span style={{ fontSize: '2rem' }}>🔥</span>
                      <div>
                        <div style={{ fontFamily: "'Caveat', cursive", fontSize: '1.4rem', color: theme.accent, fontWeight: 600 }}>
                          {gameStats.appStreak} Day Streak!
                        </div>
                        <div className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>
                          Best: {gameStats.maxStreak} days • Keep {tc.verb}!
                        </div>
                      </div>
                    </div>
                    <div style={{ display: 'flex', gap: '2px' }}>
                      {[...Array(Math.min(7, gameStats.appStreak))].map((_, i) => (
                        <span key={i} style={{ fontSize: '1rem', animation: `float ${1 + i * 0.1}s ease-in-out infinite alternate` }}>{tc.icon}</span>
                      ))}
                    </div>
                  </div>
                )}

                {/* Calendar Card - Café Menu Board Style */}
                <div 
                  onTouchStart={e => setCalendarTouchStart(e.targetTouches[0].clientX)}
                  onTouchMove={e => setCalendarTouchEnd(e.targetTouches[0].clientX)}
                  onTouchEnd={handleCalendarSwipe}
                  style={{ 
                    ...s.card, 
                    background: theme.isDark ? 'linear-gradient(135deg, #2a2420 0%, #1a1815 100%)' : 'linear-gradient(135deg, #3d2f1f 0%, #2a1f15 100%)',
                    border: `3px solid ${theme.isDark ? '#4a3f35' : '#5d4a3a'}`,
                    borderRadius: '16px',
                    position: 'relative',
                    overflow: 'hidden',
                    touchAction: 'pan-y'
                  }}
                >
                  {/* Chalkboard texture overlay */}
                  <div style={{ position: 'absolute', inset: 0, background: 'url("data:image/svg+xml,%3Csvg viewBox=\'0 0 100 100\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cfilter id=\'noise\'%3E%3CfeTurbulence type=\'fractalNoise\' baseFrequency=\'0.8\' numOctaves=\'4\' stitchTiles=\'stitch\'/%3E%3C/filter%3E%3Crect width=\'100%25\' height=\'100%25\' filter=\'url(%23noise)\' opacity=\'0.03\'/%3E%3C/svg%3E")', pointerEvents: 'none' }} />
                  
                  {/* Swipe hint */}
                  <div style={{ position: 'absolute', top: '8px', right: '8px', fontSize: '0.55rem', color: 'rgba(255,255,255,0.4)', fontFamily: "'Lora', serif" }}>← swipe →</div>
                  
                  {/* Header with navigation */}
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px', position: 'relative' }}>
                    <button onClick={() => {
                      if (calendarViewMode === 'week') {
                        // Navigate to previous week
                        const newDate = new Date(calendarDate);
                        newDate.setDate(newDate.getDate() - 7);
                        setCalendarDate(newDate);
                      } else {
                        // Navigate to previous month
                        setCalendarDate(new Date(calYear, calMonth - 1, 1));
                      }
                    }} style={{ background: 'rgba(255,255,255,0.1)', border: 'none', color: '#fff', fontSize: '1rem', cursor: 'pointer', padding: '8px 12px', borderRadius: '8px' }}>‹</button>
                    <div style={{ textAlign: 'center' }}>
                      <h2 style={{ fontFamily: "'Caveat', cursive", fontSize: '1.5rem', color: '#fff', margin: 0 }}>
                        {tc.icon} {calendarViewMode === 'week' 
                          ? (() => {
                              const weekStart = new Date(calendarDate);
                              weekStart.setDate(calendarDate.getDate() - calendarDate.getDay());
                              const weekEnd = new Date(weekStart);
                              weekEnd.setDate(weekStart.getDate() + 6);
                              if (weekStart.getMonth() === weekEnd.getMonth()) {
                                return `${weekStart.toLocaleDateString('en-US', { month: 'short' })} ${weekStart.getDate()}-${weekEnd.getDate()}, ${weekStart.getFullYear()}`;
                              } else {
                                return `${weekStart.toLocaleDateString('en-US', { month: 'short' })} ${weekStart.getDate()} - ${weekEnd.toLocaleDateString('en-US', { month: 'short' })} ${weekEnd.getDate()}`;
                              }
                            })()
                          : calendarDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })
                        }
                      </h2>
                      <div style={{ display: 'flex', gap: '8px', justifyContent: 'center', marginTop: '4px' }}>
                        <button 
                          onClick={() => setCalendarViewMode('month')} 
                          className="bt"
                          style={{ background: calendarViewMode === 'month' ? theme.accent : 'rgba(255,255,255,0.1)', border: 'none', color: '#fff', fontSize: '0.65rem', padding: '3px 8px', borderRadius: '10px', cursor: 'pointer' }}
                        >Month</button>
                        <button 
                          onClick={() => setCalendarViewMode('week')} 
                          className="bt"
                          style={{ background: calendarViewMode === 'week' ? theme.accent : 'rgba(255,255,255,0.1)', border: 'none', color: '#fff', fontSize: '0.65rem', padding: '3px 8px', borderRadius: '10px', cursor: 'pointer' }}
                        >Week</button>
                        <button 
                          onClick={() => { 
                            setCalendarDate(new Date());
                            setCalendarViewMode('today');
                          }} 
                          className="bt"
                          style={{ background: calendarViewMode === 'today' ? theme.accent : 'rgba(255,255,255,0.1)', border: 'none', color: '#fff', fontSize: '0.65rem', padding: '3px 8px', borderRadius: '10px', cursor: 'pointer' }}
                        >Today</button>
                      </div>
                    </div>
                    <button onClick={() => {
                      if (calendarViewMode === 'week') {
                        // Navigate to next week
                        const newDate = new Date(calendarDate);
                        newDate.setDate(newDate.getDate() + 7);
                        setCalendarDate(newDate);
                      } else {
                        // Navigate to next month
                        setCalendarDate(new Date(calYear, calMonth + 1, 1));
                      }
                    }} style={{ background: 'rgba(255,255,255,0.1)', border: 'none', color: '#fff', fontSize: '1rem', cursor: 'pointer', padding: '8px 12px', borderRadius: '8px' }}>›</button>
                  </div>

                  {/* Day headers - hide in Today view */}
                  {(calendarViewMode === 'week' || calendarViewMode === 'month') && (
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(7,1fr)', gap: '4px', marginBottom: '6px' }}>
                    {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map((d, i) => (
                      <div key={i} style={{ textAlign: 'center', fontFamily: "'Caveat', cursive", fontSize: '0.85rem', color: 'rgba(255,255,255,0.7)', padding: '4px' }}>{d}</div>
                    ))}
                  </div>
                  )}

                  {/* Today View - Single day large format */}
                  {calendarViewMode === 'today' && (() => {
                    const todayKey = getDateKey(today);
                    const todayMood = moods[todayKey];
                    const todayJournalData = journal[todayKey];
                    const hasJournal = todayJournalData && (todayJournalData.gratitude || todayJournalData.reflection || todayJournalData.tomorrow || todayJournalData.promptResponse);
                    const completedHabits = habits.filter(h => h.completed);
                    const completedTasks = tasks.filter(t => t.done);
                    const habitProgress = habits.length > 0 ? completedHabits.length / habits.length : 0;
                    
                    return (
                      <div style={{ 
                        background: 'rgba(255,255,255,0.08)', 
                        borderRadius: '12px', 
                        padding: '20px',
                        fontFamily: "'Courier New', monospace"
                      }}>
                        {/* Date header */}
                        <div style={{ textAlign: 'center', marginBottom: '16px' }}>
                          <div style={{ fontSize: '2.5rem', fontFamily: "'Caveat', cursive", color: theme.accent }}>
                            {today.getDate()}
                          </div>
                          <div style={{ fontSize: '0.9rem', color: theme.textSecondary }}>
                            {today.toLocaleDateString('en-US', { weekday: 'long', month: 'long', year: 'numeric' })}
                          </div>
                        </div>
                        
                        {/* Progress ring */}
                        <div style={{ display: 'flex', justifyContent: 'center', marginBottom: '20px' }}>
                          <div style={{ 
                            width: '100px', 
                            height: '100px', 
                            borderRadius: '50%', 
                            background: `conic-gradient(${theme.accent} ${habitProgress * 360}deg, rgba(255,255,255,0.1) 0deg)`,
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center'
                          }}>
                            <div style={{ 
                              width: '80px', 
                              height: '80px', 
                              borderRadius: '50%', 
                              background: theme.cardBg,
                              display: 'flex',
                              alignItems: 'center',
                              justifyContent: 'center',
                              flexDirection: 'column'
                            }}>
                              <span style={{ fontSize: '1.5rem' }}>{tc.full}</span>
                              <span style={{ fontSize: '0.7rem', color: theme.textSecondary }}>{Math.round(habitProgress * 100)}%</span>
                            </div>
                          </div>
                        </div>
                        
                        {/* Stats grid */}
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px', marginBottom: '16px' }}>
                          <div style={{ background: 'rgba(255,255,255,0.05)', padding: '12px', borderRadius: '8px', textAlign: 'center' }}>
                            <div style={{ fontSize: '1.5rem', color: theme.accent }}>{completedHabits.length}/{habits.length}</div>
                            <div style={{ fontSize: '0.7rem', color: theme.textSecondary }}>Habits</div>
                          </div>
                          <div style={{ background: 'rgba(255,255,255,0.05)', padding: '12px', borderRadius: '8px', textAlign: 'center' }}>
                            <div style={{ fontSize: '1.5rem', color: theme.accent }}>{completedTasks.length}/{tasks.length}</div>
                            <div style={{ fontSize: '0.7rem', color: theme.textSecondary }}>Tasks</div>
                          </div>
                        </div>
                        
                        {/* Mood */}
                        {todayMood && (
                          <div style={{ background: 'rgba(255,255,255,0.05)', padding: '12px', borderRadius: '8px', marginBottom: '12px' }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                              <span style={{ fontSize: '1.5rem' }}>{moodEmojis.find(m => m.value === todayMood.value)?.emoji}</span>
                              <div>
                                <div style={{ fontSize: '0.8rem', color: theme.text }}>Today's Mood</div>
                                {todayMood.note && <div style={{ fontSize: '0.7rem', color: theme.textSecondary }}>{todayMood.note}</div>}
                              </div>
                            </div>
                          </div>
                        )}
                        
                        {/* Journal preview */}
                        {hasJournal && (
                          <div style={{ background: 'rgba(255,255,255,0.05)', padding: '12px', borderRadius: '8px' }}>
                            <div style={{ fontSize: '0.8rem', color: theme.text, marginBottom: '6px' }}>📝 Journal Entry</div>
                            {todayJournalData.gratitude && (
                              <div style={{ fontSize: '0.7rem', color: theme.textSecondary, marginBottom: '4px' }}>
                                <strong>Grateful for:</strong> {todayJournalData.gratitude.substring(0, 100)}{todayJournalData.gratitude.length > 100 ? '...' : ''}
                              </div>
                            )}
                            {todayJournalData.reflection && (
                              <div style={{ fontSize: '0.7rem', color: theme.textSecondary }}>
                                <strong>Reflection:</strong> {todayJournalData.reflection.substring(0, 100)}{todayJournalData.reflection.length > 100 ? '...' : ''}
                              </div>
                            )}
                          </div>
                        )}
                        
                        {/* No activity message */}
                        {!todayMood && !hasJournal && completedHabits.length === 0 && completedTasks.length === 0 && (
                          <div style={{ textAlign: 'center', padding: '20px', color: theme.textSecondary, fontSize: '0.8rem' }}>
                            ☕ Start your day! Complete habits, log your mood, or write in your journal.
                          </div>
                        )}
                      </div>
                    );
                  })()}

                  {/* Calendar grid - Theme-aware Style */}
                  {(calendarViewMode === 'week' || calendarViewMode === 'month') && (
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(7,1fr)', gap: '4px' }}>
                    {(calendarViewMode === 'week' 
                      ? (() => {
                          // Get week's days based on calendarDate (respects Today button)
                          const baseDate = new Date(calendarDate);
                          const weekStart = new Date(baseDate);
                          weekStart.setDate(baseDate.getDate() - baseDate.getDay());
                          return [...Array(7)].map((_, i) => {
                            const d = new Date(weekStart);
                            d.setDate(weekStart.getDate() + i);
                            return d;
                          });
                        })()
                      : calDays
                    ).map((day, i) => {
                      if (!day) return <div key={i} />;
                      const dk = getDateKey(day);
                      const dm = moods[dk];
                      const hasJournal = journal[dk] && (journal[dk].gratitude || journal[dk].reflection || journal[dk].tomorrow || journal[dk].promptResponse);
                      const dayHabits = habits.filter(h => (h.history || habitHistory[h.id] || {})[dk]);
                      const habitCompletion = habits.length > 0 ? dayHabits.length / habits.length : 0;
                      const isToday = isSameDay(day, today);
                      const isPast = day < today && !isToday;
                      const isFuture = day > today;
                      const isOnStreak = dayHabits.length > 0 && habitCompletion >= 0.5;
                      const isPerfect = habitCompletion === 1 && habits.length > 0;
                      
                      return (
                        <div 
                          key={i} 
                          onClick={() => !isFuture && setSelectedCalendarDay({ date: day, key: dk })}
                          style={{ 
                            aspectRatio: calendarViewMode === 'week' ? '1/1.2' : '1',
                            display: 'flex', 
                            flexDirection: 'column', 
                            alignItems: 'center', 
                            justifyContent: 'center', 
                            borderRadius: '10px', 
                            background: isToday 
                              ? 'linear-gradient(135deg, #d4a574 0%, #c4956a 100%)' 
                              : isPerfect 
                                ? 'linear-gradient(135deg, #8b7355 0%, #6b5a45 100%)'
                                : 'rgba(255,255,255,0.05)',
                            border: isToday ? '2px solid #fff' : isPerfect ? '2px solid #d4a574' : '1px solid rgba(255,255,255,0.1)',
                            cursor: isFuture ? 'default' : 'pointer',
                            opacity: isFuture ? 0.4 : 1,
                            position: 'relative',
                            transition: 'transform 0.2s, box-shadow 0.2s',
                            padding: '2px'
                          }}
                          onMouseOver={e => { if (!isFuture) e.currentTarget.style.transform = 'scale(1.05)'; }}
                          onMouseOut={e => e.currentTarget.style.transform = 'scale(1)'}
                        >
                          {/* Date number */}
                          <span style={{ 
                            fontFamily: "'Caveat', cursive", 
                            fontSize: calendarViewMode === 'week' ? '1.1rem' : '0.9rem', 
                            color: isToday ? '#2a1f15' : '#fff', 
                            fontWeight: isToday ? 700 : 500,
                            lineHeight: 1
                          }}>{day.getDate()}</span>
                          
                          {/* Theme-aware fill indicator */}
                          {!isFuture && habits.length > 0 && (
                            <div style={{ 
                              fontSize: calendarViewMode === 'week' ? '1.2rem' : '0.7rem',
                              marginTop: '1px',
                              filter: habitCompletion === 0 ? 'grayscale(1) opacity(0.3)' : 'none'
                            }}>
                              {habitCompletion === 0 ? tc.empty : habitCompletion < 0.5 ? tc.quarter : habitCompletion < 1 ? tc.half : tc.full}
                            </div>
                          )}
                          
                          {/* Activity indicators */}
                          {!isFuture && (dm || hasJournal) && (
                            <div style={{ display: 'flex', gap: '1px', marginTop: '1px' }}>
                              {dm && <span style={{ fontSize: '0.4rem' }}>{moodEmojis.find(m => m.value === dm.value)?.emoji}</span>}
                              {hasJournal && <span style={{ fontSize: '0.4rem' }}>📝</span>}
                            </div>
                          )}
                          
                          {/* Perfect day star */}
                          {isPerfect && (
                            <span style={{ position: 'absolute', top: '-2px', right: '-2px', fontSize: '0.6rem' }}>⭐</span>
                          )}
                          
                          {/* Streak flame */}
                          {isOnStreak && !isPerfect && (
                            <span style={{ position: 'absolute', top: '-2px', right: '-2px', fontSize: '0.5rem' }}>🔥</span>
                          )}
                        </div>
                      );
                    })}
                  </div>
                  )}

                  {/* Month Summary - Receipt Style */}
                  <div style={{ 
                    marginTop: '16px', 
                    padding: '12px', 
                    background: 'rgba(255,255,255,0.08)', 
                    borderRadius: '8px',
                    fontFamily: "'Courier New', monospace"
                  }}>
                    <div style={{ textAlign: 'center', color: 'rgba(255,255,255,0.9)', fontSize: '0.7rem', marginBottom: '8px', borderBottom: '1px dashed rgba(255,255,255,0.3)', paddingBottom: '6px' }}>
                      ═══ MONTHLY SUMMARY ═══
                    </div>
                    {(() => {
                      const monthDays = calDays.filter(d => d && d <= today);
                      const activeDays = monthDays.filter(d => {
                        const k = getDateKey(d);
                        return habits.some(h => (h.history || habitHistory[h.id] || {})[k]);
                      }).length;
                      const perfectDays = monthDays.filter(d => {
                        const k = getDateKey(d);
                        return habits.length > 0 && habits.every(h => (h.history || habitHistory[h.id] || {})[k]);
                      }).length;
                      const moodDays = monthDays.filter(d => moods[getDateKey(d)]).length;
                      const journalDays = monthDays.filter(d => {
                        const j = journal[getDateKey(d)];
                        return j && (j.gratitude || j.reflection || j.tomorrow || j.promptResponse);
                      }).length;
                      const avgMood = monthDays.length > 0 
                        ? monthDays.reduce((sum, d) => sum + (moods[getDateKey(d)]?.value || 0), 0) / Math.max(1, moodDays)
                        : 0;
                      
                      return (
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '4px', fontSize: '0.65rem', color: 'rgba(255,255,255,0.8)' }}>
                          <div>{tc.icon} Active Days:</div><div style={{ textAlign: 'right' }}>{activeDays}/{monthDays.length}</div>
                          <div>⭐ Perfect Days:</div><div style={{ textAlign: 'right' }}>{perfectDays}</div>
                          <div>😊 Mood Logged:</div><div style={{ textAlign: 'right' }}>{moodDays} days</div>
                          <div>📝 Journal Entries:</div><div style={{ textAlign: 'right' }}>{journalDays}</div>
                          {moodDays > 0 && <><div>📊 Avg Mood:</div><div style={{ textAlign: 'right' }}>{moodEmojis.find(m => m.value === Math.round(avgMood))?.emoji || '—'}</div></>}
                        </div>
                      );
                    })()}
                  </div>
                </div>

                {/* Theme-aware Heatmap */}
                <div style={{ ...s.card, marginTop: '16px' }}>
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px', flexWrap: 'wrap', gap: '8px' }}>
                    <h3 style={{ fontFamily: "'Caveat', cursive", fontSize: '1.3rem', color: theme.text, margin: 0, display: 'flex', alignItems: 'center', gap: '8px' }}>
                      {tc.bean} {tc.name} Counter
                      <span className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary, fontFamily: "'Lora', serif" }}>(12 weeks)</span>
                    </h3>
                    <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
                      <button 
                        onClick={() => setShowYearlyHeatmap(true)}
                        style={{ background: theme.accentLight, border: 'none', borderRadius: '6px', padding: '4px 8px', fontSize: '0.65rem', color: theme.accent, cursor: 'pointer', fontFamily: "'Lora', serif" }}
                      >
                        📅 Full Year
                      </button>
                      {/* Habit filter dropdown */}
                      <select 
                        value={heatmapFilter} 
                        onChange={e => setHeatmapFilter(e.target.value)}
                        className="bt"
                        style={{ 
                          background: theme.inputBg, 
                          border: `1px solid ${theme.cardBorder}`, 
                          borderRadius: '6px', 
                          padding: '4px 8px', 
                          fontSize: '0.7rem', 
                          color: theme.text,
                          cursor: 'pointer'
                        }}
                      >
                        <option value="all">All Habits</option>
                        {habits.map(h => (
                          <option key={h.id} value={h.id}>{h.icon} {h.name}</option>
                        ))}
                      </select>
                    </div>
                  </div>

                  {/* Current streak indicator */}
                  {gameStats.appStreak > 0 && (
                    <div style={{ 
                      display: 'flex', 
                      alignItems: 'center', 
                      gap: '6px', 
                      marginBottom: '12px',
                      padding: '8px 12px',
                      background: theme.accentLight,
                      borderRadius: '8px',
                      fontSize: '0.75rem'
                    }}>
                      <span>🔥</span>
                      <span className="bt" style={{ color: theme.accent, fontWeight: 600 }}>{gameStats.appStreak} day streak</span>
                      <span style={{ color: theme.textMuted }}>•</span>
                      <span className="bt" style={{ color: theme.textSecondary }}>Longest: {gameStats.maxStreak} days</span>
                    </div>
                  )}

                  {/* Month labels */}
                  <div style={{ display: 'flex', marginLeft: '28px', marginBottom: '4px', position: 'relative', height: '14px' }}>
                    {(() => {
                      const months = [];
                      let lastMonth = -1;
                      heatmapData.forEach((week, wi) => {
                        const d = new Date(week[0].date);
                        if (d.getMonth() !== lastMonth) {
                          lastMonth = d.getMonth();
                          months.push({ month: d.toLocaleDateString('en-US', { month: 'short' }), pos: wi });
                        }
                      });
                      return months.map((m, i) => (
                        <div key={i} className="bt" style={{ 
                          position: 'absolute', 
                          left: `${m.pos * 14}px`, 
                          fontSize: '0.6rem', 
                          color: theme.textMuted 
                        }}>{m.month}</div>
                      ));
                    })()}
                  </div>

                  <div style={{ display: 'flex', marginTop: '4px' }}>
                    {/* Day labels */}
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '2px', marginRight: '4px', paddingTop: '2px' }}>
                      {['', 'M', '', 'W', '', 'F', ''].map((d, i) => (
                        <div key={i} className="bt" style={{ height: '12px', fontSize: '0.55rem', color: theme.textMuted, display: 'flex', alignItems: 'center' }}>{d}</div>
                      ))}
                    </div>
                    
                    {/* Heatmap grid - Theme-aware shapes */}
                    <div style={{ display: 'flex', gap: '2px', flexWrap: 'nowrap', overflowX: 'auto' }}>
                      {heatmapData.map((week, wi) => (
                        <div key={wi} style={{ display: 'flex', flexDirection: 'column', gap: '2px' }}>
                          {week.map((day, di) => {
                            // Filter by selected habit or show all
                            let count, total;
                            if (heatmapFilter === 'all') {
                              count = day.count;
                              total = day.total;
                            } else {
                              const habit = habits.find(h => h.id === heatmapFilter);
                              if (habit) {
                                total = 1;
                                count = (habit.history || habitHistory[habit.id] || {})[day.date] ? 1 : 0;
                              } else {
                                count = 0;
                                total = 1;
                              }
                            }
                            
                            const intensity = total > 0 ? count / total : 0;
                            const isSelected = selectedHeatmapDay === day.date;
                            
                            // Theme-aware colors
                            const getHeatmapColor = (int) => {
                              if (int === 0) return theme.progressBg;
                              const colors = {
                                coffee: theme.isDark 
                                  ? ['#5a4a3a', '#7a6a5a', '#9a7a5a', '#a67c52'] 
                                  : ['#d4c4a8', '#c4a882', '#a67c52', '#6b4423'],
                                tea: theme.isDark 
                                  ? ['#3a4a3a', '#4a6a4a', '#5a8a5a', '#6aaa6a'] 
                                  : ['#c8d8c8', '#a8c8a8', '#88b888', '#68a868'],
                                matcha: theme.isDark 
                                  ? ['#3a4a3a', '#4a5a4a', '#5a7a5a', '#6a9a6a'] 
                                  : ['#d4e8d4', '#b4d8b4', '#94c894', '#74b874']
                              };
                              const themeColors = colors[brewType] || colors.coffee;
                              if (int < 0.33) return themeColors[0];
                              if (int < 0.66) return themeColors[1];
                              if (int < 1) return themeColors[2];
                              return themeColors[3];
                            };
                            
                            // Theme-aware shape
                            const shapeStyle = {
                              coffee: '50% 50% 50% 50% / 60% 60% 40% 40%', // Bean
                              tea: '30% 70% 70% 30% / 30% 30% 70% 70%', // Leaf-ish
                              matcha: '50%' // Circle/zen
                            };
                            
                            return (
                              <div 
                                key={di} 
                                onClick={() => setSelectedHeatmapDay(isSelected ? null : day.date)}
                                style={{ 
                                  width: '12px', 
                                  height: '12px', 
                                  borderRadius: shapeStyle[brewType] || shapeStyle.coffee,
                                  background: getHeatmapColor(intensity),
                                  cursor: 'pointer',
                                  transition: 'transform 0.2s, box-shadow 0.2s',
                                  transform: isSelected ? 'scale(1.4)' : 'scale(1)',
                                  boxShadow: isSelected ? `0 0 8px ${theme.accent}` : 'none',
                                  position: 'relative',
                                  animation: intensity === 1 ? 'pulse 2s ease-in-out infinite' : 'none'
                                }}
                                onMouseOver={e => e.currentTarget.style.transform = 'scale(1.3)'}
                                onMouseOut={e => e.currentTarget.style.transform = isSelected ? 'scale(1.4)' : 'scale(1)'}
                              >
                                {/* Detail line for coffee beans */}
                                {brewType === 'coffee' && intensity > 0 && (
                                  <div style={{ 
                                    position: 'absolute', 
                                    left: '50%', 
                                    top: '20%', 
                                    bottom: '30%', 
                                    width: '1px', 
                                    background: 'rgba(0,0,0,0.2)',
                                    transform: 'translateX(-50%)'
                                  }} />
                                )}
                                {/* Leaf vein for tea */}
                                {brewType === 'tea' && intensity > 0 && (
                                  <div style={{ 
                                    position: 'absolute', 
                                    left: '30%', 
                                    top: '50%', 
                                    width: '50%', 
                                    height: '1px', 
                                    background: 'rgba(0,0,0,0.15)',
                                    transform: 'rotate(-30deg)'
                                  }} />
                                )}
                              </div>
                            );
                          })}
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* Heatmap tooltip */}
                  {selectedHeatmapDay && (
                    <div style={{ 
                      marginTop: '12px', 
                      padding: '10px', 
                      background: theme.accentLight, 
                      borderRadius: '8px',
                      fontSize: '0.8rem'
                    }}>
                      <div className="bt" style={{ fontWeight: 600, color: theme.text, marginBottom: '4px' }}>
                        📅 {new Date(selectedHeatmapDay).toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' })}
                      </div>
                      {(() => {
                        const dayData = heatmapData.flat().find(d => d.date === selectedHeatmapDay);
                        if (!dayData) return null;
                        
                        if (heatmapFilter === 'all') {
                          return (
                            <div className="bt" style={{ color: theme.textSecondary }}>
                              {tc.icon} {dayData.count}/{dayData.total} habits completed ({dayData.total > 0 ? Math.round(dayData.count / dayData.total * 100) : 0}%)
                            </div>
                          );
                        } else {
                          const habit = habits.find(h => h.id === heatmapFilter);
                          const completed = habit && (habit.history || habitHistory[habit.id] || {})[selectedHeatmapDay];
                          return (
                            <div className="bt" style={{ color: theme.textSecondary }}>
                              {habit?.icon} {habit?.name}: {completed ? '✅ Completed' : '❌ Not completed'}
                            </div>
                          );
                        }
                      })()}
                    </div>
                  )}

                  {/* Legend */}
                  <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px', marginTop: '12px' }}>
                    <span className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted }}>Less</span>
                    {[0, 0.25, 0.5, 0.75, 1].map((intensity, i) => {
                      const getHeatmapColor = (int) => {
                        if (int === 0) return theme.progressBg;
                        const colors = {
                          coffee: theme.isDark 
                            ? ['#5a4a3a', '#7a6a5a', '#9a7a5a', '#a67c52'] 
                            : ['#d4c4a8', '#c4a882', '#a67c52', '#6b4423'],
                          tea: theme.isDark 
                            ? ['#3a4a3a', '#4a6a4a', '#5a8a5a', '#6aaa6a'] 
                            : ['#c8d8c8', '#a8c8a8', '#88b888', '#68a868'],
                          matcha: theme.isDark 
                            ? ['#3a4a3a', '#4a5a4a', '#5a7a5a', '#6a9a6a'] 
                            : ['#d4e8d4', '#b4d8b4', '#94c894', '#74b874']
                        };
                        const themeColors = colors[brewType] || colors.coffee;
                        if (int < 0.33) return themeColors[0];
                        if (int < 0.66) return themeColors[1];
                        if (int < 1) return themeColors[2];
                        return themeColors[3];
                      };
                      const shapeStyle = {
                        coffee: '50% 50% 50% 50% / 60% 60% 40% 40%',
                        tea: '30% 70% 70% 30% / 30% 30% 70% 70%',
                        matcha: '50%'
                      };
                      return (
                        <div 
                          key={i}
                          style={{ 
                            width: '12px', 
                            height: '12px', 
                            borderRadius: shapeStyle[brewType] || shapeStyle.coffee,
                            background: getHeatmapColor(intensity)
                          }}
                        />
                      );
                    })}
                    <span className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted }}>More</span>
                  </div>
                </div>

                {/* Day Detail Modal */}
                {selectedCalendarDay && (
                  <div 
                    onClick={() => setSelectedCalendarDay(null)}
                    style={{ 
                      position: 'fixed', 
                      inset: 0, 
                      background: 'rgba(0,0,0,0.6)', 
                      backdropFilter: 'blur(4px)',
                      display: 'flex', 
                      alignItems: 'center', 
                      justifyContent: 'center', 
                      zIndex: 1000,
                      padding: '20px'
                    }}
                  >
                    <div 
                      onClick={e => e.stopPropagation()}
                      style={{ 
                        background: theme.isDark ? '#2a2520' : '#faf6f0',
                        borderRadius: '16px',
                        padding: '20px',
                        maxWidth: '340px',
                        width: '100%',
                        maxHeight: '80vh',
                        overflowY: 'auto',
                        border: `3px solid ${theme.accent}40`,
                        boxShadow: '0 20px 60px rgba(0,0,0,0.3)'
                      }}
                    >
                      {/* Receipt-style header */}
                      <div style={{ textAlign: 'center', borderBottom: `2px dashed ${theme.cardBorder}`, paddingBottom: '12px', marginBottom: '12px' }}>
                        <div style={{ fontSize: '1.5rem', marginBottom: '4px' }}>{tc.icon}</div>
                        <div style={{ fontFamily: "'Caveat', cursive", fontSize: '1.4rem', color: theme.accent }}>
                          Daily {brewType === 'coffee' ? 'Brew' : brewType === 'tea' ? 'Steep' : 'Zen'} Receipt
                        </div>
                        <div className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary }}>
                          {selectedCalendarDay.date.toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })}
                        </div>
                      </div>

                      {/* Habits section */}
                      <div style={{ marginBottom: '16px' }}>
                        <div style={{ fontFamily: "'Caveat', cursive", fontSize: '1.1rem', color: theme.text, marginBottom: '8px' }}>
                          ═══ Habits {brewType === 'coffee' ? 'Brewed' : brewType === 'tea' ? 'Steeped' : 'Cultivated'} ═══
                        </div>
                        {habits.length > 0 ? (
                          <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
                            {habits.map(h => {
                              const completed = (h.history || habitHistory[h.id] || {})[selectedCalendarDay.key];
                              return (
                                <div key={h.id} className="bt" style={{ 
                                  display: 'flex', 
                                  justifyContent: 'space-between', 
                                  fontSize: '0.8rem',
                                  color: completed ? theme.text : theme.textMuted,
                                  textDecoration: completed ? 'none' : 'line-through',
                                  opacity: completed ? 1 : 0.6
                                }}>
                                  <span>{h.icon} {h.name}</span>
                                  <span>{completed ? '✓' : '✗'}</span>
                                </div>
                              );
                            })}
                          </div>
                        ) : (
                          <div className="bt" style={{ fontSize: '0.8rem', color: theme.textMuted, fontStyle: 'italic' }}>No habits tracked</div>
                        )}
                      </div>

                      {/* Mood section */}
                      {moods[selectedCalendarDay.key] && (
                        <div style={{ marginBottom: '16px' }}>
                          <div style={{ fontFamily: "'Caveat', cursive", fontSize: '1.1rem', color: theme.text, marginBottom: '8px' }}>
                            ═══ Mood Check ═══
                          </div>
                          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                            <span style={{ fontSize: '1.5rem' }}>{moodEmojis.find(m => m.value === moods[selectedCalendarDay.key].value)?.emoji}</span>
                            <span className="bt" style={{ fontSize: '0.85rem', color: theme.text }}>
                              {moodEmojis.find(m => m.value === moods[selectedCalendarDay.key].value)?.label}
                            </span>
                          </div>
                        </div>
                      )}

                      {/* Journal section */}
                      {journal[selectedCalendarDay.key] && (journal[selectedCalendarDay.key].gratitude || journal[selectedCalendarDay.key].reflection || journal[selectedCalendarDay.key].tomorrow || journal[selectedCalendarDay.key].promptResponse) && (
                        <div style={{ marginBottom: '16px' }}>
                          <div style={{ fontFamily: "'Caveat', cursive", fontSize: '1.1rem', color: theme.text, marginBottom: '8px' }}>
                            ═══ Journal Entry ═══
                          </div>
                          <div style={{ fontFamily: "'Caveat', cursive", fontSize: '0.95rem', color: theme.textSecondary, lineHeight: 1.5 }}>
                            {journal[selectedCalendarDay.key].promptResponse && (
                              <div style={{ marginBottom: '6px' }}>
                                <span style={{ color: theme.accent }}>✨ </span>
                                {journal[selectedCalendarDay.key].promptResponse.substring(0, 100)}{journal[selectedCalendarDay.key].promptResponse.length > 100 ? '...' : ''}
                              </div>
                            )}
                            {journal[selectedCalendarDay.key].gratitude && (
                              <div style={{ marginBottom: '6px' }}>
                                <span style={{ color: theme.accent }}>🙏 </span>
                                {journal[selectedCalendarDay.key].gratitude.substring(0, 80)}{journal[selectedCalendarDay.key].gratitude.length > 80 ? '...' : ''}
                              </div>
                            )}
                            {journal[selectedCalendarDay.key].reflection && (
                              <div>
                                <span style={{ color: theme.accent }}>💭 </span>
                                {journal[selectedCalendarDay.key].reflection.substring(0, 80)}{journal[selectedCalendarDay.key].reflection.length > 80 ? '...' : ''}
                              </div>
                            )}
                          </div>
                        </div>
                      )}

                      {/* Footer */}
                      <div style={{ borderTop: `2px dashed ${theme.cardBorder}`, paddingTop: '12px', textAlign: 'center' }}>
                        <div className="bt" style={{ fontSize: '0.7rem', color: theme.textMuted }}>
                          ★ Thank you for {tc.verb} with us! ★
                        </div>
                        <button 
                          onClick={() => setSelectedCalendarDay(null)}
                          style={{ 
                            marginTop: '12px',
                            background: theme.accentGradient,
                            border: 'none',
                            borderRadius: '20px',
                            padding: '8px 24px',
                            color: theme.isDark ? '#1a1a1a' : '#fff',
                            fontWeight: 600,
                            cursor: 'pointer',
                            fontSize: '0.85rem'
                          }}
                        >
                          Close
                        </button>
                      </div>
                    </div>
                  </div>
                )}
                    </>
                  );
                })()}
              </div>
            )}

            {/* STATS TAB */}
            {activeTab === 'stats' && (
              <div className="fade">
                {/* Habit Completion Rate */}
                <div style={s.card}>
                  <div 
                    onClick={() => setCollapsedStats({...collapsedStats, completion: !collapsedStats.completion})}
                    style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', cursor: 'pointer', marginBottom: collapsedStats.completion ? 0 : '10px' }}
                  >
                    <h3 className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text }}>📊 Habit Completion Rate</h3>
                    <span style={{ color: theme.textMuted, fontSize: '0.8rem', transition: 'transform 0.2s', transform: collapsedStats.completion ? 'rotate(-90deg)' : 'rotate(0deg)' }}>▼</span>
                  </div>
                  {!collapsedStats.completion && (() => {
                    // Calculate this week's completion
                    const today = new Date();
                    const weekStart = new Date(today);
                    weekStart.setDate(today.getDate() - today.getDay());
                    let weekCompleted = 0, weekTotal = 0;
                    let monthCompleted = 0, monthTotal = 0;
                    
                    for (let i = 0; i < 7; i++) {
                      const d = new Date(weekStart);
                      d.setDate(weekStart.getDate() + i);
                      if (d <= today) {
                        const key = getDateKey(d);
                        habits.forEach(h => {
                          weekTotal++;
                          if (h.history && h.history[key]) weekCompleted++;
                        });
                      }
                    }
                    
                    // Calculate this month's completion
                    const monthStart = new Date(today.getFullYear(), today.getMonth(), 1);
                    for (let d = new Date(monthStart); d <= today; d.setDate(d.getDate() + 1)) {
                      const key = getDateKey(d);
                      habits.forEach(h => {
                        monthTotal++;
                        if (h.history && h.history[key]) monthCompleted++;
                      });
                    }
                    
                    const weekRate = weekTotal > 0 ? Math.round((weekCompleted / weekTotal) * 100) : 0;
                    const monthRate = monthTotal > 0 ? Math.round((monthCompleted / monthTotal) * 100) : 0;
                    
                    return (
                      <div>
                        <div style={{ marginBottom: '12px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' }}>
                            <span className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary }}>This Week</span>
                            <span className="bt" style={{ fontSize: '0.9rem', fontWeight: 600, color: theme.accent }}>{weekRate}%</span>
                          </div>
                          <div style={{ height: '8px', background: theme.progressBg, borderRadius: '999px', overflow: 'hidden' }}>
                            <div style={{ height: '100%', width: `${weekRate}%`, background: theme.streakGradient, borderRadius: '999px', transition: 'width 0.5s' }} />
                          </div>
                          <p className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted, marginTop: '2px' }}>{weekCompleted}/{weekTotal} habits completed</p>
                        </div>
                        <div>
                          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '4px' }}>
                            <span className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary }}>This Month</span>
                            <span className="bt" style={{ fontSize: '0.9rem', fontWeight: 600, color: theme.accent }}>{monthRate}%</span>
                          </div>
                          <div style={{ height: '8px', background: theme.progressBg, borderRadius: '999px', overflow: 'hidden' }}>
                            <div style={{ height: '100%', width: `${monthRate}%`, background: theme.xpBar, borderRadius: '999px', transition: 'width 0.5s' }} />
                          </div>
                          <p className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted, marginTop: '2px' }}>{monthCompleted}/{monthTotal} habits completed</p>
                        </div>
                      </div>
                    );
                  })()}
                </div>

                {/* Weekly Review */}
                <button onClick={() => setShowWeeklyReview(true)} style={{ ...s.card, width: '100%', textAlign: 'center', cursor: 'pointer', border: `2px solid ${theme.accent}` }}>
                  <span style={{ fontSize: '1.2rem' }}>📊</span>
                  <p className="hw" style={{ fontSize: '1.1rem', color: theme.text, marginTop: '4px' }}>Weekly Review</p>
                  <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>See your week's accomplishments</p>
                </button>

                {/* Focus Stats */}
                <div style={s.card}>
                  <h3 className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>⏱️ Focus Time</h3>
                  {(() => {
                    const totalMins = gameStats.totalFocusMinutes || 0;
                    const hours = Math.floor(totalMins / 60);
                    const mins = totalMins % 60;
                    return (
                      <div>
                        <p className="bt" style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.accent, textAlign: 'center' }}>
                          {hours > 0 ? `${hours}h ${mins}m` : `${mins}m`}
                        </p>
                        <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary, textAlign: 'center' }}>Total focus time</p>
                      </div>
                    );
                  })()}
                </div>

                {/* Task Templates Button */}
                {taskTemplates.length > 0 && (
                  <button onClick={() => setShowTemplates(true)} style={{ ...s.card, width: '100%', textAlign: 'center', cursor: 'pointer' }}>
                    <span style={{ fontSize: '1rem' }}>📋</span>
                    <p className="bt" style={{ fontSize: '0.85rem', color: theme.text, marginTop: '4px' }}>Task Templates ({taskTemplates.length})</p>
                  </button>
                )}

                {/* Year in Review */}
                <button onClick={() => setShowYearReview(true)} style={{ ...s.card, width: '100%', textAlign: 'center', cursor: 'pointer', border: `2px solid ${theme.accent}` }}>
                  <span style={{ fontSize: '1.2rem' }}>📅</span>
                  <p className="hw" style={{ fontSize: '1.2rem', color: theme.text, marginTop: '4px' }}>{currentYear} Year in Review</p>
                </button>

                {/* Challenges */}
                <div style={{ ...s.card, cursor: 'pointer' }} onClick={() => setShowChallenges(true)}>
                  <h3 className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>🏆 Challenges</h3>
                  {weeklyChallenge && (
                    <div style={{ marginBottom: '8px' }}>
                      <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.75rem', marginBottom: '3px' }}>
                        <span className="bt" style={{ color: theme.textSecondary }}>Weekly: {weeklyChallenge.name}</span>
                        <span className="bt" style={{ color: theme.accent }}>{Math.min(challenges.weekly.progress, weeklyChallenge.target)}/{weeklyChallenge.target}</span>
                      </div>
                      <div style={{ height: '6px', background: theme.progressBg, borderRadius: '999px', overflow: 'hidden' }}>
                        <div style={{ height: '100%', width: `${Math.min(100, (challenges.weekly.progress / weeklyChallenge.target) * 100)}%`, background: theme.streakGradient, borderRadius: '999px' }} />
                      </div>
                    </div>
                  )}
                  {monthlyChallenge && (
                    <div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.75rem', marginBottom: '3px' }}>
                        <span className="bt" style={{ color: theme.textSecondary }}>Monthly: {monthlyChallenge.name}</span>
                        <span className="bt" style={{ color: theme.accent }}>{Math.min(challenges.monthly.progress, monthlyChallenge.target)}/{monthlyChallenge.target}</span>
                      </div>
                      <div style={{ height: '6px', background: theme.progressBg, borderRadius: '999px', overflow: 'hidden' }}>
                        <div style={{ height: '100%', width: `${Math.min(100, (challenges.monthly.progress / monthlyChallenge.target) * 100)}%`, background: theme.xpBar, borderRadius: '999px' }} />
                      </div>
                    </div>
                  )}
                </div>

                {/* Mood Insights */}
                {moodInsights && (
                  <div style={s.card}>
                    <h3 className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>😊 Mood Insights</h3>
                    {moodInsights.hasEnoughData ? (
                      <div className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, lineHeight: 1.6 }}>
                        {moodInsights.moodDiff && parseFloat(moodInsights.moodDiff) > 0 && (
                          <p style={{ marginBottom: '8px', padding: '8px', background: theme.accentLight, borderRadius: '8px' }}>
                            <span style={{ fontSize: '1.1rem' }}>✨</span> Your mood is <strong style={{ color: theme.accent }}>+{moodInsights.moodDiff} points higher</strong> on days you complete most habits!
                          </p>
                        )}
                        {moodInsights.avgHighCompletion && (
                          <p>📈 High habit days: <strong style={{ color: theme.text }}>{moodInsights.avgHighCompletion}/5</strong> avg mood</p>
                        )}
                        {moodInsights.avgLowCompletion && (
                          <p>📉 Low habit days: <strong style={{ color: theme.text }}>{moodInsights.avgLowCompletion}/5</strong> avg mood</p>
                        )}
                        {moodInsights.bestDay && (
                          <p style={{ marginTop: '6px' }}>🌟 Best mood day: <strong style={{ color: theme.accent }}>{moodInsights.bestDay.name}</strong> ({moodInsights.bestDay.avg.toFixed(1)}/5)</p>
                        )}
                      </div>
                    ) : (
                      <p className="bt" style={{ fontSize: '0.75rem', color: theme.textMuted }}>Track your mood for a week to unlock insights!</p>
                    )}
                  </div>
                )}

                {/* Streaks */}
                <div style={s.card}>
                  <h3 className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>🔥 Streaks</h3>
                  {habits.sort((a, b) => b.streak - a.streak).slice(0, 5).map(h => (
                    <div key={h.id} style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px' }}>
                      <span style={{ fontSize: '1rem' }}>{h.icon}</span>
                      <div style={{ flex: 1 }}>
                        <p className="bt" style={{ fontSize: '0.75rem', color: theme.text }}>{h.name}</p>
                        <div style={{ height: '4px', background: theme.progressBg, borderRadius: '999px', marginTop: '3px', overflow: 'hidden' }}>
                          <div style={{ height: '100%', width: `${Math.min(100, h.streak * 3.33)}%`, background: theme.streakGradient, borderRadius: '999px' }} />
                        </div>
                      </div>
                      <span className="bt" style={{ fontSize: '0.75rem', fontWeight: 600, color: theme.accent }}>{h.streak}d</span>
                    </div>
                  ))}
                </div>

                {/* Quick Actions */}
                <div style={{ display: 'flex', gap: '10px' }}>
                  <button onClick={() => setShowExport(true)} style={{ ...s.btnSecondary, flex: 1, display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '4px', padding: '14px' }}>
                    <span style={{ fontSize: '1.2rem' }}>💾</span>
                    <span className="bt" style={{ fontSize: '0.75rem' }}>Export Data</span>
                  </button>
                  <button onClick={() => shareAchievement(`I'm a ${currentLevel.title} at ${cafeName}! ${gameStats.xp} XP earned on my productivity journey. ☕🏆`)} style={{ ...s.btnSecondary, flex: 1, display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '4px', padding: '14px' }}>
                    <span style={{ fontSize: '1.2rem' }}>📤</span>
                    <span className="bt" style={{ fontSize: '0.75rem' }}>Share Progress</span>
                  </button>
                </div>
              </div>
            )}
          </div>

          {/* Bottom Nav */}
          <nav style={{ position: 'fixed', bottom: 0, left: 0, right: 0, background: theme.navBg, borderTop: `1px solid ${theme.cardBorder}`, display: 'flex', justifyContent: 'space-around', padding: '5px 0', paddingBottom: 'max(5px,env(safe-area-inset-bottom))', backdropFilter: 'blur(20px)', zIndex: 100 }} role="navigation" aria-label="Main navigation">
            {[{ id: 'today', icon: '📋', label: 'Today' }, { id: 'timer', icon: '⏱️', label: 'Focus' }, { id: 'journal', icon: '📝', label: 'Journal' }, { id: 'calendar', icon: '📅', label: 'Calendar' }, { id: 'stats', icon: '📊', label: 'Stats' }].map(tab => (
              <button key={tab.id} onClick={() => setActiveTab(tab.id)} style={s.navItem(activeTab === tab.id)} aria-current={activeTab === tab.id ? 'page' : undefined}>
                <span style={{ fontSize: '1.1rem' }}>{tab.icon}</span>
                <span>{tab.label}</span>
              </button>
            ))}
          </nav>

          {/* Floating Sound Button */}
          <button 
            onClick={() => setShowSoundMenu(true)} 
            style={{ 
              position: 'fixed', 
              bottom: '75px', 
              left: '16px', 
              width: '44px', 
              height: '44px', 
              borderRadius: '50%', 
              background: soundEnabled ? theme.accentGradient : theme.cardBg, 
              border: `2px solid ${soundEnabled ? 'transparent' : theme.cardBorder}`, 
              fontSize: '20px', 
              cursor: 'pointer', 
              boxShadow: '0 4px 16px rgba(0,0,0,0.2)', 
              zIndex: 99, 
              display: 'flex', 
              alignItems: 'center', 
              justifyContent: 'center',
              color: soundEnabled ? (theme.isDark ? '#1a1a1a' : '#fff') : theme.text
            }} 
            aria-label="Sound settings"
          >
            {soundEnabled ? '🎵' : '🔇'}
          </button>

          {/* FAB */}
          <button onClick={() => setShowQuickAdd(true)} style={s.fab} aria-label="Quick add">+</button>

          {/* ═══════════════════════════════════════════════════════════════ */}
          {/* MODALS */}
          {/* ═══════════════════════════════════════════════════════════════ */}

          {/* What's New / Grand Reopening */}
          {showWhatsNew && (
            <div style={s.modal} className="fade">
              <div style={{ ...s.modalContent, textAlign: 'center' }} className="slide">
                <div style={{ fontSize: '3rem', marginBottom: '8px' }}>🎉</div>
                <h2 className="hw" style={{ fontSize: '1.8rem', color: theme.text, marginBottom: '4px' }}>Grand Reopening!</h2>
                <p className="bt" style={{ fontSize: '0.85rem', color: theme.textSecondary, marginBottom: '20px' }}>We've been renovating! Pull up a chair and see what's new...</p>
                
                <div style={{ textAlign: 'left', maxHeight: '300px', overflow: 'auto', marginBottom: '16px' }}>
                  {whatsNewContent.map((section, i) => (
                    <div key={i} style={{ marginBottom: '16px' }}>
                      <h3 className="hw" style={{ fontSize: '1.2rem', color: theme.accent, marginBottom: '8px' }}>{section.title}</h3>
                      {section.items.map((item, j) => (
                        <div key={j} style={{ display: 'flex', gap: '10px', alignItems: 'flex-start', marginBottom: '8px', padding: '8px', background: theme.progressBg, borderRadius: '10px' }}>
                          <span style={{ fontSize: '1.2rem' }}>{item.icon}</span>
                          <div>
                            <p className="bt" style={{ fontSize: '0.8rem', fontWeight: 600, color: theme.text }}>{item.title}</p>
                            <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>{item.desc}</p>
                          </div>
                        </div>
                      ))}
                    </div>
                  ))}
                </div>
                
                <button onClick={dismissWhatsNew} style={{ ...s.btn, width: '100%' }}>Show Me Around! ☕</button>
              </div>
            </div>
          )}

          {/* Interactive Tutorial */}
          {showTutorial && (
            <div style={s.modal} className="fade">
              <div style={{ ...s.modalContent, textAlign: 'center' }} className="slide">
                <button onClick={dismissTutorial} style={{ position: 'absolute', top: '16px', right: '16px', background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.8rem', cursor: 'pointer' }}>Skip tour</button>
                
                <div style={{ fontSize: '2.5rem', marginBottom: '12px' }}>{tutorialSteps[tutorialStep].icon}</div>
                <h2 className="hw" style={{ fontSize: '1.5rem', color: theme.text, marginBottom: '4px' }}>{tutorialSteps[tutorialStep].title}</h2>
                <p className="bt" style={{ fontSize: '0.9rem', color: theme.accent, fontStyle: 'italic', marginBottom: '12px' }}>{tutorialSteps[tutorialStep].subtitle}</p>
                <p className="bt" style={{ fontSize: '0.85rem', color: theme.textSecondary, lineHeight: 1.5, marginBottom: '20px' }}>{tutorialSteps[tutorialStep].content}</p>
                
                {/* Progress dots */}
                <div style={{ display: 'flex', justifyContent: 'center', gap: '6px', marginBottom: '16px' }}>
                  {tutorialSteps.map((_, i) => (
                    <div key={i} style={{ width: i === tutorialStep ? '20px' : '8px', height: '8px', borderRadius: '4px', background: i === tutorialStep ? theme.accentGradient : theme.progressBg, transition: 'all 0.3s' }} />
                  ))}
                </div>
                
                <div style={{ display: 'flex', gap: '10px' }}>
                  {tutorialStep > 0 && (
                    <button onClick={() => setTutorialStep(s => s - 1)} style={{ ...s.btnSecondary, flex: 1 }}>← Back</button>
                  )}
                  {tutorialStep < tutorialSteps.length - 1 ? (
                    <button onClick={() => setTutorialStep(s => s + 1)} style={{ ...s.btn, flex: 1 }}>Next →</button>
                  ) : (
                    <button onClick={dismissTutorial} style={{ ...s.btn, flex: 1 }}>Let's Brew! ☕</button>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* Quick Add */}
          {showQuickAdd && (
            <div style={{ ...s.modal, alignItems: 'flex-end' }} onClick={() => setShowQuickAdd(false)}>
              <div style={{ background: theme.modalBg, borderRadius: '20px 20px 0 0', width: '100%', maxWidth: '28rem', padding: '20px', paddingBottom: 'max(20px,env(safe-area-inset-bottom))' }} className="slide" onClick={e => e.stopPropagation()}>
                <h3 className="hw" style={{ fontSize: '1.3rem', color: theme.text, textAlign: 'center', marginBottom: '16px' }}>Quick Add</h3>
                <div style={{ display: 'flex', gap: '10px' }}>
                  <button onClick={() => { setShowQuickAdd(false); setShowAddHabit(true); }} style={{ ...s.btn, flex: 1, display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '6px', padding: '16px' }}>
                    <span style={{ fontSize: '1.5rem' }}>⭐</span><span>New Habit</span>
                  </button>
                  <button onClick={() => { setShowQuickAdd(false); setShowAddTask(true); }} style={{ ...s.btn, flex: 1, display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '6px', padding: '16px' }}>
                    <span style={{ fontSize: '1.5rem' }}>✓</span><span>New Task</span>
                  </button>
                </div>
              </div>
            </div>
          )}

          {/* Add Habit */}
          {showAddHabit && (
            <div style={s.modal} onClick={() => setShowAddHabit(false)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '16px' }}>⭐ New Habit</h2>
                <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '8px' }}>Choose an icon:</p>
                <div style={{ display: 'flex', gap: '5px', flexWrap: 'wrap', marginBottom: '14px', maxHeight: '120px', overflow: 'auto' }}>
                  {defaultEmojis.map(e => (<button key={e} onClick={() => setNewHabit({ ...newHabit, icon: e })} style={{ width: '36px', height: '36px', borderRadius: '10px', border: newHabit.icon === e ? `2px solid ${theme.accent}` : 'none', background: newHabit.icon === e ? theme.accentLight : theme.progressBg, fontSize: '1.1rem', cursor: 'pointer' }}>{e}</button>))}
                </div>
                <input value={newHabit.name} onChange={e => setNewHabit({ ...newHabit, name: e.target.value })} placeholder="Habit name..." style={{ ...s.input, marginBottom: '12px' }} onKeyPress={e => e.key === 'Enter' && addHabit()} autoFocus />
                <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '6px' }}>Category (optional):</p>
                <div style={{ display: 'flex', gap: '5px', flexWrap: 'wrap', marginBottom: '14px' }}>
                  {habitCategories.map(c => (<button key={c.id} onClick={() => setNewHabit({ ...newHabit, category: newHabit.category === c.id ? null : c.id })} style={{ padding: '5px 10px', borderRadius: '8px', border: newHabit.category === c.id ? `2px solid ${c.color}` : `1px solid ${theme.cardBorder}`, background: newHabit.category === c.id ? `${c.color}22` : 'transparent', fontSize: '0.75rem', cursor: 'pointer', color: theme.text }}>{c.icon} {c.name}</button>))}
                </div>
                <div style={{ display: 'flex', gap: '10px' }}>
                  <button onClick={() => setShowAddHabit(false)} style={{ ...s.btnSecondary, flex: 1 }}>Cancel</button>
                  <button onClick={addHabit} style={{ ...s.btn, flex: 1 }}>Add Habit</button>
                </div>
              </div>
            </div>
          )}

          {/* Habit Templates Modal */}
          {showHabitTemplates && (
            <div style={s.modal} onClick={() => setShowHabitTemplates(false)}>
              <div style={{ ...s.modalContent, maxWidth: '440px', maxHeight: '85vh', overflow: 'hidden', display: 'flex', flexDirection: 'column' }} className="slide" onClick={e => e.stopPropagation()}>
                <div style={{ borderBottom: `1px solid ${theme.cardBorder}`, paddingBottom: '12px', marginBottom: '12px' }}>
                  <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '4px' }}>📋 Habit Templates</h2>
                  <p className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary }}>Quick-start your routine with curated habit packs</p>
                </div>
                
                <div style={{ overflowY: 'auto', flex: 1, paddingRight: '8px' }}>
                  {Object.entries(habitTemplates).map(([id, template]) => (
                    <div key={id} style={{ 
                      background: theme.cardBg, 
                      border: `1px solid ${theme.cardBorder}`, 
                      borderRadius: '12px', 
                      padding: '14px', 
                      marginBottom: '10px',
                      transition: 'transform 0.2s, box-shadow 0.2s'
                    }}>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '8px' }}>
                        <div>
                          <h3 className="bt" style={{ fontSize: '0.95rem', fontWeight: 600, color: theme.text, display: 'flex', alignItems: 'center', gap: '6px' }}>
                            <span style={{ fontSize: '1.2rem' }}>{template.icon}</span>
                            {template.name}
                          </h3>
                          <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary, marginTop: '2px' }}>{template.description}</p>
                        </div>
                        <button 
                          onClick={() => addHabitsFromTemplate(id)} 
                          style={{ 
                            ...s.btn, 
                            padding: '6px 14px', 
                            fontSize: '0.75rem',
                            whiteSpace: 'nowrap'
                          }}
                        >
                          + Add All
                        </button>
                      </div>
                      <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>
                        {template.habits.map((h, i) => (
                          <span key={i} style={{ 
                            display: 'inline-flex', 
                            alignItems: 'center', 
                            gap: '4px', 
                            padding: '4px 8px', 
                            borderRadius: '6px', 
                            background: theme.accentLight, 
                            fontSize: '0.7rem',
                            color: theme.text
                          }}>
                            {h.icon} {h.name}
                          </span>
                        ))}
                      </div>
                    </div>
                  ))}
                </div>
                
                <div style={{ borderTop: `1px solid ${theme.cardBorder}`, paddingTop: '12px', marginTop: '8px' }}>
                  <button onClick={() => setShowHabitTemplates(false)} style={{ ...s.btnSecondary, width: '100%' }}>Close</button>
                </div>
              </div>
            </div>
          )}

          {/* Archived Habits Modal */}
          {showArchivedHabits && (
            <div style={s.modal} onClick={() => setShowArchivedHabits(false)}>
              <div style={{ ...s.modalContent, maxWidth: '400px' }} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '4px' }}>📦 Archived Habits</h2>
                <p className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary, marginBottom: '16px' }}>Habits you've set aside. Restore or delete permanently.</p>
                
                {archivedHabits.length === 0 ? (
                  <p className="bt" style={{ textAlign: 'center', color: theme.textMuted, padding: '24px' }}>No archived habits</p>
                ) : (
                  <div style={{ maxHeight: '300px', overflowY: 'auto' }}>
                    {archivedHabits.map(h => (
                      <div key={h.id} style={{ 
                        display: 'flex', 
                        alignItems: 'center', 
                        gap: '10px', 
                        padding: '10px', 
                        background: theme.cardBg, 
                        border: `1px solid ${theme.cardBorder}`, 
                        borderRadius: '10px',
                        marginBottom: '8px'
                      }}>
                        <span style={{ fontSize: '1.3rem' }}>{h.icon}</span>
                        <div style={{ flex: 1 }}>
                          <p className="bt" style={{ fontSize: '0.85rem', color: theme.text }}>{h.name}</p>
                          <p className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted }}>
                            🔥 {h.streak}d streak • Archived {new Date(h.archivedAt).toLocaleDateString()}
                          </p>
                        </div>
                        <button onClick={() => restoreHabit(h.id)} style={{ background: theme.accentLight, border: 'none', borderRadius: '6px', padding: '6px 10px', fontSize: '0.7rem', color: theme.accent, cursor: 'pointer' }} title="Restore">↩️ Restore</button>
                        <button onClick={() => permanentlyDeleteHabit(h.id)} style={{ background: 'none', border: 'none', color: theme.textMuted, fontSize: '0.9rem', cursor: 'pointer', padding: '4px' }} title="Delete permanently">🗑️</button>
                      </div>
                    ))}
                  </div>
                )}
                
                <button onClick={() => setShowArchivedHabits(false)} style={{ ...s.btnSecondary, width: '100%', marginTop: '12px' }}>Close</button>
              </div>
            </div>
          )}

          {/* Yearly Heatmap Modal */}
          {showYearlyHeatmap && (
            <div style={s.modal} onClick={() => setShowYearlyHeatmap(false)}>
              <div style={{ ...s.modalContent, maxWidth: '95vw', width: '800px', maxHeight: '90vh', overflow: 'hidden', display: 'flex', flexDirection: 'column' }} className="slide" onClick={e => e.stopPropagation()}>
                <div style={{ borderBottom: `1px solid ${theme.cardBorder}`, paddingBottom: '12px', marginBottom: '12px' }}>
                  <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '4px' }}>
                    📅 {currentYear} Year in Review
                  </h2>
                  <p className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary }}>Your habit journey throughout the year</p>
                </div>
                
                <div style={{ overflowX: 'auto', overflowY: 'auto', flex: 1, paddingBottom: '8px' }}>
                  {/* Month labels */}
                  <div style={{ display: 'flex', marginLeft: '28px', marginBottom: '4px' }}>
                    {['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'].map((m, i) => (
                      <div key={i} className="bt" style={{ width: `${100/12}%`, minWidth: '50px', fontSize: '0.6rem', color: theme.textMuted }}>{m}</div>
                    ))}
                  </div>
                  
                  <div style={{ display: 'flex' }}>
                    {/* Day labels */}
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '2px', marginRight: '4px', paddingTop: '2px' }}>
                      {['S', 'M', 'T', 'W', 'T', 'F', 'S'].map((d, i) => (
                        <div key={i} className="bt" style={{ height: '10px', fontSize: '0.5rem', color: theme.textMuted, display: 'flex', alignItems: 'center' }}>{d}</div>
                      ))}
                    </div>
                    
                    {/* Year grid */}
                    <div style={{ display: 'flex', gap: '2px', flexWrap: 'nowrap' }}>
                      {(() => {
                        // Generate 53 weeks for the year
                        const yearStart = new Date(currentYear, 0, 1);
                        const firstDayOfWeek = yearStart.getDay();
                        const weeks = [];
                        
                        for (let w = 0; w < 53; w++) {
                          const week = [];
                          for (let d = 0; d < 7; d++) {
                            const dayOffset = w * 7 + d - firstDayOfWeek;
                            const date = new Date(currentYear, 0, 1 + dayOffset);
                            
                            if (date.getFullYear() !== currentYear) {
                              week.push(null);
                            } else {
                              const key = getDateKey(date);
                              const completedCount = habits.filter(h => (h.history || habitHistory[h.id] || {})[key]).length;
                              week.push({ date: key, count: completedCount, total: habits.length, dateObj: date });
                            }
                          }
                          weeks.push(week);
                        }
                        
                        const themeColors = {
                          coffee: theme.isDark 
                            ? ['#5a4a3a', '#7a6a5a', '#9a7a5a', '#a67c52'] 
                            : ['#d4c4a8', '#c4a882', '#a67c52', '#6b4423'],
                          tea: theme.isDark 
                            ? ['#3a4a3a', '#4a6a4a', '#5a8a5a', '#6aaa6a'] 
                            : ['#c8d8c8', '#a8c8a8', '#88b888', '#68a868'],
                          matcha: theme.isDark 
                            ? ['#3a4a3a', '#4a5a4a', '#5a7a5a', '#6a9a6a'] 
                            : ['#d4e8d4', '#b4d8b4', '#94c894', '#74b874']
                        };
                        const colors = themeColors[brewType] || themeColors.coffee;
                        const shapeStyle = {
                          coffee: '50% 50% 50% 50% / 60% 60% 40% 40%',
                          tea: '30% 70% 70% 30% / 30% 30% 70% 70%',
                          matcha: '50%'
                        };
                        
                        return weeks.map((week, wi) => (
                          <div key={wi} style={{ display: 'flex', flexDirection: 'column', gap: '2px' }}>
                            {week.map((day, di) => {
                              if (!day) return <div key={di} style={{ width: '10px', height: '10px' }} />;
                              const intensity = day.total > 0 ? day.count / day.total : 0;
                              const color = intensity === 0 ? theme.progressBg 
                                : intensity < 0.33 ? colors[0]
                                : intensity < 0.66 ? colors[1]
                                : intensity < 1 ? colors[2]
                                : colors[3];
                              
                              return (
                                <div 
                                  key={di}
                                  title={`${day.dateObj.toLocaleDateString()}: ${day.count}/${day.total}`}
                                  style={{ 
                                    width: '10px', 
                                    height: '10px', 
                                    borderRadius: shapeStyle[brewType] || shapeStyle.coffee,
                                    background: color,
                                    cursor: 'pointer'
                                  }}
                                />
                              );
                            })}
                          </div>
                        ));
                      })()}
                    </div>
                  </div>
                  
                  {/* Legend */}
                  <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px', marginTop: '16px' }}>
                    <span className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted }}>Less</span>
                    {[0, 0.25, 0.5, 0.75, 1].map((intensity, i) => {
                      const colors = {
                        coffee: theme.isDark 
                          ? ['#5a4a3a', '#7a6a5a', '#9a7a5a', '#a67c52'] 
                          : ['#d4c4a8', '#c4a882', '#a67c52', '#6b4423'],
                        tea: theme.isDark 
                          ? ['#3a4a3a', '#4a6a4a', '#5a8a5a', '#6aaa6a'] 
                          : ['#c8d8c8', '#a8c8a8', '#88b888', '#68a868'],
                        matcha: theme.isDark 
                          ? ['#3a4a3a', '#4a5a4a', '#5a7a5a', '#6a9a6a'] 
                          : ['#d4e8d4', '#b4d8b4', '#94c894', '#74b874']
                      };
                      const themeColors = colors[brewType] || colors.coffee;
                      const color = intensity === 0 ? theme.progressBg 
                        : intensity < 0.33 ? themeColors[0]
                        : intensity < 0.66 ? themeColors[1]
                        : intensity < 1 ? themeColors[2]
                        : themeColors[3];
                      const shapeStyle = {
                        coffee: '50% 50% 50% 50% / 60% 60% 40% 40%',
                        tea: '30% 70% 70% 30% / 30% 30% 70% 70%',
                        matcha: '50%'
                      };
                      return (
                        <div 
                          key={i}
                          style={{ 
                            width: '12px', 
                            height: '12px', 
                            borderRadius: shapeStyle[brewType] || shapeStyle.coffee,
                            background: color
                          }}
                        />
                      );
                    })}
                    <span className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted }}>More</span>
                  </div>
                  
                  {/* Year stats */}
                  <div style={{ 
                    marginTop: '20px', 
                    padding: '16px', 
                    background: theme.cardBg, 
                    border: `1px solid ${theme.cardBorder}`, 
                    borderRadius: '12px' 
                  }}>
                    <h4 className="bt" style={{ fontSize: '0.9rem', color: theme.text, marginBottom: '12px' }}>📊 Year Stats</h4>
                    {(() => {
                      let totalDaysTracked = 0;
                      let totalCompleted = 0;
                      let perfectDays = 0;
                      
                      for (let d = new Date(currentYear, 0, 1); d <= today && d.getFullYear() === currentYear; d.setDate(d.getDate() + 1)) {
                        const key = getDateKey(d);
                        const completed = habits.filter(h => (h.history || habitHistory[h.id] || {})[key]).length;
                        if (completed > 0) totalDaysTracked++;
                        totalCompleted += completed;
                        if (habits.length > 0 && completed === habits.length) perfectDays++;
                      }
                      
                      const daysSoFar = Math.floor((today - new Date(currentYear, 0, 1)) / (1000 * 60 * 60 * 24)) + 1;
                      
                      return (
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))', gap: '12px' }}>
                          <div style={{ textAlign: 'center', padding: '10px', background: theme.accentLight, borderRadius: '8px' }}>
                            <div style={{ fontSize: '1.5rem', fontWeight: 600, color: theme.accent }}>{totalDaysTracked}</div>
                            <div className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>Days Active</div>
                          </div>
                          <div style={{ textAlign: 'center', padding: '10px', background: theme.accentLight, borderRadius: '8px' }}>
                            <div style={{ fontSize: '1.5rem', fontWeight: 600, color: theme.accent }}>{perfectDays}</div>
                            <div className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>Perfect Days ⭐</div>
                          </div>
                          <div style={{ textAlign: 'center', padding: '10px', background: theme.accentLight, borderRadius: '8px' }}>
                            <div style={{ fontSize: '1.5rem', fontWeight: 600, color: theme.accent }}>{totalCompleted}</div>
                            <div className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>Habits Done</div>
                          </div>
                          <div style={{ textAlign: 'center', padding: '10px', background: theme.accentLight, borderRadius: '8px' }}>
                            <div style={{ fontSize: '1.5rem', fontWeight: 600, color: theme.accent }}>{Math.round(totalDaysTracked / daysSoFar * 100)}%</div>
                            <div className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>Consistency</div>
                          </div>
                        </div>
                      );
                    })()}
                  </div>
                </div>
                
                <div style={{ borderTop: `1px solid ${theme.cardBorder}`, paddingTop: '12px', marginTop: '8px' }}>
                  <button onClick={() => setShowYearlyHeatmap(false)} style={{ ...s.btnSecondary, width: '100%' }}>Close</button>
                </div>
              </div>
            </div>
          )}

          {/* Edit Habit Modal */}
          {editingHabit && (
            <div style={s.modal} onClick={() => setEditingHabit(null)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '16px' }}>✏️ Edit Habit</h2>
                <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '8px' }}>Icon:</p>
                <div style={{ display: 'flex', gap: '5px', flexWrap: 'wrap', marginBottom: '14px', maxHeight: '100px', overflow: 'auto' }}>
                  {defaultEmojis.map(e => (<button key={e} onClick={() => setEditingHabit({ ...editingHabit, icon: e })} style={{ width: '32px', height: '32px', borderRadius: '8px', border: editingHabit.icon === e ? `2px solid ${theme.accent}` : 'none', background: editingHabit.icon === e ? theme.accentLight : theme.progressBg, fontSize: '1rem', cursor: 'pointer' }}>{e}</button>))}
                </div>
                <input value={editingHabit.name} onChange={e => setEditingHabit({ ...editingHabit, name: e.target.value })} placeholder="Habit name..." style={{ ...s.input, marginBottom: '12px' }} autoFocus />
                <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '6px' }}>Category:</p>
                <div style={{ display: 'flex', gap: '5px', flexWrap: 'wrap', marginBottom: '14px' }}>
                  {habitCategories.map(c => (<button key={c.id} onClick={() => setEditingHabit({ ...editingHabit, category: editingHabit.category === c.id ? null : c.id })} style={{ padding: '5px 10px', borderRadius: '8px', border: editingHabit.category === c.id ? `2px solid ${c.color}` : `1px solid ${theme.cardBorder}`, background: editingHabit.category === c.id ? `${c.color}22` : 'transparent', fontSize: '0.75rem', cursor: 'pointer', color: theme.text }}>{c.icon} {c.name}</button>))}
                </div>
                <div style={{ display: 'flex', gap: '10px' }}>
                  <button onClick={() => setEditingHabit(null)} style={{ ...s.btnSecondary, flex: 1 }}>Cancel</button>
                  <button onClick={() => editHabit(editingHabit.id, { name: editingHabit.name, icon: editingHabit.icon, category: editingHabit.category })} style={{ ...s.btn, flex: 1 }}>Save</button>
                </div>
              </div>
            </div>
          )}

          {/* Edit Task Modal */}
          {editingTask && (
            <div style={s.modal} onClick={() => setEditingTask(null)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '16px' }}>✏️ Edit Task</h2>
                <input value={editingTask.text} onChange={e => setEditingTask({ ...editingTask, text: e.target.value })} placeholder="Task name..." style={{ ...s.input, marginBottom: '12px' }} autoFocus />
                <div style={{ display: 'flex', gap: '8px', marginBottom: '12px' }}>
                  <input type="time" value={editingTask.time || ''} onChange={e => setEditingTask({ ...editingTask, time: e.target.value })} style={{ ...s.input, flex: 1 }} />
                  <select value={editingTask.priority} onChange={e => setEditingTask({ ...editingTask, priority: e.target.value })} style={{ ...s.input, flex: 1 }}>
                    <option value="high">🔴 High</option>
                    <option value="medium">🟡 Medium</option>
                    <option value="low">🟢 Low</option>
                  </select>
                </div>
                <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '6px' }}>Category:</p>
                <div style={{ display: 'flex', gap: '5px', flexWrap: 'wrap', marginBottom: '14px' }}>
                  {categories.map(c => (<button key={c.id} onClick={() => setEditingTask({ ...editingTask, category: editingTask.category === c.id ? null : c.id })} style={{ padding: '5px 10px', borderRadius: '8px', border: editingTask.category === c.id ? `2px solid ${c.color}` : `1px solid ${theme.cardBorder}`, background: editingTask.category === c.id ? `${c.color}22` : 'transparent', fontSize: '0.7rem', cursor: 'pointer' }}>{c.icon}</button>))}
                </div>
                <div style={{ display: 'flex', gap: '10px' }}>
                  <button onClick={() => setEditingTask(null)} style={{ ...s.btnSecondary, flex: 1 }}>Cancel</button>
                  <button onClick={() => editTask(editingTask.id, { text: editingTask.text, time: editingTask.time, priority: editingTask.priority, category: editingTask.category })} style={{ ...s.btn, flex: 1 }}>Save</button>
                </div>
              </div>
            </div>
          )}

          {/* Task Templates Modal */}
          {showTemplates && (
            <div style={s.modal} onClick={() => setShowTemplates(false)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '16px' }}>📋 Task Templates</h2>
                {taskTemplates.length === 0 ? (
                  <p className="bt" style={{ color: theme.textMuted, textAlign: 'center', padding: '20px' }}>No templates yet. Save a task as template using 💾</p>
                ) : (
                  <div style={{ maxHeight: '300px', overflow: 'auto' }}>
                    {taskTemplates.map(t => (
                      <div key={t.id} style={{ ...s.card, display: 'flex', alignItems: 'center', gap: '10px' }}>
                        <div style={{ flex: 1 }}>
                          <p className="bt" style={{ fontSize: '0.85rem', color: theme.text }}>{t.text}</p>
                          <span className="bt" style={{ fontSize: '0.65rem', color: theme.textSecondary }}>
                            {t.priority === 'high' ? '🔴' : t.priority === 'medium' ? '🟡' : '🟢'} {t.subtasks?.length > 0 && `📋 ${t.subtasks.length} subtasks`}
                          </span>
                        </div>
                        <button onClick={() => { useTemplate(t); setShowTemplates(false); }} style={{ ...s.btn, padding: '6px 12px', fontSize: '0.75rem' }}>Use</button>
                        <button onClick={() => deleteTemplate(t.id)} style={{ background: 'none', border: 'none', color: theme.textMuted, cursor: 'pointer' }}>🗑</button>
                      </div>
                    ))}
                  </div>
                )}
                <button onClick={() => setShowTemplates(false)} style={{ ...s.btnSecondary, width: '100%', marginTop: '10px' }}>Close</button>
              </div>
            </div>
          )}

          {/* Add Task */}
          {showAddTask && (
            <div style={s.modal} onClick={() => setShowAddTask(false)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '16px' }}>✓ New Task</h2>
                <input value={newTask.text} onChange={e => setNewTask({ ...newTask, text: e.target.value })} placeholder="What needs doing?" style={{ ...s.input, marginBottom: '12px' }} autoFocus />
                <div style={{ display: 'flex', gap: '8px', marginBottom: '12px' }}>
                  <input type="time" value={newTask.time} onChange={e => setNewTask({ ...newTask, time: e.target.value })} style={{ ...s.input, flex: 1 }} />
                  <select value={newTask.priority} onChange={e => setNewTask({ ...newTask, priority: e.target.value })} style={{ ...s.input, flex: 1 }}>
                    <option value="high">🔴 High</option>
                    <option value="medium">🟡 Medium</option>
                    <option value="low">🟢 Low</option>
                  </select>
                </div>
                <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '6px' }}>Category:</p>
                <div style={{ display: 'flex', gap: '5px', flexWrap: 'wrap', marginBottom: '14px' }}>
                  {categories.map(c => (<button key={c.id} onClick={() => setNewTask({ ...newTask, category: newTask.category === c.id ? null : c.id })} style={{ padding: '5px 10px', borderRadius: '8px', border: newTask.category === c.id ? `2px solid ${c.color}` : `1px solid ${theme.cardBorder}`, background: newTask.category === c.id ? `${c.color}22` : 'transparent', fontSize: '0.7rem', cursor: 'pointer' }}>{c.icon}</button>))}
                </div>
                <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '6px' }}>🔄 Repeat:</p>
                <div style={{ display: 'flex', gap: '5px', flexWrap: 'wrap', marginBottom: '14px' }}>
                  {[{ id: 'none', label: 'Once' }, { id: 'daily', label: 'Daily' }, { id: 'weekdays', label: 'Weekdays' }, { id: 'weekly', label: 'Weekly' }].map(r => (
                    <button key={r.id} onClick={() => setNewTask({ ...newTask, recurring: r.id })} style={{ padding: '6px 12px', borderRadius: '8px', border: newTask.recurring === r.id ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`, background: newTask.recurring === r.id ? theme.accentLight : 'transparent', fontSize: '0.75rem', color: theme.text, cursor: 'pointer', fontFamily: "'Lora',serif" }}>{r.label}</button>
                  ))}
                </div>
                <div style={{ display: 'flex', gap: '10px' }}>
                  <button onClick={() => setShowAddTask(false)} style={{ ...s.btnSecondary, flex: 1 }}>Cancel</button>
                  <button onClick={addTask} style={{ ...s.btn, flex: 1 }}>Add Task</button>
                </div>
              </div>
            </div>
          )}

          {/* Theme Picker */}
          {showThemePicker && (
            <div style={s.modal} className="fade" onClick={() => setShowThemePicker(false)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.5rem', color: theme.text, textAlign: 'center', marginBottom: '16px' }}>{brewThemes[brewType].icon} Choose Your Brew</h2>
                {Object.entries(brewThemes).map(([key, brew]) => (
                  <div key={key} style={{ marginBottom: '14px' }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginBottom: '8px' }}>
                      <span style={{ fontSize: '1.2rem' }}>{brew.icon}</span>
                      <span className="bt" style={{ fontSize: '0.95rem', fontWeight: 600, color: theme.text }}>{brew.name}</span>
                    </div>
                    <div style={{ display: 'flex', gap: '8px' }}>
                      {['light', 'dark'].map(mode => {
                        const t = brew[mode];
                        const isActive = brewType === key && isDark === (mode === 'dark');
                        return (<button key={mode} onClick={() => { setBrewType(key); setIsDark(mode === 'dark'); }} style={{ flex: 1, padding: '12px 10px', borderRadius: '12px', border: isActive ? `3px solid ${t.accent}` : `1px solid ${theme.cardBorder}`, background: t.cardBg, cursor: 'pointer' }}>
                          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '4px', marginBottom: '4px' }}>
                            <span style={{ fontSize: '0.9rem' }}>{t.icon}</span>
                            <span className="bt" style={{ fontSize: '0.8rem', fontWeight: 600, color: t.text }}>{t.name}</span>
                          </div>
                        </button>);
                      })}
                    </div>
                  </div>
                ))}
                <button onClick={() => setShowThemePicker(false)} style={{ ...s.btn, width: '100%', marginTop: '6px' }}>Done</button>
              </div>
            </div>
          )}

          {/* Settings */}
          {showSettings && (
            <div style={s.modal} className="fade" onClick={() => setShowSettings(false)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '16px' }}>⚙️ Settings</h2>
                <div style={{ marginBottom: '14px' }}>
                  <label className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, display: 'block', marginBottom: '4px' }}>Name your café:</label>
                  <input value={cafeName} onChange={e => setCafeName(e.target.value)} style={s.input} maxLength={24} />
                </div>
                
                <div style={{ marginBottom: '14px' }}>
                  <label className="bt" style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '0.85rem', color: theme.text, cursor: 'pointer' }}>
                    <input type="checkbox" checked={highContrast} onChange={e => setHighContrast(e.target.checked)} style={{ accentColor: theme.accent }} />
                    ♿ High Contrast Mode
                  </label>
                </div>

                <div style={{ marginBottom: '14px' }}>
                  <label className="bt" style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '0.85rem', color: theme.text, cursor: 'pointer' }}>
                    <input type="checkbox" checked={autoDarkMode} onChange={e => setAutoDarkMode(e.target.checked)} style={{ accentColor: theme.accent }} />
                    🌓 Auto Dark Mode (follow system)
                  </label>
                </div>

                {/* Custom Accent Color */}
                <div style={{ marginBottom: '14px' }}>
                  <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '8px' }}>🎨 Custom Accent Color</p>
                  <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap', alignItems: 'center' }}>
                    {[
                      null, // Default/reset
                      '#E57373', '#F06292', '#BA68C8', '#9575CD', 
                      '#7986CB', '#64B5F6', '#4FC3F7', '#4DD0E1',
                      '#4DB6AC', '#81C784', '#AED581', '#DCE775',
                      '#FFD54F', '#FFB74D', '#FF8A65', '#A1887F'
                    ].map((color, i) => (
                      <button
                        key={i}
                        onClick={() => setCustomAccentColor(color)}
                        style={{
                          width: '28px',
                          height: '28px',
                          borderRadius: '50%',
                          border: (customAccentColor === color || (!customAccentColor && !color)) ? '3px solid ' + theme.text : '2px solid ' + theme.cardBorder,
                          background: color || baseTheme.accent,
                          cursor: 'pointer',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          fontSize: '0.7rem'
                        }}
                        title={color ? color : 'Default'}
                      >
                        {!color && '↺'}
                      </button>
                    ))}
                  </div>
                  {customAccentColor && (
                    <button 
                      onClick={() => setCustomAccentColor(null)} 
                      className="bt" 
                      style={{ marginTop: '8px', background: 'none', border: 'none', color: theme.accent, fontSize: '0.75rem', cursor: 'pointer' }}
                    >
                      Reset to default
                    </button>
                  )}
                </div>

                {/* Visual Enhancements */}
                <div style={{ marginBottom: '14px', padding: '12px', background: theme.progressBg, borderRadius: '10px' }}>
                  <p className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>✨ Visual Effects</p>
                  <label className="bt" style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '0.8rem', color: theme.text, cursor: 'pointer', marginBottom: '8px' }}>
                    <input type="checkbox" checked={paperTexture} onChange={e => setPaperTexture(e.target.checked)} style={{ accentColor: theme.accent }} />
                    📜 Paper texture (notebook feel)
                  </label>
                  <label className="bt" style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '0.8rem', color: theme.text, cursor: 'pointer' }}>
                    <input type="checkbox" checked={seasonalAnimations} onChange={e => setSeasonalAnimations(e.target.checked)} style={{ accentColor: theme.accent }} />
                    {seasonDeco.emoji} Falling {season === 'winter' ? 'snowflakes' : season === 'fall' ? 'leaves' : season === 'spring' ? 'petals' : 'sunshine'}
                  </label>
                </div>

                <div style={{ marginBottom: '14px' }}>
                  <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '6px' }}>Season: {seasonDeco.emoji} {seasonDeco.name}</p>
                </div>

                <div style={{ marginBottom: '14px', padding: '10px', background: theme.progressBg, borderRadius: '10px' }}>
                  <p className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '6px' }}>Your stats:</p>
                  <div className="bt" style={{ fontSize: '0.75rem', color: theme.text, lineHeight: 1.6 }}>
                    <p>🏆 {gameStats.xp} XP • {currentLevel.title}</p>
                    <p>✓ {gameStats.totalTasksCompleted} tasks • ⭐ {gameStats.totalHabitsCompleted} habits</p>
                    <p>📅 {gameStats.appStreak} day streak • ❄️ {gameStats.freezesAvailable} freeze</p>
                  </div>
                </div>

                {/* Notifications */}
                <div style={{ marginBottom: '14px', padding: '12px', background: theme.progressBg, borderRadius: '10px', border: 'Notification' in window && Notification.permission === 'default' ? `2px solid ${theme.accent}` : 'none' }}>
                  <p className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text, marginBottom: '6px' }}>🔔 Notifications</p>
                  <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary, marginBottom: '10px' }}>
                    Get notified when timers complete and tasks are due
                  </p>
                  {'Notification' in window ? (
                    Notification.permission === 'granted' ? (
                      <div>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', padding: '8px 12px', background: 'rgba(74,222,128,0.15)', borderRadius: '8px', marginBottom: '8px' }}>
                          <span style={{ fontSize: '1.2rem' }}>✅</span>
                          <div style={{ flex: 1 }}>
                            <p className="bt" style={{ fontSize: '0.8rem', color: '#4ade80', fontWeight: 600 }}>Notifications enabled!</p>
                            <p className="bt" style={{ fontSize: '0.65rem', color: theme.textSecondary }}>Timer alerts + task reminders (5 min warning & when due)</p>
                          </div>
                        </div>
                        <button 
                          onClick={async () => {
                            try {
                              // Try service worker notification first (works better on mobile)
                              if ('serviceWorker' in navigator && navigator.serviceWorker.controller) {
                                const reg = await navigator.serviceWorker.ready;
                                await reg.showNotification('Test Notification 🧪', { 
                                  body: 'Great! Notifications are working. You\'ll be reminded 5 min before tasks and when they\'re due.', 
                                  icon: '/icons/icon-192.png',
                                  tag: 'test-notification',
                                  vibrate: [100, 50, 100]
                                });
                                triggerCelebration('✅ Test sent!');
                              } else {
                                // Fallback to regular notification
                                const notif = new Notification('Test Notification 🧪', { 
                                  body: 'Great! Notifications are working.', 
                                  icon: '/icons/icon-192.png',
                                  tag: 'test-notification'
                                });
                                triggerCelebration('✅ Test sent!');
                              }
                              if ('vibrate' in navigator) navigator.vibrate([100, 50, 100]);
                            } catch (e) {
                              console.error('Notification error:', e);
                              // Show what went wrong
                              alert('Notification failed: ' + e.message + '\n\nTry: 1) Refresh the page, 2) Re-enable notifications in browser settings, 3) Make sure you\'re using HTTPS');
                            }
                          }}
                          style={{ ...s.btnSecondary, width: '100%', fontSize: '0.8rem', padding: '10px' }}
                        >
                          🧪 Send Test Notification
                        </button>
                      </div>
                    ) : Notification.permission === 'denied' ? (
                      <div style={{ padding: '8px 12px', background: 'rgba(239,68,68,0.1)', borderRadius: '8px' }}>
                        <p className="bt" style={{ fontSize: '0.75rem', color: '#ef4444', marginBottom: '4px' }}>⚠️ Notifications blocked</p>
                        <p className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted }}>To enable: Open browser settings → Site settings → Notifications → Allow for this site</p>
                      </div>
                    ) : (
                      <div>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', padding: '8px 12px', background: theme.accentLight, borderRadius: '8px', marginBottom: '10px' }}>
                          <span style={{ fontSize: '1.2rem' }}>💡</span>
                          <p className="bt" style={{ fontSize: '0.7rem', color: theme.text }}>Enable notifications to get reminders even when the app is in the background!</p>
                        </div>
                        <button 
                          onClick={async () => {
                            const permission = await Notification.requestPermission();
                            if (permission === 'granted') {
                              new Notification('My Daily Brew ☕', { 
                                body: 'Awesome! You\'ll now get timer and task reminders.', 
                                icon: '/icons/icon-192.png',
                                tag: 'welcome'
                              });
                              triggerCelebration('🔔 Notifications enabled!');
                            }
                          }}
                          style={{ ...s.btn, width: '100%', fontSize: '0.85rem', padding: '12px' }}
                        >
                          🔔 Enable Notifications
                        </button>
                      </div>
                    )
                  ) : (
                    <p className="bt" style={{ fontSize: '0.75rem', color: theme.textMuted }}>Notifications not supported in this browser. Try Chrome or Safari.</p>
                  )}
                </div>

                <p className="bt" style={{ fontSize: '0.65rem', color: theme.textMuted, marginBottom: '8px', textAlign: 'center' }}>
                  💡 Tip: For reliable reminders, also set alarms in your phone's clock app
                </p>
                
                <p className="bt" style={{ fontSize: '0.7rem', color: theme.textMuted, marginBottom: '14px' }}>💡 Swipe right to complete</p>
                
                {/* Show me around button */}
                <button 
                  onClick={() => { setShowSettings(false); setTutorialStep(0); setShowTutorial(true); }} 
                  style={{ ...s.btnSecondary, width: '100%', marginBottom: '10px', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px' }}
                >
                  <span>🗺️</span> Show Me Around (v8.0 Features)
                </button>
                
                {/* Credits Section */}
                <div style={{ marginBottom: '14px', padding: '12px', background: theme.progressBg, borderRadius: '10px' }}>
                  <p className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>🎵 Audio Credits</p>
                  <div className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary, lineHeight: 1.8 }}>
                    <p style={{ marginBottom: '6px' }}><strong>Background Music:</strong></p>
                    <p>☕ "Cafe Contemplations" — VinylNoise</p>
                    <p>🎹 "Elegant Background" — Grand_Project</p>
                    <p>🍵 "Tea Time on a Rainy Day" — HarumachiMusic</p>
                    <p>🎧 "Minimal Lo-Fi Ambient" — DesiFreeMusic</p>
                    <p>🎋 "Zen Garden Beats" — Eggshy</p>
                    <p style={{ marginBottom: '8px' }}>🇯🇵 "Japanese Lofi Beat" — Music-for-Videos</p>
                    <p style={{ marginBottom: '6px' }}><strong>Ambient Sounds:</strong></p>
                    <p>🔥 Fireplace • 🌧️ Rain • 🍃 Wind • 🌊 Ocean — Pixabay</p>
                    <p style={{ marginTop: '8px', fontSize: '0.65rem', color: theme.textMuted }}>All audio licensed under Pixabay Content License</p>
                  </div>
                </div>
                
                <button onClick={() => setShowSettings(false)} style={{ ...s.btn, width: '100%' }}>Done</button>
              </div>
            </div>
          )}

          {/* Café Decorations Shop */}
          {showDecorations && (
            <div style={s.modal} className="fade" onClick={() => setShowDecorations(false)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, textAlign: 'center', marginBottom: '4px' }}>🛒 Café Decorations</h2>
                <p className="bt" style={{ textAlign: 'center', fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '6px' }}>Spend XP to decorate your café!</p>
                <p className="bt" style={{ textAlign: 'center', fontSize: '0.9rem', color: theme.accent, marginBottom: '16px', fontWeight: 600 }}>💰 {gameStats.xp} XP available</p>
                
                {['plants', 'art', 'cozy', 'pets'].map(category => (
                  <div key={category} style={{ marginBottom: '14px' }}>
                    <p className="bt" style={{ fontSize: '0.8rem', fontWeight: 600, color: theme.text, marginBottom: '8px', textTransform: 'capitalize' }}>
                      {category === 'plants' ? '🌿' : category === 'art' ? '🖼️' : category === 'cozy' ? '🕯️' : '🐱'} {category}
                    </p>
                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '8px' }}>
                      {cafeDecorations.filter(d => d.category === category).map(deco => {
                        const owned = unlockedDecorations.includes(deco.id);
                        const canAfford = gameStats.xp >= deco.xpCost;
                        return (
                          <button 
                            key={deco.id}
                            onClick={() => !owned && canAfford && unlockDecoration(deco.id)}
                            disabled={owned || !canAfford}
                            style={{ 
                              padding: '10px', 
                              borderRadius: '10px', 
                              border: owned ? `2px solid ${theme.success}` : `1px solid ${theme.cardBorder}`,
                              background: owned ? `${theme.success}15` : theme.progressBg,
                              cursor: owned ? 'default' : canAfford ? 'pointer' : 'not-allowed',
                              opacity: !owned && !canAfford ? 0.5 : 1,
                              textAlign: 'center'
                            }}
                          >
                            <span style={{ fontSize: '1.5rem', display: 'block', marginBottom: '4px' }}>{deco.icon}</span>
                            <span className="bt" style={{ fontSize: '0.7rem', color: theme.text, display: 'block' }}>{deco.name}</span>
                            <span className="bt" style={{ fontSize: '0.65rem', color: owned ? theme.success : theme.accent }}>
                              {owned ? '✓ Owned' : `${deco.xpCost} XP`}
                            </span>
                          </button>
                        );
                      })}
                    </div>
                  </div>
                ))}
                
                <button onClick={() => setShowDecorations(false)} style={{ ...s.btn, width: '100%', marginTop: '10px' }}>Close</button>
              </div>
            </div>
          )}

          {/* Badges */}
          {showBadges && (
            <div style={s.modal} className="fade" onClick={() => setShowBadges(false)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, textAlign: 'center', marginBottom: '4px' }}>🏆 Achievements</h2>
                <p className="bt" style={{ textAlign: 'center', fontSize: '0.8rem', color: theme.textSecondary, marginBottom: '16px' }}>{gameStats.unlockedBadges.length}/{badges.length} unlocked</p>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2,1fr)', gap: '8px', maxHeight: '350px', overflow: 'auto' }}>
                  {badges.map(b => {
                    const unlocked = gameStats.unlockedBadges.includes(b.id);
                    return (<div key={b.id} style={{ padding: '12px 8px', borderRadius: '12px', background: unlocked ? theme.accentLight : theme.progressBg, border: `1px solid ${theme.cardBorder}`, textAlign: 'center', opacity: unlocked ? 1 : 0.5 }}>
                      <div style={{ fontSize: '1.5rem', marginBottom: '4px', filter: unlocked ? 'none' : 'grayscale(1)' }}>{b.icon}</div>
                      <p className="bt" style={{ fontSize: '0.7rem', fontWeight: 600, color: theme.text }}>{b.name}</p>
                      <p className="bt" style={{ fontSize: '0.55rem', color: theme.textMuted }}>{b.desc}</p>
                      {unlocked && <button onClick={() => shareAchievement(`I earned the "${b.name}" badge at ${cafeName}! ${b.icon}`)} className="bt" style={{ marginTop: '4px', background: 'none', border: 'none', color: theme.accent, fontSize: '0.6rem', cursor: 'pointer' }}>📤 Share</button>}
                    </div>);
                  })}
                </div>
                <button onClick={() => setShowBadges(false)} style={{ ...s.btn, width: '100%', marginTop: '14px' }}>Close</button>
              </div>
            </div>
          )}

          {/* Challenges */}
          {showChallenges && (
            <div style={s.modal} className="fade" onClick={() => setShowChallenges(false)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '16px' }}>🏆 Challenges</h2>
                
                <h3 className="bt" style={{ fontSize: '0.9rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>📅 Weekly Challenge</h3>
                {weeklyChallenge && (
                  <div style={{ ...s.card, marginBottom: '16px' }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '8px' }}>
                      <span style={{ fontSize: '1.5rem' }}>{weeklyChallenge.icon}</span>
                      <div>
                        <p className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text }}>{weeklyChallenge.name}</p>
                        <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>{weeklyChallenge.desc}</p>
                      </div>
                    </div>
                    <div style={{ height: '8px', background: theme.progressBg, borderRadius: '999px', overflow: 'hidden' }}>
                      <div style={{ height: '100%', width: `${Math.min(100, (challenges.weekly.progress / weeklyChallenge.target) * 100)}%`, background: theme.streakGradient, borderRadius: '999px', transition: 'width 0.5s' }} />
                    </div>
                    <p className="bt" style={{ fontSize: '0.75rem', color: theme.accent, marginTop: '4px', textAlign: 'right' }}>{Math.min(challenges.weekly.progress, weeklyChallenge.target)}/{weeklyChallenge.target} • +{weeklyChallenge.xp} XP</p>
                  </div>
                )}

                <h3 className="bt" style={{ fontSize: '0.9rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>📆 Monthly Challenge</h3>
                {monthlyChallenge && (
                  <div style={s.card}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '10px', marginBottom: '8px' }}>
                      <span style={{ fontSize: '1.5rem' }}>{monthlyChallenge.icon}</span>
                      <div>
                        <p className="bt" style={{ fontSize: '0.85rem', fontWeight: 600, color: theme.text }}>{monthlyChallenge.name}</p>
                        <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>{monthlyChallenge.desc}</p>
                      </div>
                    </div>
                    <div style={{ height: '8px', background: theme.progressBg, borderRadius: '999px', overflow: 'hidden' }}>
                      <div style={{ height: '100%', width: `${Math.min(100, (challenges.monthly.progress / monthlyChallenge.target) * 100)}%`, background: theme.xpBar, borderRadius: '999px', transition: 'width 0.5s' }} />
                    </div>
                    <p className="bt" style={{ fontSize: '0.75rem', color: theme.accent, marginTop: '4px', textAlign: 'right' }}>{Math.min(challenges.monthly.progress, monthlyChallenge.target)}/{monthlyChallenge.target} • +{monthlyChallenge.xp} XP</p>
                  </div>
                )}

                <button onClick={() => setShowChallenges(false)} style={{ ...s.btn, width: '100%', marginTop: '14px' }}>Close</button>
              </div>
            </div>
          )}

          {/* Year in Review */}
          {/* Weekly Review Modal */}
          {showWeeklyReview && (
            <div style={s.modal} className="fade" onClick={() => setShowWeeklyReview(false)}>
              <div style={{ ...s.modalContent, maxWidth: '400px' }} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '16px', textAlign: 'center' }}>📊 Weekly Review</h2>
                {(() => {
                  const today = new Date();
                  const weekStart = new Date(today);
                  weekStart.setDate(today.getDate() - 6);
                  
                  let habitsCompleted = 0, habitsTotal = 0;
                  let tasksCompleted = 0;
                  let focusMins = 0;
                  let moodSum = 0, moodCount = 0;
                  let bestStreak = 0;
                  const dailyData = [];
                  
                  for (let i = 0; i < 7; i++) {
                    const d = new Date(weekStart);
                    d.setDate(weekStart.getDate() + i);
                    const key = getDateKey(d);
                    let dayHabits = 0;
                    
                    habits.forEach(h => {
                      habitsTotal++;
                      if (h.history && h.history[key]) {
                        habitsCompleted++;
                        dayHabits++;
                      }
                      if (h.streak > bestStreak) bestStreak = h.streak;
                    });
                    
                    if (moods[key]) {
                      moodSum += moods[key].value;
                      moodCount++;
                    }
                    
                    dailyData.push({ day: ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][d.getDay()], habits: dayHabits });
                  }
                  
                  tasksCompleted = gameStats.totalTasksCompleted || 0;
                  focusMins = gameStats.totalFocusMinutes || 0;
                  const avgMood = moodCount > 0 ? (moodSum / moodCount).toFixed(1) : null;
                  const habitRate = habitsTotal > 0 ? Math.round((habitsCompleted / habitsTotal) * 100) : 0;
                  
                  return (
                    <div>
                      {/* Summary Stats */}
                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px', marginBottom: '16px' }}>
                        <div style={{ background: theme.progressBg, borderRadius: '12px', padding: '12px', textAlign: 'center' }}>
                          <p style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.accent }}>{habitRate}%</p>
                          <p className="bt" style={{ fontSize: '0.65rem', color: theme.textSecondary }}>Habits Done</p>
                        </div>
                        <div style={{ background: theme.progressBg, borderRadius: '12px', padding: '12px', textAlign: 'center' }}>
                          <p style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.accent }}>🔥 {bestStreak}</p>
                          <p className="bt" style={{ fontSize: '0.65rem', color: theme.textSecondary }}>Best Streak</p>
                        </div>
                        <div style={{ background: theme.progressBg, borderRadius: '12px', padding: '12px', textAlign: 'center' }}>
                          <p style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.accent }}>{Math.floor(focusMins/60)}h {focusMins%60}m</p>
                          <p className="bt" style={{ fontSize: '0.65rem', color: theme.textSecondary }}>Focus Time</p>
                        </div>
                        <div style={{ background: theme.progressBg, borderRadius: '12px', padding: '12px', textAlign: 'center' }}>
                          <p style={{ fontSize: '1.5rem', fontWeight: 700, color: theme.accent }}>{avgMood ? `${avgMood}/5` : '—'}</p>
                          <p className="bt" style={{ fontSize: '0.65rem', color: theme.textSecondary }}>Avg Mood</p>
                        </div>
                      </div>
                      
                      {/* Daily Habit Chart */}
                      <div style={{ background: theme.progressBg, borderRadius: '12px', padding: '12px', marginBottom: '16px' }}>
                        <p className="bt" style={{ fontSize: '0.75rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>Daily Habits</p>
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-end', height: '60px' }}>
                          {dailyData.map((d, i) => (
                            <div key={i} style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', flex: 1 }}>
                              <div style={{ width: '20px', background: theme.streakGradient, borderRadius: '4px 4px 0 0', height: `${Math.max(4, (d.habits / habits.length) * 50)}px` }} />
                              <span className="bt" style={{ fontSize: '0.55rem', color: theme.textMuted, marginTop: '4px' }}>{d.day}</span>
                            </div>
                          ))}
                        </div>
                      </div>
                      
                      {/* Highlights */}
                      <div style={{ background: theme.accentLight, borderRadius: '12px', padding: '12px' }}>
                        <p className="bt" style={{ fontSize: '0.75rem', fontWeight: 600, color: theme.accent, marginBottom: '6px' }}>✨ Week Highlights</p>
                        <p className="bt" style={{ fontSize: '0.7rem', color: theme.text, lineHeight: 1.6 }}>
                          • Completed {habitsCompleted} habits this week<br/>
                          • {bestStreak > 7 ? `Amazing ${bestStreak}-day streak!` : `Keep building those streaks!`}<br/>
                          • {focusMins > 60 ? `Great focus time!` : `Try a focus session this week`}
                        </p>
                      </div>
                    </div>
                  );
                })()}
                <button onClick={() => setShowWeeklyReview(false)} style={{ ...s.btn, width: '100%', marginTop: '16px' }}>Close</button>
              </div>
            </div>
          )}

          {showYearReview && (
            <div style={s.modal} className="fade" onClick={() => setShowYearReview(false)}>
              <div style={s.modalContent} className="slide" onClick={e => e.stopPropagation()}>
                <div style={{ textAlign: 'center', marginBottom: '20px' }}>
                  <span style={{ fontSize: '2.5rem' }}>{brewThemes[brewType].icon}</span>
                  <h2 className="hw" style={{ fontSize: '1.6rem', color: theme.text, marginTop: '8px' }}>{currentYear} Year in Review</h2>
                </div>

                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2,1fr)', gap: '10px', marginBottom: '16px' }}>
                  {[{ v: gameStats.xp, l: 'Total XP' }, { v: yearReview.badgesEarned, l: 'Badges' }, { v: yearReview.totalHabits, l: 'Habits Done' }, { v: yearReview.totalTasks, l: 'Tasks Done' }].map((stat, i) => (
                    <div key={i} style={{ background: theme.progressBg, borderRadius: '12px', padding: '14px', textAlign: 'center' }}>
                      <p style={{ fontSize: '1.5rem', fontWeight: 600, color: theme.text }}>{stat.v}</p>
                      <p className="bt" style={{ fontSize: '0.65rem', color: theme.textSecondary }}>{stat.l}</p>
                    </div>
                  ))}
                </div>

                <div style={{ background: theme.accentLight, borderRadius: '12px', padding: '14px', marginBottom: '12px' }}>
                  <div className="bt" style={{ fontSize: '0.8rem', color: theme.textSecondary, lineHeight: 1.8 }}>
                    <p>🔥 Longest streak: <strong style={{ color: theme.text }}>{yearReview.longestStreak} days</strong></p>
                    <p>😊 Avg mood: <strong style={{ color: theme.text }}>{yearReview.avgMood || '—'}/5</strong></p>
                    <p>📝 Journal entries: <strong style={{ color: theme.text }}>{yearReview.totalJournal}</strong></p>
                    <p>⏱️ Focus time: <strong style={{ color: theme.text }}>{Math.round(yearReview.totalFocus / 60)} hours</strong></p>
                  </div>
                </div>

                <div style={{ textAlign: 'center', padding: '12px', background: theme.streakGradient, borderRadius: '12px', marginBottom: '14px' }}>
                  <p className="hw" style={{ fontSize: '1.2rem', color: theme.isDark ? '#1a1a1a' : '#fff' }}>{currentLevel.icon} {currentLevel.title}</p>
                </div>

                <button onClick={() => shareAchievement(`My ${currentYear} at ${cafeName}: ${yearReview.totalHabits} habits, ${yearReview.totalTasks} tasks, ${yearReview.longestStreak}-day streak! ☕🏆`)} style={{ ...s.btnSecondary, width: '100%', marginBottom: '10px' }}>📤 Share My Year</button>
                <button onClick={() => setShowYearReview(false)} style={{ ...s.btn, width: '100%' }}>Close</button>
              </div>
            </div>
          )}

          {/* Custom Timer */}
          {showCustomTimer && (
            <div style={s.modal} onClick={() => setShowCustomTimer(false)}>
              <div style={{ ...s.modalContent, maxWidth: '320px', textAlign: 'center' }} className="slide" onClick={e => e.stopPropagation()}>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginBottom: '16px' }}>⏱️ Focus Timer</h2>
                
                {/* Timer Presets */}
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '8px', marginBottom: '16px' }}>
                  {[
                    { label: 'Quick', mins: 15, icon: '⚡' },
                    { label: 'Pomodoro', mins: 25, icon: '🍅' },
                    { label: 'Extended', mins: 45, icon: '📚' },
                    { label: 'Deep Work', mins: 90, icon: '🧠' },
                    { label: 'Half Day', mins: 120, icon: '☕' },
                    { label: 'Custom', mins: null, icon: '⚙️' },
                  ].map(preset => (
                    <button 
                      key={preset.label}
                      onClick={() => { if (preset.mins) { setCustomTimerMins(preset.mins); setCustomTimerSecs(0); } }}
                      style={{ 
                        padding: '10px 6px', 
                        borderRadius: '10px', 
                        border: (customTimerMins === preset.mins && customTimerSecs === 0) ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`,
                        background: (customTimerMins === preset.mins && customTimerSecs === 0) ? theme.accentLight : theme.progressBg,
                        cursor: 'pointer',
                        textAlign: 'center'
                      }}
                    >
                      <span style={{ fontSize: '1.2rem', display: 'block' }}>{preset.icon}</span>
                      <span className="bt" style={{ fontSize: '0.65rem', color: theme.text, display: 'block' }}>{preset.label}</span>
                      {preset.mins && <span className="bt" style={{ fontSize: '0.6rem', color: theme.textSecondary }}>{preset.mins}m</span>}
                    </button>
                  ))}
                </div>
                
                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px', marginBottom: '20px' }}>
                  <div style={{ textAlign: 'center' }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                      <button onClick={() => setCustomTimerMins(Math.max(0, customTimerMins - 1))} style={{ ...s.btnSecondary, padding: '8px 12px', fontSize: '1rem' }}>-</button>
                      <input type="number" value={customTimerMins} onChange={e => setCustomTimerMins(Math.max(0, Math.min(180, parseInt(e.target.value) || 0)))} style={{ ...s.input, width: '60px', textAlign: 'center', fontSize: '1.3rem', fontWeight: 600 }} min="0" max="180" />
                      <button onClick={() => setCustomTimerMins(Math.min(180, customTimerMins + 1))} style={{ ...s.btnSecondary, padding: '8px 12px', fontSize: '1rem' }}>+</button>
                    </div>
                    <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary, marginTop: '4px' }}>minutes</p>
                  </div>
                  <span style={{ fontSize: '1.5rem', color: theme.text, fontWeight: 300 }}>:</span>
                  <div style={{ textAlign: 'center' }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                      <button onClick={() => setCustomTimerSecs(Math.max(0, customTimerSecs - 5))} style={{ ...s.btnSecondary, padding: '8px 12px', fontSize: '1rem' }}>-</button>
                      <input type="number" value={customTimerSecs} onChange={e => setCustomTimerSecs(Math.max(0, Math.min(59, parseInt(e.target.value) || 0)))} style={{ ...s.input, width: '60px', textAlign: 'center', fontSize: '1.3rem', fontWeight: 600 }} min="0" max="59" />
                      <button onClick={() => setCustomTimerSecs(Math.min(59, customTimerSecs + 5))} style={{ ...s.btnSecondary, padding: '8px 12px', fontSize: '1rem' }}>+</button>
                    </div>
                    <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary, marginTop: '4px' }}>seconds</p>
                  </div>
                </div>
                <p className="bt" style={{ fontSize: '0.75rem', color: theme.textMuted, marginBottom: '16px' }}>
                  Total: {customTimerMins > 0 ? `${customTimerMins}m ` : ''}{customTimerSecs > 0 ? `${customTimerSecs}s` : customTimerMins === 0 ? '0s' : ''}
                </p>
                <div style={{ display: 'flex', gap: '10px' }}>
                  <button onClick={() => setShowCustomTimer(false)} style={{ ...s.btnSecondary, flex: 1 }}>Cancel</button>
                  <button 
                    onClick={() => { 
                      const totalSecs = (customTimerMins * 60) + customTimerSecs;
                      if (totalSecs > 0) {
                        setTimerSeconds(totalSecs); 
                        setShowCustomTimer(false); 
                      }
                    }} 
                    style={{ ...s.btn, flex: 1 }}
                    disabled={(customTimerMins * 60) + customTimerSecs === 0}
                  >
                    Set Timer
                  </button>
                </div>
              </div>
            </div>
          )}

          {/* Sound Menu */}
          {showSoundMenu && (
            <div style={{ ...s.modal, alignItems: 'flex-end' }} onClick={() => setShowSoundMenu(false)}>
              <div style={{ background: theme.modalBg, borderRadius: '20px 20px 0 0', width: '100%', maxWidth: '28rem', padding: '20px', paddingBottom: 'max(20px,env(safe-area-inset-bottom))', maxHeight: '90vh', overflow: 'auto' }} className="slide" onClick={e => e.stopPropagation()}>
                <h3 className="hw" style={{ fontSize: '1.4rem', color: theme.text, textAlign: 'center', marginBottom: '4px' }}>🎵 Soundscape</h3>
                <p className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary, textAlign: 'center', marginBottom: '16px' }}>
                  {isDark ? '🌙 Dark mode: Warmer, deeper tones' : '☀️ Light mode: Brighter, airy tones'}
                </p>
                
                {/* Big Play/Stop Button */}
                <div style={{ textAlign: 'center', marginBottom: '16px' }}>
                  <button 
                    onClick={() => { if (ambientSound === 'off') { setAmbientSound('both'); } setSoundEnabled(!soundEnabled); }}
                    disabled={ambientSound === 'off'}
                    style={{ 
                      width: '72px', 
                      height: '72px', 
                      borderRadius: '50%', 
                      border: 'none',
                      background: soundEnabled ? theme.streakGradient : theme.accentGradient,
                      cursor: ambientSound === 'off' ? 'not-allowed' : 'pointer',
                      opacity: ambientSound === 'off' ? 0.5 : 1,
                      fontSize: '1.8rem',
                      boxShadow: soundEnabled ? '0 0 20px rgba(74,222,128,0.4)' : '0 4px 15px rgba(0,0,0,0.2)',
                      transition: 'all 0.3s'
                    }}
                  >
                    {soundEnabled ? '⏸' : '▶'}
                  </button>
                </div>

                {/* Volume Sliders - Only show when sound is enabled */}
                {ambientSound !== 'off' && (
                  <div style={{ background: theme.progressBg, borderRadius: '12px', padding: '14px', marginBottom: '14px' }}>
                    <p className="bt" style={{ fontSize: '0.8rem', fontWeight: 600, color: theme.text, marginBottom: '12px' }}>🎚️ Volume</p>
                    
                    {/* Ambiance Volume */}
                    {(ambientSound === 'ambiance' || ambientSound === 'both') && (
                      <div style={{ marginBottom: '12px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '6px' }}>
                          <span className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>🌧️ Ambiance</span>
                          <span className="bt" style={{ fontSize: '0.7rem', color: theme.accent }}>{ambianceVolume}%</span>
                        </div>
                        <input 
                          type="range" 
                          min="0" 
                          max="100" 
                          value={ambianceVolume}
                          onChange={e => setAmbianceVolume(parseInt(e.target.value))}
                          style={{ width: '100%', accentColor: theme.accent, height: '6px', borderRadius: '3px', cursor: 'pointer' }}
                        />
                      </div>
                    )}
                    
                    {/* Music Volume */}
                    {(ambientSound === 'music' || ambientSound === 'both') && (
                      <div>
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '6px' }}>
                          <span className="bt" style={{ fontSize: '0.7rem', color: theme.textSecondary }}>🎹 Music</span>
                          <span className="bt" style={{ fontSize: '0.7rem', color: theme.accent }}>{musicVolume}%</span>
                        </div>
                        <input 
                          type="range" 
                          min="0" 
                          max="100" 
                          value={musicVolume}
                          onChange={e => setMusicVolume(parseInt(e.target.value))}
                          style={{ width: '100%', accentColor: theme.accent, height: '6px', borderRadius: '3px', cursor: 'pointer' }}
                        />
                      </div>
                    )}
                  </div>
                )}

                {/* Mood Presets - for ambiance override */}
                {(ambientSound === 'ambiance' || ambientSound === 'both') && (
                  <div style={{ marginBottom: '14px' }}>
                    <p className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary, marginBottom: '8px' }}>Ambiance Mood:</p>
                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5, 1fr)', gap: '6px' }}>
                      {[
                        { id: 'auto', icon: '✨', name: 'Auto', desc: 'Match theme' },
                        { id: 'cozy', icon: '🔥', name: 'Cozy', desc: 'Fireplace' },
                        { id: 'rainy', icon: '🌧️', name: 'Rainy', desc: 'Soft rain' },
                        { id: 'wind', icon: '🍃', name: 'Wind', desc: 'Trees' },
                        { id: 'soothing', icon: '🌊', name: 'Ocean', desc: 'Waves' },
                      ].map(mood => (
                        <button 
                          key={mood.id}
                          onClick={() => setSoundMood(mood.id)}
                          style={{
                            padding: '8px 4px',
                            borderRadius: '10px',
                            border: soundMood === mood.id ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`,
                            background: soundMood === mood.id ? theme.accentLight : 'transparent',
                            cursor: 'pointer',
                            textAlign: 'center'
                          }}
                        >
                          <span style={{ fontSize: '1.1rem', display: 'block' }}>{mood.icon}</span>
                          <span className="bt" style={{ fontSize: '0.6rem', color: theme.text, fontWeight: soundMood === mood.id ? 600 : 400 }}>
                            {mood.name}
                          </span>
                        </button>
                      ))}
                    </div>
                  </div>
                )}
                
                {/* Sound Mode Options */}
                <p className="bt" style={{ fontSize: '0.75rem', color: theme.textSecondary, marginBottom: '6px' }}>Sound Mode:</p>
                <div style={{ display: 'flex', gap: '6px', marginBottom: '14px' }}>
                  {[
                    { id: 'off', icon: '🔇', name: 'Off' },
                    { id: 'ambiance', icon: '🌧️', name: 'Ambiance' },
                    { id: 'music', icon: '🎹', name: 'Music' },
                    { id: 'both', icon: '✨', name: 'Full' },
                  ].map(opt => (
                    <button 
                      key={opt.id} 
                      onClick={() => { setAmbientSound(opt.id); if (opt.id === 'off') setSoundEnabled(false); }}
                      style={{ 
                        flex: 1,
                        padding: '10px 6px', 
                        borderRadius: '10px', 
                        border: ambientSound === opt.id ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`, 
                        background: ambientSound === opt.id ? theme.accentLight : 'transparent',
                        cursor: 'pointer',
                        textAlign: 'center'
                      }}
                    >
                      <span style={{ fontSize: '1.1rem', display: 'block' }}>{opt.icon}</span>
                      <span className="bt" style={{ fontSize: '0.65rem', color: theme.text }}>{opt.name}</span>
                    </button>
                  ))}
                </div>

                {/* Track Selection */}
                {ambientSound !== 'off' && (
                  <div style={{ background: theme.progressBg, borderRadius: '12px', padding: '14px', marginBottom: '14px' }}>
                    <p className="bt" style={{ fontSize: '0.8rem', fontWeight: 600, color: theme.text, marginBottom: '10px' }}>🎨 Track Selection</p>
                    
                    {/* Ambiance Track */}
                    {(ambientSound === 'ambiance' || ambientSound === 'both') && (
                      <div style={{ marginBottom: ambientSound === 'both' ? '12px' : 0 }}>
                        <p className="bt" style={{ fontSize: '0.65rem', color: theme.textSecondary, marginBottom: '6px' }}>Ambiance:</p>
                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '5px' }}>
                          <button 
                            onClick={() => setAmbianceTrack('auto')}
                            style={{
                              padding: '8px 12px',
                              borderRadius: '8px',
                              border: ambianceTrack === 'auto' ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`,
                              background: ambianceTrack === 'auto' ? theme.accentLight : 'transparent',
                              cursor: 'pointer',
                              fontSize: '0.65rem',
                              color: theme.text,
                              fontFamily: "'Lora',serif"
                            }}
                          >✨ Auto</button>
                          {Object.entries(ambianceTracks).map(([id, track]) => (
                            <button 
                              key={id}
                              onClick={() => setAmbianceTrack(id)}
                              style={{
                                padding: '8px 12px',
                                borderRadius: '8px',
                                border: ambianceTrack === id ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`,
                                background: ambianceTrack === id ? theme.accentLight : 'transparent',
                                cursor: 'pointer',
                                fontSize: '0.65rem',
                                color: theme.text,
                                fontFamily: "'Lora',serif"
                              }}
                            >{track.icon} {track.name}</button>
                          ))}
                        </div>
                      </div>
                    )}
                    
                    {/* Music Track */}
                    {(ambientSound === 'music' || ambientSound === 'both') && (
                      <div>
                        <p className="bt" style={{ fontSize: '0.65rem', color: theme.textSecondary, marginBottom: '6px' }}>Music:</p>
                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '5px' }}>
                          <button 
                            onClick={() => setMusicTrack('auto')}
                            style={{
                              padding: '8px 12px',
                              borderRadius: '8px',
                              border: musicTrack === 'auto' ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`,
                              background: musicTrack === 'auto' ? theme.accentLight : 'transparent',
                              cursor: 'pointer',
                              fontSize: '0.65rem',
                              color: theme.text,
                              fontFamily: "'Lora',serif"
                            }}
                          >✨ Auto</button>
                          {Object.entries(musicTracks).map(([id, track]) => (
                            <button 
                              key={id}
                              onClick={() => setMusicTrack(id)}
                              style={{
                                padding: '8px 12px',
                                borderRadius: '8px',
                                border: musicTrack === id ? `2px solid ${theme.accent}` : `1px solid ${theme.cardBorder}`,
                                background: musicTrack === id ? theme.accentLight : 'transparent',
                                cursor: 'pointer',
                                fontSize: '0.65rem',
                                color: theme.text,
                                fontFamily: "'Lora',serif"
                              }}
                            >{track.icon} {track.name}</button>
                          ))}
                        </div>
                        <p className="bt" style={{ fontSize: '0.55rem', color: theme.textMuted, marginTop: '6px' }}>
                          Auto: {isDark ? 'Dark mode tracks' : 'Light mode tracks'} based on theme
                        </p>
                      </div>
                    )}
                  </div>
                )}

                {/* Background Play Toggle */}
                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '12px 14px', background: theme.progressBg, borderRadius: '10px', marginBottom: '14px' }}>
                  <div>
                    <p className="bt" style={{ fontSize: '0.75rem', fontWeight: 600, color: theme.text }}>🔄 Background Play</p>
                    <p className="bt" style={{ fontSize: '0.55rem', color: theme.textSecondary }}>Keep playing when you leave</p>
                  </div>
                  <button 
                    onClick={() => setBackgroundPlay(!backgroundPlay)}
                    style={{
                      width: '46px',
                      height: '26px',
                      borderRadius: '13px',
                      border: 'none',
                      background: backgroundPlay ? theme.accent : theme.inputBorder,
                      cursor: 'pointer',
                      position: 'relative',
                      transition: 'background 0.2s'
                    }}
                  >
                    <div style={{
                      width: '20px',
                      height: '20px',
                      borderRadius: '50%',
                      background: '#fff',
                      position: 'absolute',
                      top: '3px',
                      left: backgroundPlay ? '23px' : '3px',
                      transition: 'left 0.2s',
                      boxShadow: '0 1px 3px rgba(0,0,0,0.2)'
                    }} />
                  </button>
                </div>

                {/* Now Playing Status */}
                {soundEnabled && ambientSound !== 'off' && (
                  <div style={{ textAlign: 'center', marginBottom: '14px', padding: '10px', background: 'rgba(74,222,128,0.1)', borderRadius: '10px', border: '1px solid rgba(74,222,128,0.3)' }}>
                    <p className="bt" style={{ fontSize: '0.7rem', color: '#4ade80' }}>
                      🎵 Now Playing: {' '}
                      {ambientSound === 'ambiance' && `${ambianceTracks[getActiveAmbianceTrack()]?.icon} ${ambianceTracks[getActiveAmbianceTrack()]?.name}`}
                      {ambientSound === 'music' && `${musicTracks[getActiveMusicTrack()]?.icon} ${musicTracks[getActiveMusicTrack()]?.name}`}
                      {ambientSound === 'both' && `${ambianceTracks[getActiveAmbianceTrack()]?.icon} ${ambianceTracks[getActiveAmbianceTrack()]?.name} + ${musicTracks[getActiveMusicTrack()]?.icon} ${musicTracks[getActiveMusicTrack()]?.name}`}
                    </p>
                  </div>
                )}

                <button onClick={() => setShowSoundMenu(false)} style={{ ...s.btn, width: '100%' }}>Done</button>
              </div>
            </div>
          )}

          {/* Delete Confirmation */}
          {confirmDelete && (
            <div style={s.modal} onClick={() => setConfirmDelete(null)}>
              <div style={{ ...s.modalContent, textAlign: 'center' }} className="slide" onClick={e => e.stopPropagation()}>
                <span style={{ fontSize: '2.5rem' }}>🗑️</span>
                <h2 className="hw" style={{ fontSize: '1.3rem', color: theme.text, marginTop: '12px', marginBottom: '8px' }}>Delete {confirmDelete.type === 'habit' ? 'Habit' : 'Task'}?</h2>
                <p className="bt" style={{ fontSize: '0.9rem', color: theme.textSecondary, marginBottom: '6px' }}>
                  {confirmDelete.icon && <span style={{ marginRight: '6px' }}>{confirmDelete.icon}</span>}
                  <strong>{confirmDelete.name}</strong>
                </p>
                <p className="bt" style={{ fontSize: '0.75rem', color: theme.textMuted, marginBottom: '20px' }}>
                  {confirmDelete.type === 'habit' ? 'This will delete the habit and reset its streak.' : 'This action can be undone for 4 seconds.'}
                </p>
                <div style={{ display: 'flex', gap: '10px' }}>
                  <button onClick={() => setConfirmDelete(null)} style={{ ...s.btnSecondary, flex: 1 }}>Cancel</button>
                  <button onClick={() => confirmDelete.type === 'habit' ? deleteHabit(confirmDelete.id) : deleteTask(confirmDelete.id)} style={{ ...s.btn, flex: 1, background: '#ef4444' }}>Delete</button>
                </div>
              </div>
            </div>
          )}

          {/* Export */}
          {showExport && (
            <div style={s.modal} onClick={() => setShowExport(false)}>
              <div style={{ ...s.modalContent, textAlign: 'center' }} className="slide" onClick={e => e.stopPropagation()}>
                <span style={{ fontSize: '2rem' }}>💾</span>
                <h2 className="hw" style={{ fontSize: '1.4rem', color: theme.text, marginTop: '8px', marginBottom: '12px' }}>Export Your Data</h2>
                <p className="bt" style={{ fontSize: '0.85rem', color: theme.textSecondary, marginBottom: '20px' }}>Download all your habits, tasks, mood logs, journal entries, and stats as a JSON file.</p>
                <button onClick={exportData} style={{ ...s.btn, width: '100%', marginBottom: '10px' }}>📥 Download Backup</button>
                <button onClick={() => setShowExport(false)} style={{ ...s.btnSecondary, width: '100%' }}>Cancel</button>
              </div>
            </div>
          )}

          {/* Undo Toast */}
          {undoAction && (
            <div style={{ position: 'fixed', bottom: '100px', left: '50%', transform: 'translateX(-50%)', background: theme.text, color: theme.modalBg, padding: '10px 16px', borderRadius: '12px', display: 'flex', alignItems: 'center', gap: '10px', zIndex: 1000, boxShadow: '0 4px 20px rgba(0,0,0,0.3)' }} className="slide">
              <span className="bt" style={{ fontSize: '0.85rem' }}>{undoAction.type} deleted</span>
              <button onClick={() => { undoAction.action(); setUndoAction(null); }} style={{ background: theme.accent, color: '#fff', border: 'none', padding: '5px 10px', borderRadius: '6px', fontWeight: 600, cursor: 'pointer', fontSize: '0.8rem' }}>Undo</button>
            </div>
          )}

          {/* Celebration */}
          {celebration && (
            <div style={{ position: 'fixed', top: '50%', left: '50%', transform: 'translate(-50%,-50%)', background: theme.accentGradient, color: theme.isDark ? '#1a1a1a' : '#fff', padding: '20px 32px 24px', borderRadius: '20px', zIndex: 3000, textAlign: 'center', boxShadow: '0 10px 40px rgba(0,0,0,0.3)' }} className="slide">
              {/* Coffee Cup with Steam */}
              <div style={{ position: 'relative', display: 'inline-block', marginBottom: '8px' }}>
                <span style={{ fontSize: '3rem' }}>{brewThemes[brewType].icon}</span>
                {/* Rising Steam */}
                <div style={{ position: 'absolute', top: '-20px', left: '50%', transform: 'translateX(-50%)', display: 'flex', gap: '8px' }}>
                  {[0, 1, 2].map(i => (
                    <span key={i} style={{ fontSize: '1rem', opacity: 0.7, animation: `celebrateSteam 1.5s ease-out ${i * 0.3}s infinite` }}>☁️</span>
                  ))}
                </div>
              </div>
              <p className="hw" style={{ fontSize: '1.3rem', margin: 0 }}>{celebration}</p>
              {/* Confetti burst */}
              <div style={{ position: 'absolute', top: '0', left: '50%', transform: 'translateX(-50%)', width: '250px', height: '120px', pointerEvents: 'none', overflow: 'visible' }}>
                {['🎉', '✨', '⭐', '🎊', '💫', '🌟', '❤️', '💛', '☕'].map((emoji, i) => (
                  <span key={i} style={{ position: 'absolute', left: `${5 + (i * 11)}%`, animation: `confetti 1.8s ease-out ${i * 0.08}s forwards`, fontSize: '1.1rem' }}>{emoji}</span>
                ))}
              </div>
            </div>
          )}

          {/* Freeze Animation Overlay */}
          {showFreezeAnimation && (
            <div style={{ position: 'fixed', inset: 0, background: 'radial-gradient(circle at center, rgba(135,206,235,0.3) 0%, transparent 70%)', zIndex: 2500, pointerEvents: 'none', display: 'flex', alignItems: 'center', justifyContent: 'center' }} className="fade">
              <div style={{ textAlign: 'center' }}>
                <div style={{ fontSize: '5rem', animation: 'freezeShimmer 1s ease-in-out infinite' }}>🧊</div>
                <div style={{ display: 'flex', justifyContent: 'center', gap: '20px', marginTop: '10px' }}>
                  {['❄️', '❄️', '❄️', '❄️', '❄️'].map((s, i) => (
                    <span key={i} style={{ fontSize: '1.5rem', animation: `iceFloat 2s ease-in-out ${i * 0.2}s infinite`, opacity: 0.8 }}>{s}</span>
                  ))}
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    setTimeout(() => document.getElementById('loadingScreen').classList.add('hidden'), 800);
  </script>
  <script>if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js').catch(console.error);</script>
</body>
</html>
